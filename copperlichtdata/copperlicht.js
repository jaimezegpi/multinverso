/**
  * CopperCube player implemented using the CopperLicht 3D Engine, (c) by Nikolaus Gebhardt, Ambiera e.U.
  * http://www.ambiera.com/coppercube
  */
function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function ca(a){return function(){return this[a]}}function k(a){return function(){return a}}var l,n={};function ea(a,b){this.Le=this.Ij=this.Ah=null;a=document.getElementById(a);if(a==null)n.Vm=false;else{if(this.Ah=a.parentNode){this.Qh=document.createElement("div");this.Ah.appendChild(this.Qh);this.qq=a=document.createTextNode("Loading...");this.Qh.appendChild(a)}b&&fa(this)}}function fa(a){if(a.Ij==null){a.Ij=document.createElement("div");a.Ah.appendChild(a.Ij);var b=document.createTextNode("FPS: 0");a.En=b;a.Ij.appendChild(b);a.frames=0;a.cn=(new Date).getTime()}}
ea.prototype.print=function(a){n.Vm!=false&&ga(this,a,false)};function ia(a,b){if(a.Qh)if(b==null)a.Qh.style.display="none";else{a.Qh.style.display="block";a.qq.nodeValue=b}}function ja(a,b,c){ga(a,b,true,c)}function ka(a,b){if(window.console)try{window.console.log(b)}catch(c){}else setTimeout(function(){throw new Error(b);},0)}
function ga(a,b,c,d){if(!(n.Vm==false&&c!=true)){if(a.Le==null){a.Le=document.createElement("div");a.Le.className="cldebug";a.Ah.appendChild(a.Le)}if(d){a.Le.appendChild(document.createElement("br"));c=document.createElement("div");a.Le.appendChild(c);c.innerHTML=b}else{a.Le.appendChild(document.createElement("br"));b=document.createTextNode(b);a.Le.appendChild(b)}}}n.Vm=true;n.va=null;function la(a,b){this.Kj=a;this.wb=false;this.Zr=b;if(!this.wb&&typeof XMLHttpRequest!="undefined")try{this.wb=new XMLHttpRequest}catch(c){this.wb=false}if(!this.wb&&window.fr)try{this.wb=window.fr()}catch(d){this.wb=false}this.load=function(e,f){if(this.wb==false)ja(n.va,"Your browser doesn't support AJAX");else{var g=this;try{this.wb.open("GET",this.Kj,true);if(this.Zr)this.wb.responseType="arraybuffer"}catch(h){if(f)f(h.message);else{ja(n.va,"Could not open file "+this.Kj+": "+h.message);var j=
navigator.appVersion;j!=null&&j.indexOf("Trident")!=-1&&ja(n.va,"<i>Use a web server to run files in IE. Or start them from CopperCube.</i>",true)}return}this.wb.onreadystatechange=function(){if(g.wb.readyState==4){var o=false;if(g.wb.status!=200&&g.wb.status!=0&&g.wb.status!=null)if(f){f("");o=true}else ja(n.va,"Could not open file "+g.Kj+" (status:"+g.wb.status+")");!o&&e&&e(g.wb.response)}};try{this.wb.send(null)}catch(m){f?f(""):ja(n.va,"Could not open file "+g.Kj)}}};this.abort=function(){try{this.wb.abort()}catch(e){}}}
;n.PI=3.14159265359;n.us=1/3.14159265359;n.os=1.570796326795;n.ts=3.141592653589793;n.Nd=3.14159265359/180;n.Fe=57.29577951307855;n.Wq=1.0E-8;n.$i=function(a){return a*n.Fe};n.Vo=function(a){return a*n.Nd};n.ya=function(a){return a<1.0E-8&&a>-1.0E-8};n.Te=function(a){return a+1.0E-8>=1&&a-1.0E-8<=1};n.F=function(a,b){return a+1.0E-8>=b&&a-1.0E-8<=b};n.ic=function(a,b,c){if(a<b)return b;if(a>c)return c;return a};n.ir=function(a){return a-Math.floor(a)};
n.Br=function(a,b,c){if(a>b){if(a>c)return a;return c}if(b>c)return b;return c};n.Hs=function(a,b,c){if(a<b){if(a<c)return a;return c}if(b<c)return b;return c};n.xd=function(a){return(a&4278190080)>>>24};n.Dc=function(a){return(a&16711680)>>16};n.Bc=function(a){return(a&65280)>>8};n.Ac=function(a){return a&255};n.ie=function(a,b,c,d){a&=255;b&=255;c&=255;d&=255;return a<<24|b<<16|c<<8|d};n.Uo=function(a){var b=new oa;b.cg=n.xd(a)/255;b.wc=n.Dc(a)/255;b.qc=n.Bc(a)/255;b.lc=n.Ac(a)/255;return b};
n.dp=function(a,b,c){var d=1-c;return n.ie(n.xd(a)*c+n.xd(b)*d,n.Dc(a)*c+n.Dc(b)*d,n.Bc(a)*c+n.Bc(b)*d,n.Ac(a)*c+n.Ac(b)*d)};n.Op=function(a){if(a>0)return 1;if(a<0)return-1;return 0};function oa(){this.lc=this.qc=this.wc=this.cg=1}l=oa.prototype;l.e=function(){var a=new oa;a.cg=this.cg;a.wc=this.wc;a.qc=this.qc;a.lc=this.lc;return a};l.cg=1;l.wc=1;l.qc=1;l.lc=1;n.Fk=true;n.sl=false;function q(){return(new Date).getTime()};function s(a,b,c){if(a!=null){this.c=a;this.b=b;this.d=c}}l=s.prototype;l.c=0;l.b=0;l.d=0;l.set=function(a,b,c){this.c=a;this.b=b;this.d=c};l.e=function(){return new s(this.c,this.b,this.d)};l.ia=function(a){a.c=this.c;a.b=this.b;a.d=this.d};l.substract=function(a){return new s(this.c-a.c,this.b-a.b,this.d-a.d)};function pa(a,b){a.c-=b.c;a.b-=b.b;a.d-=b.d}s.prototype.add=function(a){return new s(this.c+a.c,this.b+a.b,this.d+a.d)};s.prototype.ua=function(a){this.c+=a.c;this.b+=a.b;this.d+=a.d};
function ta(a,b){a.c+=b.c;a.b+=b.b;a.d+=b.d;return a}s.prototype.normalize=function(){var a=this.c*this.c+this.b*this.b+this.d*this.d;if(!(a>-1.0E-7&&a<1.0E-7)){a=1/Math.sqrt(a);this.c*=a;this.b*=a;this.d*=a}};function ua(a,b){var c=a.c*a.c+a.b*a.b+a.d*a.d;if(!(c>-1.0E-7&&c<1.0E-7)){c=b/Math.sqrt(c);a.c*=c;a.b*=c;a.d*=c}}function wa(a,b){a.c=b.c;a.b=b.b;a.d=b.d}s.prototype.F=function(a){return n.F(this.c,a.c)&&n.F(this.b,a.b)&&n.F(this.d,a.d)};
function xa(a){return n.ya(a.c)&&n.ya(a.b)&&n.ya(a.d)}s.prototype.getLength=function(){return Math.sqrt(this.c*this.c+this.b*this.b+this.d*this.d)};s.prototype.Cb=function(a){var b=a.c-this.c,c=a.b-this.b;a=a.d-this.d;return Math.sqrt(b*b+c*c+a*a)};function ya(a,b){var c=b.c-a.c,d=b.b-a.b;a=b.d-a.d;return c*c+d*d+a*a}function za(a){return a.c*a.c+a.b*a.b+a.d*a.d}function w(a,b){return new s(a.c*b,a.b*b,a.d*b)}function A(a,b){a.c*=b;a.b*=b;a.d*=b}function Aa(a,b){a.c*=b;a.b*=b;a.d*=b;return a}
function Ba(a,b){a.c*=b.c;a.b*=b.b;a.d*=b.d}function Ca(a,b){return new s(a.c*b.c,a.b*b.b,a.d*b.d)}function Fa(a,b){return new s(a.c/b.c,a.b/b.b,a.d/b.d)}function Ga(a,b){return new s(a.b*b.d-a.d*b.b,a.d*b.c-a.c*b.d,a.c*b.b-a.b*b.c)}s.prototype.la=function(a){return this.c*a.c+this.b*a.b+this.d*a.d};
function Ha(a){var b=new s;b.b=n.$i(Math.atan2(a.c,a.d));if(b.b<0)b.b+=360;if(b.b>=360)b.b-=360;var c=Math.sqrt(a.c*a.c+a.d*a.d);b.c=n.$i(Math.atan2(c,a.b))-90;if(b.c<0)b.c+=360;if(b.c>=360)b.c-=360;return b}function Ia(a,b){b*=n.Nd;var c=Math.cos(b);b=Math.sin(b);var d=a.c,e=a.d;a.c=d*c-e*b;a.d=d*b+e*c}function Ja(a,b,c){var d=1-c;return new s(b.c*d+a.c*c,b.b*d+a.b*c,b.d*d+a.d*c)}s.prototype.toString=function(){return"(x: "+this.c+" y:"+this.b+" z:"+this.d+")"};
function La(){this.ca=new s;this.S=new s}La.prototype.ca=null;La.prototype.S=null;function Ma(a){return a.S.substract(a.ca)}La.prototype.getLength=function(){return Ma(this).getLength()};function Na(a,b){if(a==null)this.b=this.c=0;else{this.c=a;this.b=b}}Na.prototype.c=0;Na.prototype.b=0;Na.prototype.set=function(a,b){this.c=a;this.b=b};Na.prototype.e=function(){return new Na(this.c,this.b)};function B(){this.D=new s;this.N=new s}B.prototype.D=null;B.prototype.N=null;B.prototype.e=function(){var a=new B;a.D=this.D.e();a.N=this.N.e();return a};function Oa(a){a=a.D.add(a.N);A(a,0.5);return a}function Pa(a){return a.N.substract(a.D)}
function Qa(a){var b=Oa(a);a=b.substract(a.N);var c=[];c.push(new s(b.c+a.c,b.b+a.b,b.d+a.d));c.push(new s(b.c+a.c,b.b-a.b,b.d+a.d));c.push(new s(b.c+a.c,b.b+a.b,b.d-a.d));c.push(new s(b.c+a.c,b.b-a.b,b.d-a.d));c.push(new s(b.c-a.c,b.b+a.b,b.d+a.d));c.push(new s(b.c-a.c,b.b-a.b,b.d+a.d));c.push(new s(b.c-a.c,b.b+a.b,b.d-a.d));c.push(new s(b.c-a.c,b.b-a.b,b.d-a.d));return c}
function Ra(a,b,c){var d=c.substract(b),e=d.getLength();d.normalize();b=w(b.add(c),0.5);c=e*0.5;e=w(Pa(a),0.5);a=Oa(a).substract(b);if(Math.abs(a.c)>e.c+c*Math.abs(d.c)||Math.abs(a.b)>e.b+c*Math.abs(d.b)||Math.abs(a.d)>e.d+c*Math.abs(d.d))d=false;else{b=e.b*Math.abs(d.d)+e.d*Math.abs(d.b);if(Math.abs(a.b*d.d-a.d*d.b)>b)d=false;else{b=e.c*Math.abs(d.d)+e.d*Math.abs(d.c);if(Math.abs(a.d*d.c-a.c*d.d)>b)d=false;else{b=e.c*Math.abs(d.b)+e.b*Math.abs(d.c);d=Math.abs(a.c*d.b-a.b*d.c)>b?false:true}}}return d}
function C(a,b){var c=b.c,d=b.b;b=b.d;if(c>a.N.c)a.N.c=c;if(d>a.N.b)a.N.b=d;if(b>a.N.d)a.N.d=b;if(c<a.D.c)a.D.c=c;if(d<a.D.b)a.D.b=d;if(b<a.D.d)a.D.d=b}function Sa(a,b){return a.D.c<=b.N.c&&a.D.b<=b.N.b&&a.D.d<=b.N.d&&a.N.c>=b.D.c&&a.N.b>=b.D.b&&a.N.d>=b.D.d}B.prototype.eh=function(a){return a.c>=this.D.c&&a.c<=this.N.c&&a.b>=this.D.b&&a.b<=this.N.b&&a.d>=this.D.d&&a.d<=this.N.d};B.prototype.reset=function(a,b,c){this.N.set(a,b,c);this.D.set(a,b,c)};function Va(){this.j=new s(0,1,0);Wa(this,new s(0,0,0))}Va.prototype.cb=0;Va.prototype.j=null;Va.prototype.e=function(){var a=new Va(false);a.j=this.j.e();a.cb=this.cb;return a};function Wa(a,b){a.cb=-b.la(a.j)}Va.prototype.normalize=function(){var a=1/this.j.getLength();this.j=w(this.j,a);this.cb*=a};
function Xa(a,b,c,d){var e=new s,f=new s;var g=a.j.getLength(),h=a.j.la(b.j),j=b.j.getLength(),m=g*j-h*h;if(Math.abs(m)<1.0E-8)b=false;else{m=1/m;j=(j*-a.cb+h*b.cb)*m;g=(g*-b.cb+h*a.cb)*m;Ga(a.j,b.j).ia(f);a=w(a.j,j);b=w(b.j,g);a.add(b).ia(e);b=true}if(b)return c.Ym(e,f,d);return false}Va.prototype.Ym=function(a,b,c){var d=this.j.la(b);if(d==0)return false;d=-(this.j.la(a)+this.cb)/d;a.add(w(b,d)).ia(c);return true};Va.prototype.Cb=function(a){return a.la(this.j)+this.cb};
function Ya(a,b){return a.j.la(b)<=0};function F(a,b,c){this.X=a?a:new s;this.fa=b?b:new s;this.ga=c?c:new s}F.prototype.X=null;F.prototype.fa=null;F.prototype.ga=null;F.prototype.e=function(){return new F(this.X,this.fa,this.ga)};function Za(a){var b=new Va(false),c=a.X,d=a.ga;b.j=Ga(a.fa.substract(c),d.substract(c));b.j.normalize();Wa(b,c);return b}F.prototype.eh=function(a){return $a(this,a,this.X,this.fa,this.ga)&&$a(this,a,this.fa,this.X,this.ga)&&$a(this,a,this.ga,this.X,this.fa)};
function $a(a,b,c,d,e){a=e.substract(d);b=Ga(a,b.substract(d));c=Ga(a,c.substract(d));return b.la(c)>=0}function ab(a){return Ga(a.fa.substract(a.X),a.ga.substract(a.X))}F.prototype.Ym=function(a,b){var c=ab(this);c.normalize();var d=c.la(b);if(n.ya(d))a=null;else{var e=this.X.la(c);c=-(c.la(a)-e)/d;a=a.add(w(b,c))}if(a==null)return null;if(this.eh(a))return a;return null};F.prototype.ia=function(a){this.X.ia(a.X);this.fa.ia(a.fa);this.ga.ia(a.ga)};function I(a){if(a==null)a=true;this.L=this.C=this.K=this.J=this.I=this.p=this.B=this.A=this.H=this.u=this.r=this.w=this.G=this.t=this.v=this.q=0;this.Qa=false;if(a){this.L=this.p=this.r=this.q=1;this.Qa=true}}function bb(a){if(a.Qa)return true;a.Qa=n.Te(a.q)&&n.ya(a.v)&&n.ya(a.t)&&n.ya(a.G)&&n.ya(a.w)&&n.Te(a.r)&&n.ya(a.u)&&n.ya(a.H)&&n.ya(a.A)&&n.ya(a.B)&&n.Te(a.p)&&n.ya(a.I)&&n.ya(a.J)&&n.ya(a.K)&&n.ya(a.C)&&n.Te(a.L);return a.Qa}
function cb(a){if(a.Qa)return true;return n.Te(a.q)&&n.ya(a.v)&&n.ya(a.t)&&n.ya(a.G)&&n.ya(a.w)&&n.Te(a.r)&&n.ya(a.u)&&n.ya(a.H)&&n.ya(a.A)&&n.ya(a.B)&&n.Te(a.p)&&n.ya(a.I)&&n.Te(a.L)}I.prototype.F=function(a){return n.F(this.q,a.q)&&n.F(this.v,a.v)&&n.F(this.t,a.t)&&n.F(this.G,a.G)&&n.F(this.w,a.w)&&n.F(this.r,a.r)&&n.F(this.u,a.u)&&n.F(this.H,a.H)&&n.F(this.A,a.A)&&n.F(this.B,a.B)&&n.F(this.p,a.p)&&n.F(this.I,a.I)&&n.F(this.J,a.J)&&n.F(this.K,a.K)&&n.F(this.C,a.C)&&n.F(this.L,a.L)};
function db(a){return new s(a.q,a.r,a.p)}function eb(a,b){var c=b.e();b.c=c.c*a.q+c.b*a.w+c.d*a.A;b.b=c.c*a.v+c.b*a.r+c.d*a.B;b.d=c.c*a.t+c.b*a.u+c.d*a.p}function jb(a,b,c){b.c=c.c*a.q+c.b*a.w+c.d*a.A;b.b=c.c*a.v+c.b*a.r+c.d*a.B;b.d=c.c*a.t+c.b*a.u+c.d*a.p}function kb(a,b){return new s(b.c*a.q+b.b*a.w+b.d*a.A+a.J,b.c*a.v+b.b*a.r+b.d*a.B+a.K,b.c*a.t+b.b*a.u+b.d*a.p+a.C)}function lb(a,b){var c=b.c*a.v+b.b*a.r+b.d*a.B+a.K,d=b.c*a.t+b.b*a.u+b.d*a.p+a.C;b.c=b.c*a.q+b.b*a.w+b.d*a.A+a.J;b.b=c;b.d=d}
function mb(a,b){return new s(b.c+a.J,b.b+a.K,b.d+a.C)}
function K(a,b){var c=new I(false);if(a.Qa){b.ia(c);return c}if(b.Qa){a.ia(c);return c}c.q=a.q*b.q+a.w*b.v+a.A*b.t+a.J*b.G;c.v=a.v*b.q+a.r*b.v+a.B*b.t+a.K*b.G;c.t=a.t*b.q+a.u*b.v+a.p*b.t+a.C*b.G;c.G=a.G*b.q+a.H*b.v+a.I*b.t+a.L*b.G;c.w=a.q*b.w+a.w*b.r+a.A*b.u+a.J*b.H;c.r=a.v*b.w+a.r*b.r+a.B*b.u+a.K*b.H;c.u=a.t*b.w+a.u*b.r+a.p*b.u+a.C*b.H;c.H=a.G*b.w+a.H*b.r+a.I*b.u+a.L*b.H;c.A=a.q*b.A+a.w*b.B+a.A*b.p+a.J*b.I;c.B=a.v*b.A+a.r*b.B+a.B*b.p+a.K*b.I;c.p=a.t*b.A+a.u*b.B+a.p*b.p+a.C*b.I;c.I=a.G*b.A+a.H*b.B+
a.I*b.p+a.L*b.I;c.J=a.q*b.J+a.w*b.K+a.A*b.C+a.J*b.L;c.K=a.v*b.J+a.r*b.K+a.B*b.C+a.K*b.L;c.C=a.t*b.J+a.u*b.K+a.p*b.C+a.C*b.L;c.L=a.G*b.J+a.H*b.K+a.I*b.C+a.L*b.L;return c}
function nb(a,b){if(a.Qa){a.ia(b);return true}var c=(a.q*a.r-a.v*a.w)*(a.p*a.L-a.I*a.C)-(a.q*a.u-a.t*a.w)*(a.B*a.L-a.I*a.K)+(a.q*a.H-a.G*a.w)*(a.B*a.C-a.p*a.K)+(a.v*a.u-a.t*a.r)*(a.A*a.L-a.I*a.J)-(a.v*a.H-a.G*a.r)*(a.A*a.C-a.p*a.J)+(a.t*a.H-a.G*a.u)*(a.A*a.K-a.B*a.J);if(c>-1.0E-7&&c<1.0E-7)return false;c=1/c;b.q=c*(a.r*(a.p*a.L-a.I*a.C)+a.u*(a.I*a.K-a.B*a.L)+a.H*(a.B*a.C-a.p*a.K));b.v=c*(a.B*(a.t*a.L-a.G*a.C)+a.p*(a.G*a.K-a.v*a.L)+a.I*(a.v*a.C-a.t*a.K));b.t=c*(a.K*(a.t*a.H-a.G*a.u)+a.C*(a.G*a.r-a.v*
a.H)+a.L*(a.v*a.u-a.t*a.r));b.G=c*(a.v*(a.H*a.p-a.u*a.I)+a.t*(a.r*a.I-a.H*a.B)+a.G*(a.u*a.B-a.r*a.p));b.w=c*(a.u*(a.A*a.L-a.I*a.J)+a.H*(a.p*a.J-a.A*a.C)+a.w*(a.I*a.C-a.p*a.L));b.r=c*(a.p*(a.q*a.L-a.G*a.J)+a.I*(a.t*a.J-a.q*a.C)+a.A*(a.G*a.C-a.t*a.L));b.u=c*(a.C*(a.q*a.H-a.G*a.w)+a.L*(a.t*a.w-a.q*a.u)+a.J*(a.G*a.u-a.t*a.H));b.H=c*(a.t*(a.H*a.A-a.w*a.I)+a.G*(a.w*a.p-a.u*a.A)+a.q*(a.u*a.I-a.H*a.p));b.A=c*(a.H*(a.A*a.K-a.B*a.J)+a.w*(a.B*a.L-a.I*a.K)+a.r*(a.I*a.J-a.A*a.L));b.B=c*(a.I*(a.q*a.K-a.v*a.J)+
a.A*(a.v*a.L-a.G*a.K)+a.B*(a.G*a.J-a.q*a.L));b.p=c*(a.L*(a.q*a.r-a.v*a.w)+a.J*(a.v*a.H-a.G*a.r)+a.K*(a.G*a.w-a.q*a.H));b.I=c*(a.G*(a.r*a.A-a.w*a.B)+a.q*(a.H*a.B-a.r*a.I)+a.v*(a.w*a.I-a.H*a.A));b.J=c*(a.w*(a.p*a.K-a.B*a.C)+a.r*(a.A*a.C-a.p*a.J)+a.u*(a.B*a.J-a.A*a.K));b.K=c*(a.A*(a.t*a.K-a.v*a.C)+a.B*(a.q*a.C-a.t*a.J)+a.p*(a.v*a.J-a.q*a.K));b.C=c*(a.J*(a.t*a.r-a.v*a.u)+a.K*(a.q*a.u-a.t*a.w)+a.C*(a.v*a.w-a.q*a.r));b.L=c*(a.q*(a.r*a.p-a.u*a.B)+a.v*(a.u*a.A-a.w*a.p)+a.t*(a.w*a.B-a.r*a.A));b.Qa=a.Qa;return true}
function ob(a){var b=new I(false);if(nb(a,b)){b.ia(a);return true}return false}function pb(a){var b=new I(false);b.q=a.q;b.v=a.w;b.t=a.A;b.G=a.J;b.w=a.v;b.r=a.r;b.u=a.B;b.H=a.K;b.A=a.t;b.B=a.u;b.p=a.p;b.I=a.C;b.J=a.G;b.K=a.H;b.C=a.I;b.L=a.L;b.Qa=a.Qa;return b}
function qb(a,b,c){a.Qa=false;switch(b){case 0:a.q=c;break;case 1:a.v=c;break;case 2:a.t=c;break;case 3:a.G=c;break;case 4:a.w=c;break;case 5:a.r=c;break;case 6:a.u=c;break;case 7:a.H=c;break;case 8:a.A=c;break;case 9:a.B=c;break;case 10:a.p=c;break;case 11:a.I=c;break;case 12:a.J=c;break;case 13:a.K=c;break;case 14:a.C=c;break;case 15:a.L=c;break}}I.prototype.e=function(){var a=new I(false);this.ia(a);return a};
I.prototype.ia=function(a){a.q=this.q;a.v=this.v;a.t=this.t;a.G=this.G;a.w=this.w;a.r=this.r;a.u=this.u;a.H=this.H;a.A=this.A;a.B=this.B;a.p=this.p;a.I=this.I;a.J=this.J;a.K=this.K;a.C=this.C;a.L=this.L;a.Qa=this.Qa};function rb(a,b,c,d,e){b=1/Math.tan(b/2);a.q=b/c;a.v=0;a.t=0;a.G=0;a.w=0;a.r=b;a.u=0;a.H=0;a.A=0;a.B=0;a.p=e/(e-d);a.I=1;a.J=0;a.K=0;a.C=-d*e/(e-d);a.L=0;a.Qa=false}
function sb(a,b,c,d,e){a.q=2/b;a.v=0;a.t=0;a.G=0;a.w=0;a.r=2/c;a.u=0;a.H=0;a.A=0;a.B=0;a.p=1/(e-d);a.I=0;a.J=0;a.K=0;a.C=d/(d-e);a.L=1;a.Qa=false}function tb(a,b,c,d){c=c.substract(b);c.normalize();d=Ga(d,c);d.normalize();var e=Ga(c,d);a.q=d.c;a.v=e.c;a.t=c.c;a.G=0;a.w=d.b;a.r=e.b;a.u=c.b;a.H=0;a.A=d.d;a.B=e.d;a.p=c.d;a.I=0;a.J=-d.la(b);a.K=-e.la(b);a.C=-c.la(b);a.L=1;a.Qa=false}
function ub(a,b){var c=w(b,n.Nd);b=Math.cos(c.c);var d=Math.sin(c.c),e=Math.cos(c.b),f=Math.sin(c.b),g=Math.cos(c.d);c=Math.sin(c.d);a.q=e*g;a.v=e*c;a.t=-f;var h=d*f;f=b*f;a.w=h*g-b*c;a.r=h*c+b*g;a.u=d*e;a.A=f*g+d*c;a.B=f*c-d*g;a.p=b*e;a.Qa=false}
function vb(a){var b=-Math.asin(a.t),c=Math.cos(b);b*=n.Fe;var d,e;if(Math.abs(c)>1.0E-8){var f=1/c;d=a.p*f;e=a.u*f;c=Math.atan2(e,d)*n.Fe;d=a.q*f;e=a.v*f}else{c=0;d=a.r;e=-a.w}a=Math.atan2(e,d)*n.Fe;if(c<0)c+=360;if(b<0)b+=360;if(a<0)a+=360;return new s(c,b,a)}function wb(a,b){a.J=b.c;a.K=b.b;a.C=b.d;a.Qa=false}function xb(a,b){a.q=b.c;a.r=b.b;a.p=b.d;a.Qa=false}function yb(a,b){var c=Qa(b),d;for(d=0;d<8;++d)lb(a,c[d]);a=c[0];b.D=a.e();b.N=a.e();for(d=1;d<8;++d)C(b,c[d])}
I.prototype.toString=function(){return this.q+" "+this.v+" "+this.t+" "+this.G+"\n"+this.w+" "+this.r+" "+this.u+" "+this.H+"\n"+this.A+" "+this.B+" "+this.p+" "+this.I+"\n"+this.J+" "+this.K+" "+this.C+" "+this.L};function zb(a,b,c,d){this.d=this.b=this.c=0;this.Fa=1;if(a!=null)this.c=a;if(b!=null)this.b=b;if(c!=null)this.d=c;if(d!=null)this.Fa=d}l=zb.prototype;l.c=0;l.b=0;l.d=0;l.Fa=0;l.e=function(){var a=new zb;this.ia(a);return a};l.ia=function(a){a.c=this.c;a.b=this.b;a.d=this.d;a.Fa=this.Fa};function Bb(a,b){return new zb(a.c*b,a.b*b,a.d*b,a.Fa*b)}zb.prototype.ua=function(a){this.c+=a.c;this.b+=a.b;this.d+=a.d;this.Fa+=a.Fa;return this};
function Cb(a,b,c,d){var e=b.la(c);if(e<0){b=Bb(b,-1);e*=-1}if(e+1>0.05)if(1-e>=0.05){var f=Math.acos(e),g=1/Math.sin(f);e=Math.sin(f*(1-d))*g;d=Math.sin(f*d)*g}else{e=1-d;d=d}else{c=new zb(-b.b,b.c,-b.Fa,b.d);e=Math.sin(n.PI*(0.5-d));d=Math.sin(n.PI*d)}b=Bb(b,e).ua(Bb(c,d));a.c=b.c;a.b=b.b;a.d=b.d;a.Fa=b.Fa}zb.prototype.la=function(a){return this.c*a.c+this.b*a.b+this.d*a.d+this.Fa*a.Fa};
function Db(a){var b=new I(false),c=a.c,d=a.b,e=a.d;a=a.Fa;b.q=1-2*d*d-2*e*e;b.w=2*c*d+2*e*a;b.A=2*c*e-2*d*a;b.J=0;b.v=2*c*d-2*e*a;b.r=1-2*c*c-2*e*e;b.B=2*e*d+2*c*a;b.K=0;b.t=2*c*e+2*d*a;b.u=2*e*d-2*c*a;b.p=1-2*c*c-2*d*d;b.C=0;b.G=0;b.H=0;b.I=0;b.L=1;b.Qa=false;return b}function Eb(a,b){var c=a.Fa*a.Fa,d=a.c*a.c,e=a.b*a.b,f=a.d*a.d;b.d=Math.atan2(2*(a.c*a.b+a.d*a.Fa),d-e-f+c);b.c=Math.atan2(2*(a.b*a.d+a.c*a.Fa),-d-e+f+c);b.b=Math.asin(n.ic(-2*(a.c*a.d-a.b*a.Fa),-1,1))}
function Fb(a,b,c,d){var e=b*0.5;b=Math.sin(e);var f=Math.cos(e);e=c*0.5;c=Math.sin(e);var g=Math.cos(e);e=d*0.5;d=Math.sin(e);var h=Math.cos(e);e=g*h;h=c*h;g=g*d;c=c*d;a.c=b*e-f*c;a.b=f*h+b*g;a.d=f*g-b*h;a.Fa=f*e+b*c;a.normalize()}zb.prototype.normalize=function(){var a=this.c*this.c+this.b*this.b+this.d*this.d+this.Fa*this.Fa;if(a!=1){a=a=1/Math.sqrt(a);this.c*=a;this.b*=a;this.d*=a;this.Fa*=a}};zb.prototype.toString=function(){return"(x: "+this.c+" y:"+this.b+" z:"+this.d+" w:"+this.Fa+")"};function Gb(){this.bb=[];for(var a=0;a<Hb;++a)this.bb.push(new Va)}Gb.prototype.bb=null;var Hb=6;
Gb.prototype.Zk=function(a){var b;b=this.bb[2];b.j.c=a.G+a.q;b.j.b=a.H+a.w;b.j.d=a.I+a.A;b.cb=a.L+a.J;b=this.bb[3];b.j.c=a.G-a.q;b.j.b=a.H-a.w;b.j.d=a.I-a.A;b.cb=a.L-a.J;b=this.bb[5];b.j.c=a.G-a.v;b.j.b=a.H-a.r;b.j.d=a.I-a.B;b.cb=a.L-a.K;b=this.bb[4];b.j.c=a.G+a.v;b.j.b=a.H+a.r;b.j.d=a.I+a.B;b.cb=a.L+a.K;b=this.bb[0];b.j.c=a.G-a.t;b.j.b=a.H-a.u;b.j.d=a.I-a.p;b.cb=a.L-a.C;b=this.bb[1];b.j.c=a.t;b.j.b=a.u;b.j.d=a.p;b.cb=a.C;for(a=a=0;a<Hb;++a){b=this.bb[a];var c=-(1/b.j.getLength());b.j=w(b.j,c);b.cb*=
c}};function Ib(a){var b=new s;Xa(a.bb[0],a.bb[5],a.bb[2],b);return b}function Jb(a){var b=new s;Xa(a.bb[0],a.bb[5],a.bb[3],b);return b}function Kb(a){var b=new s;Xa(a.bb[0],a.bb[4],a.bb[3],b);return b}function Lb(a){var b=new s;Xa(a.bb[0],a.bb[4],a.bb[2],b);return b}Gb.prototype.ob=function(a){var b=new B;b.reset(a.c,a.b,a.d);C(b,Ib(this));C(b,Jb(this));C(b,Lb(this));C(b,Kb(this));return b};
function Mb(a,b){b=Qa(b);for(var c=0;c<6;++c){for(var d=false,e=0;e<8;++e){var f;f=a.bb[c];f=f.j.la(b[e])+f.cb;f=f<-1.0E-6?1:f>1.0E-6?0:2;if(f!=0){d=true;break}}if(!d)return false}return true};function Nb(a){if(a){this.f=new s;this.j=new s;this.na=4282400832;this.ta=new Na;this.ud=new Na}}l=Nb.prototype;l.f=null;l.j=null;l.na=0;l.ta=null;l.ud=null;n.Ds=function(a){var b=new Nb;b.f=a.f.e();b.na=a.na;b.j=a.j.e();b.ta=a.ta.e();b.ud=a.ud.e();return b};n.Ga=function(a,b,c,d,e,f,g,h,j){var m=new Nb(true);m.f.c=a;m.f.b=b;m.f.d=c;m.j.c=d;m.j.b=e;m.j.d=f;m.na=g;m.ta.c=h;m.ta.b=j;m.ud.c=h;m.ud.b=j;return m};function Ob(){this.n="";this.sc=false;this.tf=this.uf=this.Hd=this.Id=this.Dg=this.La=this.rd=null}Ob.prototype.Nb=function(){if(this.rd)return this.rd.width;if(this.Id!=null)return this.Id;return 0};Ob.prototype.Mb=function(){if(this.rd)return this.rd.height;if(this.Hd!=null)return this.Hd;return 0};function Pb(){this.hb="";this.gc=null;this.ea=false;this.h="SetOverlayText"}Pb.prototype.i=function(a,b){var c=new Pb;c.hb=this.hb;c.gc=this.gc;c.ea=this.ea;if(c.gc==a)c.gc=b;return c};
Pb.prototype.execute=function(a,b){if(a&&b){var c=null;if(this.ea)c=a;else if(this.gc!=-1)c=Qb(b,this.gc);if(c&&c.mn){var d=this.hb.indexOf("$");if(d!=-1){a=this.hb;for(var e=0,f=true;f;){f=false;d=a.indexOf("$",e);if(d!=-1){e=d+1;var g=a.indexOf("$",d+1);if(g!=-1){f=true;var h=a.substr(d+1,g-(d+1));if(h=Rb(h,false,b)){d=a.substr(0,d);d+=Ub(h);e=d.length+1;d+=a.substr(g+1,a.length-g);a=d}}}}c.mn(a)}else c.mn(this.hb)}}};
function Vb(){this.Qj=0;this.Gf=null;this.ea=false;this.h="MakeSceneNodeInvisible"}Vb.prototype.i=function(a,b){var c=new Vb;c.Qj=this.Qj;c.Gf=this.Gf;c.ea=this.ea;if(c.Gf==a)c.Gf=b;return c};Vb.prototype.execute=function(a,b){if(a&&b){var c=null;if(this.ea)c=a;else if(this.Gf!=-1)c=Qb(b,this.Gf);if(c)switch(this.Qj){case 0:c.Z=false;break;case 1:c.Z=true;break;case 2:c.Z=!c.Z;break}}};function Wb(){this.dd=this.fe=false;this.h="ChangeSceneNodePosition"}
Wb.prototype.i=function(a,b){var c=new Wb;c.Ee=this.Ee;c.Zc=this.Zc;c.Yc=this.Yc;c.ea=this.ea;c.Cf=this.Cf;c.ka=this.ka?this.ka.e():null;c.pj=this.pj?this.pj.e():null;c.fe=this.fe;c.dd=this.dd;if(c.Zc==a)c.Zc=b;if(c.Yc==a)c.Yc=b;return c};
Wb.prototype.execute=function(a,b){if(a&&b){var c=null;if(this.ea)c=a;else if(this.Zc!=-1)c=Qb(b,this.Zc);if(c){var d=null;switch(this.Ee){case 0:d=this.ka.e();break;case 1:d=c.f.add(this.ka);break;case 2:var e=null;if(this.Cf)e=a;else if(this.Yc!=-1)e=Qb(b,this.Yc);if(e)d=e.f.add(this.ka);break;case 3:d=this.ka.getLength();a=c.aa;b=new s(1,0,0);eb(a,b);if(c.l()=="camera")b=c.ha.substract(c.f);ua(b,d);d=c.f.add(b);break;case 4:a=new B;a.reset(this.ka.c,this.ka.b,this.ka.d);C(a,this.pj);d=new s;d.c=
a.D.c+Math.random()*(a.N.c-a.D.c);d.b=a.D.b+Math.random()*(a.N.b-a.D.b);d.d=a.D.d+Math.random()*(a.N.d-a.D.d);break;case 5:d=b.zl.add(this.ka);break}if(d!=null)if(this.fe&&this.dd>0){a=new Xb;a.ca=c.f.e();a.S=d;a.wd=this.dd;a.Bh=true;Yb(a);Zb(c,a)}else c.f=d}}};function $b(){this.h="ChangeSceneNodeRotation"}$b.prototype.i=function(a,b){var c=new $b;c.sm=this.sm;c.Ig=this.Ig;c.ea=this.ea;c.ka=this.ka?this.ka.e():null;c.qk=this.qk;c.Gm=this.Gm;if(c.Ig==a)c.Ig=b;return c};
$b.prototype.execute=function(a,b){if(a&&b){var c=null;if(this.ea)c=a;else if(this.Ig!=-1)c=Qb(b,this.Ig);if(c){b=null;switch(this.sm){case 0:b=this.ka.e();break;case 1:b=c.V.add(this.ka);break}if(b)if(this.qk){a=new ac;b=b;var d=c.V,e=this.Gm;a.jo=true;a.He=b.e();a.wn=d.e();a.rm=a.Va+e;Zb(c,a)}else c.V=b}}};function bc(){this.h="ChangeSceneNodeScale"}bc.prototype.i=function(a,b){var c=new bc;c.um=this.um;c.Jg=this.Jg;c.ea=this.ea;c.ka=this.ka?this.ka.e():null;if(c.Jg==a)c.Jg=b;return c};
bc.prototype.execute=function(a,b){if(a&&b){var c=null;if(this.ea)c=a;else if(this.Jg!=-1)c=Qb(b,this.Jg);if(c)switch(this.um){case 0:c.sa=this.ka.e();break;case 1:c.sa=Ca(c.sa,this.ka);break}}};function cc(){this.h="ChangeSceneNodeTexture"}cc.prototype.i=function(a,b){var c=new cc;c.vd=this.vd;c.gc=this.gc;c.ea=this.ea;c.Vg=this.Vg;c.tl=this.tl;if(c.gc==a)c.gc=b;return c};
cc.prototype.execute=function(a,b){if(a&&b){var c=null;if(this.ea)c=a;else if(this.gc!=-1)c=Qb(b,this.gc);if(c)if(c.l()=="2doverlay")c.La=this.Vg;else{a=c.hd();if(this.vd==0)for(b=0;b<a;++b){var d=c.Cc(b);d.pa=this.Vg}else if(this.vd==1){d=c.Cc(this.tl);if(d!=null)d.pa=this.Vg}}}};function dc(){this.h="ExecuteJavaScript"}dc.prototype.i=function(){var a=new dc;a.wl=this.wl;return a};dc.prototype.execute=function(a){n.Wm=a;eval(this.wl);n.Wm=null};function ec(){this.h="OpenWebpage"}
ec.prototype.i=function(){var a=new ec;a.Jm=this.Jm;a.ha=this.ha;return a};ec.prototype.execute=function(){window.open(this.Jm,this.ha)};function fc(){this.h="SetSceneNodeAnimation"}fc.prototype.i=function(a,b){var c=new fc;c.Hg=this.Hg;c.ea=this.ea;c.dc=this.dc;c.dl=this.dl;if(c.Hg==a)c.Hg=b;return c};fc.prototype.execute=function(a,b){if(a&&b){var c=null;if(this.ea)c=a;else if(this.Hg!=-1)c=Qb(b,this.Hg);if(c){a=c;a.l()=="animatedmesh"&&gc(a,this.dl,this.dc)}}};
function hc(a){this.Ha=a;this.h="SwitchToScene"}hc.prototype.i=function(){var a=new hc;a.Ff=this.Ff;return a};hc.prototype.execute=function(){this.Ha&&ic(this.Ha,this.Ff,true)};function mc(a){this.Ha=a;this.h="SetActiveCamera"}mc.prototype.i=function(a,b){var c=new mc;c.fg=this.fg;if(c.fg==a)c.fg=b;return c};mc.prototype.execute=function(a,b){if(a&&b){a=null;if(this.fg!=-1)a=Qb(b,this.fg);a!=null&&a.l()=="camera"&&this.Ha&&nc(this.Ha,a)}};
function oc(){this.fe=false;this.dd=0;this.h="SetCameraTarget"}oc.prototype.i=function(){var a=new oc;a.Ee=this.Ee;a.Zc=this.Zc;a.Yc=this.Yc;a.ea=this.ea;a.Cf=this.Cf;a.ka=this.ka?this.ka.e():null;a.fe=this.fe;a.dd=this.dd;return a};
oc.prototype.execute=function(a,b){if(a&&b){var c=null;if(this.ea)c=a;else if(this.Zc!=-1)c=Qb(b,this.Zc);var d=c;if(d.l()=="camera"){var e=d.ha.e();switch(this.Ee){case 0:e=this.ka.e();break;case 1:e=c.f.add(this.ka);break;case 2:var f=null;if(this.Cf)f=a;else if(this.Yc!=-1)f=Qb(b,this.Yc);if(f)e=f.f.add(this.ka);break}if(e!=null)if(this.fe&&this.dd>0){a=new Xb;a.ca=d.ha.e();a.S=e;a.wd=this.dd;a.Bh=true;a.rh=true;Yb(a);Zb(c,a)}else{pc(d,e);c=N(d,"camerafps");c!=null&&qc(c,e)}}}};
function rc(){this.uj=this.te=this.xi=0;this.If=-1;this.ed=100;this.h="Shoot";this.Hf=-1;this.yk=false;this.nh=this.qh=null;this.xk=new s}rc.prototype.i=function(a,b){var c=new rc;c.xi=this.xi;c.te=this.te;c.uj=this.uj;c.If=this.If;c.ed=this.ed;c.Hf=this.Hf;c.yk=this.yk;c.qh=this.qh;c.nh=this.nh?this.nh.i(a,b):null;c.xk=this.xk.e();if(c.If==a)c.If=b;if(c.Hf==a)c.Hf=b;return c};
rc.prototype.execute=function(a,b){if(a&&b){var c=new La,d=false,e=null,f=null,g=sc(b,"gameai");if(this.Hf!=-1){a=Qb(b,this.Hf);if(a!=null){d=true;e=a;c.ca=Oa(a.ob());c.ca.ua(this.xk);lb(a.aa,c.ca);f=b.da;if(this.yk&&f){a=new La;a.ca=O(f);a.S=f.ha;f=Ma(a);ua(f,this.ed);a.S=a.ca.add(f);tc(this,a,g,this.ed,b);uc(this,a,g,this.ed,e,b);c.S=a.S}else{f=a.aa;if(this.qh){a=new I;ub(a,this.qh);f=K(f,a)}c.S.set(1,0,0);eb(f,c.S);c.S.ua(c.ca)}}}else if(a!=null){e=a;if((f=N(a,"gameai"))&&f.jl){c=f.kl;d=true}}if(!d)if(f=
b.da){e=f;c.ca=O(f);c.S=f.ha;d=true}if(d){d=Ma(c);ua(d,this.ed);c.S=c.ca.add(d);tc(this,c,g,this.ed,b);if(this.xi==1){g=null;if(this.If!=-1)g=Qb(b,this.If);if(g){g=g.i(b.Ua,-1,-1);vc(b.Ua,g);if(g!=null){g.f=c.ca;P(g);g.Z=true;g.Oa=-1;g.n="";b=Ma(c);b=Ha(b);g.V=b;b=this.uj;if(b==0)b=1;d=new Xb;d.ca=c.ca;d.S=c.S;d.wd=c.getLength()/b;d.Bh=true;Yb(d);d.yo=true;d.ro=e;d.qo=this.te;d.Ej=true;d.dg=this.nh;d.Fh=this.ed/b;Zb(g,d)}}}else if(this.xi==0){e=uc(this,c,g,this.ed,e,b);if(e!=null){b.zl=c.S.e();(c=
N(e,"gameai"))&&wc(c,this.te,e)}}}}};function tc(a,b,c,d,e){if(c.length!=0)if(a=N(c[0],"gameai"))if(a=a.ja){e=xc(yc.prototype,e,b.ca,b.S,a,true);if(e<d){d=Ma(b);ua(d,e);b.S=b.ca.add(d)}}}function uc(a,b,c,d,e,f){a=d;d=null;for(var g=0;g<c.length;++g)if(c[g]!==e){var h=N(c[g],"gameai");if(!(h&&!(h.bc>0))){h={};h.Sa=0;if(zc(yc.prototype,f,c[g],b,false,false,null,h))if(h.Sa<a){a=h.Sa;d=c[g]}}}if(d){c=Ma(b);ua(c,a);b.S=b.ca.add(c)}return d}function Ac(){this.h="SetOrChangeAVariable"}
Ac.prototype.i=function(){var a=new Ac;a.Vb=this.Vb;a.Yl=this.Yl;a.Tf=this.Tf;a.ge=this.ge;return a};
Ac.prototype.execute=function(a,b){if(a&&b)if(this.Vb!=null){a=Rb(this.Vb,true,b);if(a!=null){var c=null;if(this.Tf==1){c=Rb(this.ge,false,b);if(c==null)return}if(c==null){c=new Bc;Cc(c,this.ge)}switch(this.Yl){case 0:c=c;if(c!=null){a.kc=c.kc;a.cd=c.cd;a.rc=c.rc;a.pc=c.pc}break;case 1:Dc(a,Q(a)+Q(c));break;case 2:Dc(a,Q(a)-Q(c));break;case 3:c=Q(c);Dc(a,c!=0?Q(a)/c:0);break;case 4:c=Q(c);Ec(a,c!=0?Math.floor(Q(a)/c):0);break;case 5:Dc(a,Q(a)*Q(c));break;case 6:Ec(a,Math.floor(Q(a)*Q(c)));break}Gc(a,
b)}}};function Hc(){this.h="IfVariable"}Hc.prototype.i=function(a,b){var c=new Hc;c.Vb=this.Vb;c.wj=this.wj;c.Tf=this.Tf;c.ge=this.ge;c.s=this.s?this.s.i(a,b):null;c.Ei=this.Ei?this.Ei.i(a,b):null;return c};
Hc.prototype.execute=function(a,b){if(a&&b)if(this.Vb!=null){var c=Rb(this.Vb,true,b);if(c!=null){var d=null;if(this.Tf==1){d=Rb(this.ge,false,b);if(d==null)return}if(d==null){d=new Bc;Cc(d,this.ge)}b=false;switch(this.wj){case 0:case 1:b=c.kc==0&&d.kc==0?Ub(c)==Ub(d):n.F(Q(c),Q(d));if(this.wj==1)b=!b;break;case 2:b=Q(c)>Q(d);break;case 3:b=Q(c)<Q(d);break}if(b)this.s&&this.s.execute(a);else this.Ei&&this.Ei.execute(a)}}};function Ic(){this.oi=null;this.ea=false;this.h="RestartBehaviors"}
Ic.prototype.i=function(a,b){var c=new Ic;c.oi=this.oi;c.ea=this.ea;if(c.ea==a)c.ea=b;return c};Ic.prototype.execute=function(a,b){if(a&&b){var c=null;if(this.ea)c=a;else if(this.oi!=-1)c=Qb(b,this.oi);if(c)for(a=0;a<c.ma.length;++a){b=c.ma[a];b!=null&&b.reset()}}};function Jc(){this.h="PlaySound"}Jc.prototype.i=function(a,b){var c=new Jc;c.$c=this.$c;c.Cg=this.Cg;c.gm=this.gm?this.gm.e():null;c.Ae=this.Ae;c.Sh=this.Sh;c.vf=this.vf;c.Yg=this.Yg;c.Bg=this.Bg;c.Ub=this.Ub;if(c.$c==a)c.$c=b;return c};
Jc.prototype.execute=function(a,b){if(!(b==null||this.Ub==null))this.Wc=Kc(n.je,this.Ub,this.vf,this.Yg)};function Lc(){this.h="StopSpecificSound"}Lc.prototype.i=function(){var a=new Lc;a.Ub=this.Ub;return a};Lc.prototype.execute=function(a,b){b==null||this.Ub==null||Mc(n.je,this.Ub.n)};function Nc(){this.h="StopSound"}Nc.prototype.i=function(){var a=new Nc;a.uo=this.uo;a.Uq=this.Uq;return a};
Nc.prototype.execute=function(){for(var a=n.je,b=0;b<a.Kb.length;++b){var c=a.Kb[b];c.Si=true;c.src.hc.pause()}a.Kb=[]};function Oc(){this.h="StoreLoadVariable"}Oc.prototype.i=function(){var a=new Oc;a.Wj=this.Wj;a.Vb=this.Vb;return a};function Pc(a,b,c,d){a=new Date;a.setDate(a.getDate()+d);c=escape(c)+("; expires="+a.toUTCString());document.cookie=b+"="+c}
function Qc(a,b){a=document.cookie.split(";");for(var c=0;c<a.length;++c){var d=a[c],e=d.indexOf("="),f=d.substr(0,e);f=f.replace(/^\s+|\s+$/g,"");if(f==b)return unescape(d.substr(e+1))}return null}Oc.prototype.execute=function(a,b){if(!(this.Vb==null||this.Vb=="")){a=Rb(this.Vb,this.Wj,b);if(a!=null)try{this.Wj?Cc(a,Qc(this,a.getName())):Pc(this,a.getName(),Ub(a),99)}catch(c){}}};function Rc(a){this.cf=[];this.Ba=a}
Rc.prototype.execute=function(a){for(var b=0;b<this.cf.length;++b)this.cf[b].execute(a,this.Ba)};function Sc(a,b){b!=null&&a.cf.push(b)}function Tc(a,b){for(var c=0;c<a.cf.length;++c){var d=a.cf[c];if(d.h==b)return d}return null}Rc.prototype.i=function(a,b){for(var c=new Rc(this.Ba),d=0;d<this.cf.length;++d){var e=this.cf[d];e.i!=null&&Sc(c,e.i(a,b))}return c};function Uc(a){this.Ha=a;this.h="RestartScene"}Uc.prototype.i=function(){var a=new Uc;a.Ff=this.Ff;return a};
Uc.prototype.execute=function(){this.Ha&&this.Ha.jn(this.Ff)};function Vc(){this.h="ActionDeleteSceneNode"}Vc.prototype.i=function(a,b){var c=new Vc;c.Lg=this.Lg;c.nl=this.nl;c.Cm=this.Cm;if(c.Lg==a)c.Lg=b;return c};Vc.prototype.execute=function(a,b){if(a&&b){var c=null;if(this.nl)c=a;else if(this.Lg!=-1)c=Qb(b,this.Lg);c!=null&&Wc(b,c,this.Cm)}};function Xc(){this.h="ActionCloneSceneNode"}
Xc.prototype.i=function(a,b){var c=new Xc;c.Kg=this.Kg;c.il=this.il;c.s=this.s?this.s.i(a,b):null;if(c.Kg==a)c.Kg=b;return c};Xc.prototype.execute=function(a,b){if(a&&b){var c=null;if(this.il)c=a;else if(this.Kg!=-1)c=Qb(b,this.Kg);if(c){a=c.Oa;var d=-1;d=Yc(b);a=c.i(c.mb,a,d);if(a!=null){a.Oa=d;vc(c.mb,a);b.aj(c,a);if(c=c.gb)if(c=c.i(a)){a.gb=c;b.Jd&&Zc(b.Jd,c)}this.s&&this.s.execute(a)}}}};function $c(a){this.h="ActionPlayMovie";this.Ha=a}
$c.prototype.i=function(a,b){var c=new $c;c.vf=this.vf;c.vj=this.vj;c.Hm=this.Hm;c.$c=this.$c;c.Cg=this.Cg;c.Fl=this.Fl;c.nj=this.nj?this.nj.i(a,b):null;c.mj=this.mj?this.mj.i(a,b):null;if(c.$c==a)c.$c=b;return c};
$c.prototype.execute=function(a,b){if(a&&b){var c=null;if(this.Cg)c=a;else if(this.$c!=-1)c=Qb(b,this.$c);a:{a=this.Ha;var d=this.Hm;b=this.nj;for(var e=this.mj,f=0;f<a.hh.length;++f){var g=a.hh[f];if(g.filename==d){a=g;break a}}if(this.vj==0){d=new ad(d,a.O);d.Rk=b;d.Sk=e;a.hh.push(d);a=d}else a=null}if(a!=null)switch(this.vj){case 0:a.play(this.vf);if(c)if(c.l()=="2doverlay")c.La=a.gj;else{c=c.Cc(this.Fl);if(c!=null)c.pa=a.gj}break;case 1:a.pause();break;case 2:a.stop();break}}};
function ad(a,b){this.filename=a;this.Ad=null;this.kn=b;this.Sk=this.Rk=this.gj=null;this.Ls=this.Yi=this.Hp=false;this.state=0;this.$m=this.Bp=false;this.$r=function(){this.state=2;this.Ad.play();this.Hp=true;var c=this.gj,d=bd(this.kn,this.Ad,true);c.La=d.La;c.Id=d.Id;c.Hd=d.Hd;c.uf=d.uf;c.tf=d.tf};this.as=function(){this.state=0;this.Yi=true};this.gr=function(){this.state=0;this.$m=this.Yi=true};this.play=function(c){if(!(this.state==2||this.state==1)){if(this.Ad)if(this.state==3){this.Ad.play();
this.state=2;this.Yi=false;return}else if(this.state==0){this.Ad.currentTime=0;this.Ad.play();this.state=2;this.Yi=false;return}var d=document.createElement("video"),e=this;this.Ad=d;this.Bp=c;d.addEventListener("canplaythrough",function(){e.$r()},true);d.addEventListener("ended",function(){e.as()},true);d.addEventListener("error",function(){e.gr()},true);d.preload="auto";d.src=a;d.style.display="none";if(this.Bp)d.loop=true;this.state=1;c=document.createElement("canvas");if(c!=null){c.width=16;c.height=
16;this.gj=bd(this.kn,c,true)}}};this.pause=function(){if(this.state==2){this.Ad.pause();this.state=3}};this.stop=function(){if(this.state==2){this.Ad.pause();this.state=0}};this.Yr=function(){this.Hp&&this.state==2&&cd(this.kn,this.gj,this.Ad)};this.vr=function(){if(this.state==0)return true;return this.Yi}};function dd(){this.h=0;this.yc=this.pa=null;this.Re=true;this.Qb=this.Zb=false;this.Ed=true}dd.prototype.Zk=function(a){if(a){this.h=a.h;this.Re=a.Re;this.pa=a.pa;this.yc=a.yc;this.Zb=a.Zb;this.Qb=a.Qb;this.Ed=a.Ed}};dd.prototype.e=function(){var a=new dd;a.h=this.h;a.Ik=this.Ik;a.Re=this.Re;a.pa=this.pa;a.yc=this.yc;a.Zb=this.Zb;a.Qb=this.Qb;a.Ed=this.Ed;return a};function ed(a){return a.h==fd||a.h==gd||a.h==hd||a.h==id||a.h==jd}l=dd.prototype;l.h=0;l.pa=null;l.yc=null;l.Re=true;l.Ik=true;l.Zb=false;
l.Ed=true;l.Qb=false;var fd=12,gd=13,jd=16,hd=14,id=26;function kd(){this.g=new B;this.m=new dd;this.T=[];this.k=[];this.ab=null;this.ik=this.hk=false;this.Gd=this.de=null}l=kd.prototype;l.g=null;l.m=null;l.T=null;l.k=null;l.ab=null;l.de=null;l.Gd=null;l.update=function(a,b){if(a)this.hk=true;else if(b)this.ik=true;else this.ab=null};function ld(a){if(!a.k||a.k.length==0)a.g.reset(0,0,0);else{var b=a.k[0];a.g.D=b.f.e();a.g.N=b.f.e();for(var c=1;c<a.k.length;++c){b=a.k[c];C(a.g,b.f)}}}
kd.prototype.i=function(){var a=new kd;a.g=this.g.e();a.m=this.m.e();if(this.k)for(var b=0;b<this.k.length;++b)a.k.push(this.k[b]);if(this.T)for(b=0;b<this.T.length;++b)a.T.push(this.T[b]);if(this.de)for(b=0;b<this.de.length;++b)a.de.push(this.de[b].e());if(this.Gd)for(b=0;b<this.Gd.length;++b)a.Gd.push(this.Gd[b].e());return a};function md(){this.g=new B;this.wa=[]}md.prototype.Cd=function(a){this.wa.push(a)};function nd(a){var b=0;if(a.wa)for(var c=0;c<a.wa.length;++c)if(a.wa[c].T)b+=a.wa[c].T.length;return b/3}md.prototype.i=function(){var a=new md;a.g=this.g.e();if(this.wa)for(var b=0;b<this.wa.length;++b)this.wa[b]&&a.wa.push(this.wa[b].i());return a};n.rq=function(){this.Gl=[]};function od(a,b){for(var c=0;c<a.Gl.length;++c){var d=a.Gl[c];if(d.n==b)return d}return null}n.Oq=function(){this.n="";this.Rh=new I;this.ba=[];this.th=[];this.Af=[];this.Ie=[];this.Ef=[];this.Vf=[];this.Ai=new B;this.Mj=new I;this.lf=new I;this.sg=new I;this.Hc=new s(0,0,0);this.Yb=new s(1,1,1);this.Ic=new zb;this.Kh=new I;this.Hn=false;this.Jp=this.Kp=this.Cp=-1};n.Sq=function(){this.fj=this.ij=this.Qi=0;this.wo=new s;this.vo=new s};
n.Rq=function(){this.frame=0;this.scale=new s};n.Pq=function(){this.frame=0;this.position=new s};n.Qq=function(){this.frame=0;this.rotation=new zb};n.Yh=function(){this.n="";this.Mc=this.S=this.Fd=0};n.Yh.prototype.n="";n.Yh.prototype.Fd=0;n.Yh.prototype.S=0;n.Yh.prototype.Mc=0;n.ym=function(){this.n="";this.Dd=[];this.md=0;this.db=[];this.za=[];this.Df=[];this.ml=0;this.Xn=this.Qd=false;this.is=this.pq=this.yl=0;this.xb=new B;this.ng=1;this.Gk=[];this.qn=true;this.Ol=[]};n.ym.prototype.Cd=function(a){this.db.push(a)};
n.ym.prototype.ob=ca("xb");function pd(a,b,c){if(!(b==null&&c!=null))if(b==null)for(b=0;b<a.Df.length;++b)pd(a,a.Df[b],null);else{b.Mj=c==null?b.Rh.e():K(c.Mj,b.Rh);b.sg=b.Rh.e();b.lf=b.Mj.e();if(bb(b.Kh)){b.Kh=b.Mj.e();ob(b.Kh)}for(c=0;c<b.ba.length;++c)pd(a,b.ba[c],b)}}
function qd(a,b,c,d,e,f,g,h){var j=-1;e=j=-1;var m=c.Af;e=c.Ie;c=c.Ef;var o;if(m.length){j=-1;if(j==-1)for(g=0;g<m.length;++g){o=m[g];if(o.frame>=b){j=g;break}}if(j!=-1)if(a.ng==0||j==0){o=m[j];o.position.e()}else if(a.ng==1){o=m[j];m=m[j-1];g=b-o.frame;j=m.frame-b;wa(d,ta(Aa(Aa(m.position.substract(o.position),1/(g+j)),g),o.position))}}if(e.length){j=-1;if(j==-1)for(g=0;g<e.length;++g){d=e[g];if(d.frame>=b){j=g;break}}if(j!=-1)if(a.ng==0||j==0){d=e[j];d.scale.e()}else if(a.ng==1){d=e[j];e=e[j-1];
g=b-d.frame;j=e.frame-b;wa(f,ta(Aa(Aa(e.scale.substract(d.scale),1/(g+j)),g),d.scale))}}if(c.length){e=-1;if(e==-1)for(g=0;g<c.length;++g){f=c[g];if(f.frame>=b){e=g;break}}if(e!=-1)if(a.ng==0||e==0){f=c[e];f.rotation.e()}else if(a.ng==1){f=c[e];a=c[e-1];g=b-f.frame;j=a.frame-b;Cb(h,f.rotation,a.rotation,g/(g+j))}}}function rd(a,b,c){if(b==null)for(b=0;b<a.Df.length;++b)rd(a,a.Df[b],null);else{b.lf=c==null||b.Hn?b.sg.e():K(c.lf,b.sg);for(c=0;c<b.ba.length;++c)rd(a,b.ba[c],b)}}
function sd(a,b,c,d){if(b.Vf.length){c=K(b.lf,b.Kh);for(var e=new s,f=new s,g=a.db,h,j=0;j<b.Vf.length;++j){var m=b.Vf[j];h=m.wo;e.c=h.c*c.q+h.b*c.w+h.d*c.A+c.J;e.b=h.c*c.v+h.b*c.r+h.d*c.B+c.K;e.d=h.c*c.t+h.b*c.u+h.d*c.p+c.C;d&&jb(c,f,m.vo);h=g[m.Qi];h=h.k[m.ij];if(a.Gk[m.Qi][m.ij]){h.f.ua(w(e,m.fj));d&&h.j.ua(w(f,m.fj))}else{a.Gk[m.Qi][m.ij]=true;h.f=w(e,m.fj);if(d)h.j=w(f,m.fj)}}}for(c=0;c<b.ba.length;++c)sd(a,b.ba[c],b,d)}
function td(a,b){if(!b)return null;var c=a.Ol.length;b=b.toLowerCase();for(var d=0;d<c;++d){var e=a.Ol[d];if(e.n&&e.n.toLowerCase()==b)return e}return null};function ud(){this.Ma=[];this.O=null;this.kk=""}
function vd(a,b,c){if(b==null||b=="")return null;var d=wd(a,b);if(d!=null)return d;if(c){d=new Ob;d.n=b;xd(a,d);d.rd=new Image;d.rd.onload=function(){var e=d,f=a.O;if(f!=null){var g=f.P,h=g.createTexture(),j=e.rd;if((j.width&j.width-1)!=0||(j.height&j.height-1)!=0){var m=document.createElement("canvas");if(m!=null){m.width=yd(f,j.width);m.height=yd(f,j.height);m.getContext("2d").drawImage(j,0,0,j.width,j.height,0,0,m.width,m.height);j=m}}g.bindTexture(g.TEXTURE_2D,h);zd(f,h,j);g.generateMipmap(g.TEXTURE_2D);
g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR_MIPMAP_NEAREST);g.bindTexture(g.TEXTURE_2D,null);f.sn=true;e.La=h;e.sc=true}};d.rd.src=d.n;return d}return null}function wd(a,b){for(var c=0;c<a.Ma.length;++c){var d=a.Ma[c];if(d.n==b)return d}return null}function xd(a,b){if(b!=null){wd(a,b.n)!=null&&n.va.print("ERROR! Cannot add the texture multiple times: "+b.n);a.Ma.push(b)}};function Ad(a){this.Ko=a;this.br=a.length;this.Wa=0;this.ys=null;this.zs=8;this.Oo=false}function Bd(a){return a.br-a.Wa}function Cd(a,b){return a.Ko.charCodeAt(b)&255}function R(a){return Dd(a,1)!=0}function Ed(a,b){for(var c=0,d=a.Wa,e=d+b;e>d;)c=c*256+Cd(a,--e);a.Wa+=b;return c}function Dd(a,b){a=Ed(a,b);if(a&1<<b*8-1)a=(~a+1)*-1;return a}function U(a){return Dd(a,4)}
function V(a){var b;var c=a.Ko,d=a.Wa;b=c.charCodeAt(d+3)&255;var e=c.charCodeAt(d+2)&255,f=c.charCodeAt(d+1)&255;d=c.charCodeAt(d+0)&255;c=(b<<1&255|e>>7)-127;e=(e&127)<<16|f<<8|d;b=e==0&&c==-127?0:(1-2*(b>>7))*(1+e*Math.pow(2,-23))*Math.pow(2,c);a.Wa+=4;return b}Ad.prototype.Ca=function(a,b){this.Oo=a||0;this.buffer=[];if(b){for(var c=a=b.length,d=this.buffer=new Array(a);c;d[a-c]=b.charCodeAt(--c));this.Oo&&d.reverse()}};Ad.prototype.reset=function(){this.Wa=0;return this};function Fd(a){this.Ia=a;this.P=this.canvas=null;this.height=this.width=0;this.sn=false;this.oa=new I;this.Ab=new I;this.ja=new I;this.Xb=new oa;this.Xb.wc=0;this.Xb.qc=0;this.Xb.lc=0;this.Js=this.Ks=null;this.eb=[];this.rb=[];this.lb=[];this.sb=[];this.tb=[];this.Be=30;this.zk=this.Zh=this.hm=this.Zn=this.Yn=null;this.rf=[];this.ub=this.Gj=null;this.Wo=false;this.Zi=true;this.Md=null;this.Od=this.nf=false;this.ac=new oa;this.Ih=0.01;this.Ni=1;this.Oi=4;this.bd=false;this.ui=this.Pg=this.wm=this.vm=
null;this.po=false;this.ti=this.si=3.0E-6;this.vi=this.xs=0.5;this.Ji=false}Fd.prototype.Zh=null;Fd.prototype.Nb=ca("width");function Gd(a){var b=a.sn;a.sn=false;return b}Fd.prototype.Mb=ca("height");
function Hd(a,b,c){if(b!=null){var d=a.P;if(d!=null){var e=null;try{e=a.bd&&!c?a.tb[b.h]:a.Od?b.Qb?a.sb[b.h]:a.lb[b.h]:b.Qb?a.rb[b.h]:a.eb[b.h]}catch(f){}if(e!=null){a.ub=e;d.useProgram(e);if(a.Zh!=null)try{a.Zh(b.h)}catch(g){}e.nn!=null&&e.nn();if(e.Qo){d.enable(d.BLEND);d.blendFunc(e.Ro,e.Po)}else d.disable(d.BLEND);!b.Re||b.h==fd||b.h==gd||b.h==jd?d.depthMask(false):d.depthMask(true);b.Ik?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST);d.depthFunc(a.nf?d.GREATER:d.LEQUAL);b.Ed?d.enable(d.CULL_FACE):
d.disable(d.CULL_FACE);if(b.pa&&b.pa.sc){d.activeTexture(d.TEXTURE0);d.bindTexture(d.TEXTURE_2D,b.pa.La);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,b.Zb?d.CLAMP_TO_EDGE:d.REPEAT);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,b.Zb?d.CLAMP_TO_EDGE:d.REPEAT)}else{d.activeTexture(d.TEXTURE0);d.bindTexture(d.TEXTURE_2D,null)}d.uniform1i(d.getUniformLocation(e,"texture1"),0);if(b.yc&&b.yc.sc){d.activeTexture(d.TEXTURE1);d.bindTexture(d.TEXTURE_2D,b.yc.La)}else{d.activeTexture(d.TEXTURE1);d.bindTexture(d.TEXTURE_2D,
null)}d.uniform1i(d.getUniformLocation(e,"texture2"),1)}}}}
function Id(a,b,c){if(b!=null)if(a.P!=null){if(b.ab==null)Jd(a,b);else if(b.ik){if(!(b.k.length==0||b.T.length==0))if(b.ab.Up<b.k.length||b.ab.Uk<b.T.length){b.ab=null;Jd(a,b)}else if(b.ab!=null){for(var d=a.P,e=b.k.length,f=b.ab.Dp,g=b.ab.er,h=0;h<e;++h){var j=b.k[h];f[h*3+0]=j.f.c;f[h*3+1]=j.f.b;f[h*3+2]=j.f.d;g[h*4+0]=n.Dc(j.na)/255;g[h*4+1]=n.Bc(j.na)/255;g[h*4+2]=n.Ac(j.na)/255;g[h*4+3]=n.xd(j.na)/255}d.bindBuffer(d.ARRAY_BUFFER,b.ab.Wk);d.bufferSubData(d.ARRAY_BUFFER,0,f);d.bindBuffer(d.ARRAY_BUFFER,
b.ab.Om);d.bufferSubData(d.ARRAY_BUFFER,0,g);if(b.ab.Uk<b.T.length){e=b.T.length;f=new WebGLUnsignedShortArray(e);for(g=0;g<e;g+=3){f[g+0]=b.T[g+0];f[g+1]=b.T[g+2];f[g+2]=b.T[g+1]}b.ab.Tk=d.createBuffer();d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,b.ab.Tk);d.bufferData(d.ELEMENT_ARRAY_BUFFER,f,d.STATIC_DRAW);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,null)}b.ab.Uk=b.T.length;b.ab.Up=b.k.length}}else b.hk&&Kd(a,b);b.hk=false;b.ik=false;b=b.ab;c=c;d=a.P;e=b.rn&&b.Nm;d.enableVertexAttribArray(0);d.enableVertexAttribArray(1);
d.enableVertexAttribArray(2);d.enableVertexAttribArray(3);d.enableVertexAttribArray(4);d.bindBuffer(d.ARRAY_BUFFER,b.Wk);d.vertexAttribPointer(0,3,d.FLOAT,false,0,0);d.bindBuffer(d.ARRAY_BUFFER,b.Sp);d.vertexAttribPointer(1,2,d.FLOAT,false,0,0);d.bindBuffer(d.ARRAY_BUFFER,b.Tp);d.vertexAttribPointer(2,2,d.FLOAT,false,0,0);d.bindBuffer(d.ARRAY_BUFFER,b.xp);d.vertexAttribPointer(3,3,d.FLOAT,false,0,0);d.bindBuffer(d.ARRAY_BUFFER,b.Om);d.vertexAttribPointer(4,4,d.FLOAT,false,0,0);if(e){d.enableVertexAttribArray(5);
d.enableVertexAttribArray(6);d.bindBuffer(d.ARRAY_BUFFER,b.rn);d.vertexAttribPointer(5,3,d.FLOAT,false,0,0);d.bindBuffer(d.ARRAY_BUFFER,b.Nm);d.vertexAttribPointer(6,3,d.FLOAT,false,0,0)}d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,b.Tk);g=new I(false);a.oa.ia(g);g=K(g,a.Ab);g=K(g,a.ja);f=a.ub;f.rp!=null&&d.uniformMatrix4fv(f.rp,false,Ld(a,g));if(f.mp!=null){g=new I(true);a.oa.ia(g);g=K(g,a.Ab);g=K(g,a.ja);ob(g);g=pb(g);d.uniformMatrix4fv(f.mp,false,Ld(a,g))}if(f.kp!=null){g=new I(true);g=K(g,a.Ab);g=K(g,
a.ja);d.uniformMatrix4fv(f.kp,false,Ld(a,g))}f.lp!=null&&d.uniformMatrix4fv(f.lp,false,Ld(a,pb(a.ja)));f.jp!=null&&Md(a,f,e,e);f.gp!=null&&a.P.uniform4f(f.gp,a.ac.wc,a.ac.qc,a.ac.lc,1);f.hp!=null&&a.P.uniform1f(f.hp,a.Ih);a.bd&&Nd(a,f);if(f.ip!=null){g=q()*a.Ni/500%1E3;a.P.uniform1f(f.ip,g);a.P.uniform1f(f.Ar,a.Oi)}if(c==null)c=b.Uk;d.drawElements(d.TRIANGLES,c,d.UNSIGNED_SHORT,0);if(e){d.disableVertexAttribArray(5);d.disableVertexAttribArray(6)}}}
function Kd(a,b){if(b.ab!=null){a=a.P;for(var c=b.k.length,d=b.ab.Dp,e=0;e<c;++e){var f=b.k[e];d[e*3+0]=f.f.c;d[e*3+1]=f.f.b;d[e*3+2]=f.f.d}a.bindBuffer(a.ARRAY_BUFFER,b.ab.Wk);a.bufferSubData(a.ARRAY_BUFFER,0,d)}}
function Jd(a,b){if(b.ab==null){a=a.P;var c={},d=b.k.length,e=new WebGLFloatArray(d*3),f=new WebGLFloatArray(d*3),g=new WebGLFloatArray(d*2),h=new WebGLFloatArray(d*2),j=new WebGLFloatArray(d*4),m=null,o=null;if(b.de)m=new WebGLFloatArray(d*3);if(b.Gd)o=new WebGLFloatArray(d*3);for(var p=0;p<d;++p){var i=b.k[p];e[p*3+0]=i.f.c;e[p*3+1]=i.f.b;e[p*3+2]=i.f.d;f[p*3+0]=i.j.c;f[p*3+1]=i.j.b;f[p*3+2]=i.j.d;g[p*2+0]=i.ta.c;g[p*2+1]=i.ta.b;h[p*2+0]=i.ud.c;h[p*2+1]=i.ud.b;j[p*4+0]=n.Dc(i.na)/255;j[p*4+1]=n.Bc(i.na)/
255;j[p*4+2]=n.Ac(i.na)/255;j[p*4+3]=n.xd(i.na)/255}if(m&&o)for(p=0;p<d;++p){i=b.de[p];m[p*3+0]=i.c;m[p*3+1]=i.b;m[p*3+2]=i.d;i=b.Gd[p];o[p*3+0]=i.c;o[p*3+1]=i.b;o[p*3+2]=i.d}p=b.T.length;i=new WebGLUnsignedShortArray(p);for(var v=0;v<p;v+=3){i[v+0]=b.T[v+0];i[v+1]=b.T[v+2];i[v+2]=b.T[v+1]}c.Wk=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c.Wk);a.bufferData(a.ARRAY_BUFFER,e,a.DYNAMIC_DRAW);c.Dp=e;c.Sp=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c.Sp);a.bufferData(a.ARRAY_BUFFER,g,a.STATIC_DRAW);
c.Tp=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c.Tp);a.bufferData(a.ARRAY_BUFFER,h,a.STATIC_DRAW);c.xp=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c.xp);a.bufferData(a.ARRAY_BUFFER,f,a.STATIC_DRAW);if(m&&o){c.rn=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c.rn);a.bufferData(a.ARRAY_BUFFER,m,a.STATIC_DRAW);c.Nm=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c.Nm);a.bufferData(a.ARRAY_BUFFER,o,a.STATIC_DRAW)}a.bindBuffer(a.ARRAY_BUFFER,null);c.Om=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c.Om);
a.bufferData(a.ARRAY_BUFFER,j,a.STATIC_DRAW);c.er=j;a.bindBuffer(a.ARRAY_BUFFER,null);c.Tk=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,c.Tk);a.bufferData(a.ELEMENT_ARRAY_BUFFER,i,a.STATIC_DRAW);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);c.P=a;c.Uk=p;c.Up=d;b.ab=c;b.hk=false;b.ik=false}}
function Nd(a,b){var c=a.P;if(a.Pg&&b.sp){var d=new I(true);d=K(d,a.Pg);d=K(d,a.ja);c.uniformMatrix4fv(b.sp,false,Ld(a,d))}if(a.ui&&b.tp){d=new I(true);d=K(d,a.ui);d=K(d,a.ja);c.uniformMatrix4fv(b.tp,false,Ld(a,d))}b.op&&c.uniform1f(b.op,a.si);b.pp&&c.uniform1f(b.pp,a.ti);b.np&&c.uniform1f(b.np,a.wk);b.qp&&c.uniform1f(b.qp,a.vi);if(a.vm){c.activeTexture(c.TEXTURE2);c.bindTexture(c.TEXTURE_2D,a.vm.La)}else{c.activeTexture(c.TEXTURE2);c.bindTexture(c.TEXTURE_2D,null)}c.uniform1i(c.getUniformLocation(b,
"shadowmap"),2);if(n.Fk){if(a.wm){c.activeTexture(c.TEXTURE3);c.bindTexture(c.TEXTURE_2D,a.wm.La)}else{c.activeTexture(c.TEXTURE3);c.bindTexture(c.TEXTURE_2D,null)}c.uniform1i(c.getUniformLocation(b,"shadowmap2"),3)}}
function Md(a,b,c,d){var e=new ArrayBuffer(16*Float32Array.BYTES_PER_ELEMENT),f=new WebGLFloatArray(e);e=new ArrayBuffer(20*Float32Array.BYTES_PER_ELEMENT);var g=new WebGLFloatArray(e);e=new I(true);if(!c&&(a.rf!=null&&a.rf.length>0||a.Gj!=null))nb(a.ja,e);for(c=0;c<4;++c){var h=c*4;if(a.rf!=null&&c<a.rf.length){var j=a.rf[c],m=kb(e,j.fi);f[h]=m.c;f[h+1]=m.b;f[h+2]=m.d;m=1;m=d?1/(j.Ka*j.Ka):j.vh;f[h+3]=m;g[h]=j.na.wc;g[h+1]=j.na.qc;g[h+2]=j.na.lc}else{f[h]=1;f[h+1]=0;f[h+2]=0;f[h+3]=1;g[h]=0;g[h+
1]=0;g[h+2]=0}g[h+3]=1}g[16]=a.Xb.wc;g[17]=a.Xb.qc;g[18]=a.Xb.lc;g[19]=1;a.P.uniform4fv(b.jp,f);a.P.uniform4fv(b.zr,g);if(b.ep!=null){d=a.Gj;f=null;f=d&&d.Na?d.Na.e():new s(1,0,0);A(f,-1);eb(e,f);f.normalize();a.P.uniform3f(b.ep,f.c,f.b,f.d,1);d?a.P.uniform4f(b.fp,d.na.wc,d.na.qc,d.na.lc,1):a.P.uniform4f(b.fp,0,0,0,1)}}
function Od(a,b,c,d,e,f,g){if(!(d<=0||e<=0||a.width==0||a.height==0)){var h=true;if(g==null||g==false)h=false;g=a.P;g.enableVertexAttribArray(0);g.disableVertexAttribArray(1);g.disableVertexAttribArray(2);g.disableVertexAttribArray(3);g.disableVertexAttribArray(4);c=a.height-c;var j=2/a.width,m=2/a.height;b=b*j-1;c=c*m-1;d*=j;e*=m;j=new WebGLFloatArray(12);j[0]=b;j[1]=c;j[2]=0;j[3]=b+d;j[4]=c;j[5]=0;j[6]=b+d;j[7]=c-e;j[8]=0;j[9]=b;j[10]=c-e;j[11]=0;b=new WebGLUnsignedShortArray(6);b[0]=0;b[1]=2;b[2]=
1;b[3]=0;b[4]=3;b[5]=2;c=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,c);g.bufferData(g.ARRAY_BUFFER,j,g.STATIC_DRAW);g.vertexAttribPointer(0,3,g.FLOAT,false,0,0);d=g.createBuffer();g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,d);g.bufferData(g.ELEMENT_ARRAY_BUFFER,b,g.STATIC_DRAW);a.ub=a.Yn;g.useProgram(a.ub);g.uniform4f(g.getUniformLocation(a.ub,"vColor"),n.Dc(f)/255,n.Bc(f)/255,n.Ac(f)/255,h?n.xd(f)/255:1);g.depthMask(false);g.disable(g.DEPTH_TEST);if(h){g.enable(g.BLEND);g.blendFunc(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA)}else g.disable(g.BLEND);
g.drawElements(g.TRIANGLES,6,g.UNSIGNED_SHORT,0);g.deleteBuffer(c);g.deleteBuffer(d)}}
function Pd(a,b,c,d,e,f,g,h,j,m,o){if(!(f==null||f.sc==false||d<=0||e<=0||a.width==0||a.height==0)){if(j==null)j=1;if(m==null)m=1;var p=true;if(g==null||g==false)p=false;g=a.P;g.enableVertexAttribArray(0);g.enableVertexAttribArray(1);g.disableVertexAttribArray(2);g.disableVertexAttribArray(3);g.disableVertexAttribArray(4);c=a.height-c;var i=2/a.width,v=2/a.height;b=b*i-1;c=c*v-1;d*=i;e*=v;i=new WebGLFloatArray(12);i[0]=b;i[1]=c;i[2]=0;i[3]=b+d;i[4]=c;i[5]=0;i[6]=b+d;i[7]=c-e;i[8]=0;i[9]=b;i[10]=c-
e;i[11]=0;b=new WebGLFloatArray(8);b[0]=0;b[1]=0;b[2]=j;b[3]=0;b[4]=j;b[5]=m;b[6]=0;b[7]=m;j=new WebGLUnsignedShortArray(6);j[0]=0;j[1]=2;j[2]=1;j[3]=0;j[4]=3;j[5]=2;m=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,m);g.bufferData(g.ARRAY_BUFFER,i,g.STATIC_DRAW);g.vertexAttribPointer(0,3,g.FLOAT,false,0,0);c=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,c);g.bufferData(g.ARRAY_BUFFER,b,g.STATIC_DRAW);g.vertexAttribPointer(1,2,g.FLOAT,false,0,0);b=g.createBuffer();g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,
b);g.bufferData(g.ELEMENT_ARRAY_BUFFER,j,g.STATIC_DRAW);a.ub=h==null?a.Zn:h;g.useProgram(a.ub);g.depthMask(false);g.disable(g.DEPTH_TEST);if(p){g.enable(g.BLEND);g.blendFunc(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA)}else g.disable(g.BLEND);g.activeTexture(g.TEXTURE0);g.bindTexture(g.TEXTURE_2D,f.La);if(o){g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST)}else{g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR);g.texParameteri(g.TEXTURE_2D,
g.TEXTURE_MIN_FILTER,g.LINEAR)}g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE);g.activeTexture(g.TEXTURE1);g.bindTexture(g.TEXTURE_2D,null);g.drawElements(g.TRIANGLES,6,g.UNSIGNED_SHORT,0);g.deleteBuffer(c);g.deleteBuffer(m);g.deleteBuffer(b);g.activeTexture(g.TEXTURE0);g.bindTexture(g.TEXTURE_2D,f.La);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR_MIPMAP_NEAREST)}}
function Qd(a,b,c,d,e,f,g){if(!(f==null||f.sc==false||d<=0||e<=0||a.width==0||a.height==0)){var h=a.P;a.ub=a.hm;h.useProgram(a.ub);h.uniform4f(h.getUniformLocation(a.ub,"vColor"),n.Dc(g)/255,n.Bc(g)/255,n.Ac(g)/255,n.xd(g)/255);Pd(a,b,c,d,e,f,true,a.hm,f.uf/f.Id,f.tf/f.Hd,true)}}function Rd(a){var b=a.P;b.clearDepth(a.nf?0:1);b.depthMask(true);b.clear(b.DEPTH_BUFFER_BIT)}function Sd(a){a.rf=[];a.Gj=null}function Td(a,b){a.rf.push(b)}function Ud(a,b){a.Gj=b}
function Vd(a){if(!(a.canvas==null||a.P==null))if(!(a.width==a.canvas.width&&a.height==a.canvas.height)){a.width=a.canvas.width;a.height=a.canvas.height;var b=a.P;b.viewport&&b.viewport(0,0,a.width,a.height)}}
Fd.prototype.ib=function(a){this.canvas=a;this.P=null;try{a=[];a.push("webgl2");a.push("webgl");a.push("experimental-webgl");a.push("moz-webgl");a.push("webkit-3d");a.push("3d");for(var b=0;b<a.length;b++)try{this.P=this.canvas.getContext(a[b],{alpha:false});if(this.P!=null){if(a[b]=="webgl2")this.Ji=true;break}}catch(c){}}catch(d){}if(this.P==null)return false;else{if(typeof WebGLFloatArray=="undefined"&&typeof Float32Array!="undefined")try{WebGLFloatArray=Float32Array;WebGLUnsignedShortArray=Uint16Array}catch(e){ja(n.va,
"Error: Float32 array types for webgl not found.")}if(typeof WebGLFloatArray=="undefined"&&typeof CanvasFloatArray!="undefined")try{WebGLFloatArray=CanvasFloatArray;WebGLUnsignedShortArray=CanvasUnsignedShortArray}catch(f){ja(n.va,"Error: canvas array types for webgl not found.")}a=this.P;a.getProgramParameter||(a.getProgramParameter=a.getProgrami);a.getShaderParameter||(a.getShaderParameter=a.getShaderi);a=this.P;this.Zi=true;var g=b=X(this,this.Wb,this.Yf),h=X(this,this.Wb,this.Qm),j=X(this,this.Wb,
this.mr),m=X(this,this.Wb,this.Yf,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),o=X(this,this.Wb,this.Mk,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),p=X(this,this.Yp,this.Mk,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),i=X(this,this.Wb,this.Yf,true,a.ONE,a.ONE_MINUS_SRC_COLOR),v=X(this,this.bl,this.Qm),r=X(this,this.bl,this.Qm,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),E=X(this,this.Xp,this.Yf),z=X(this,this.Wp,this.Zo),u=X(this,this.Wb,this.ap);this.Yn=X(this,this.bs,this.rr);this.Zn=X(this,this.Vp,this.or);this.hm=
X(this,this.Vp,this.jr);this.eb[0]=g;this.eb[1]=g;this.eb[2]=h;this.eb[3]=h;this.eb[4]=h;this.eb[5]=j;this.eb[fd]=i;this.eb[gd]=m;this.eb[hd]=o;this.eb[11]=v;this.eb[jd]=r;this.eb[17]=z;this.eb[25]=u;this.eb[id]=p;this.eb[23]=E;g=X(this,this.Bd,this.Yf);m=X(this,this.Bd,this.Yf,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);o=X(this,this.Bd,this.Mk,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);p=X(this,this.Zp,this.Mk,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);i=X(this,this.Bd,this.Yf,true,a.ONE,a.ONE_MINUS_SRC_COLOR);
v=X(this,this.ih,this.Yo);r=X(this,this.ih,this.Yo,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);u=X(this,this.Bd,this.ap);this.rb[0]=g;this.rb[1]=g;this.rb[2]=h;this.rb[3]=h;this.rb[4]=h;this.rb[5]=j;this.rb[fd]=i;this.rb[gd]=m;this.rb[hd]=o;this.rb[11]=v;this.rb[jd]=r;this.rb[17]=z;this.rb[25]=u;this.rb[id]=p;h=X(this,this.Wb,this.Zf);j=X(this,this.Wb,this.Rm);m=X(this,this.Wb,this.nr);o=X(this,this.Wb,this.Zf,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);p=X(this,this.Wb,this.Nk,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);
i=X(this,this.Yp,this.Nk,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);r=X(this,this.Wb,this.Zf,true,a.ONE,a.ONE_MINUS_SRC_COLOR);E=X(this,this.bl,this.Rm);z=X(this,this.bl,this.Rm,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);u=X(this,this.Xp,this.Zf);v=X(this,this.Wp,this.Zo);var y=X(this,this.Wb,this.bp);this.lb[0]=h;this.lb[1]=h;this.lb[2]=j;this.lb[3]=j;this.lb[4]=j;this.lb[5]=m;this.lb[fd]=r;this.lb[gd]=o;this.lb[hd]=p;this.lb[11]=E;this.lb[jd]=z;this.lb[17]=v;this.lb[25]=y;this.lb[id]=i;this.lb[23]=u;
h=X(this,this.Bd,this.Zf);o=X(this,this.Bd,this.Zf,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);p=X(this,this.Bd,this.Nk,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);i=X(this,this.Zp,this.Nk,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);r=X(this,this.Bd,this.Zf,true,a.ONE,a.ONE_MINUS_SRC_COLOR);E=X(this,this.ih,this.Lk);z=X(this,this.ih,this.Lk,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);y=X(this,this.Bd,this.bp);this.sb[0]=h;this.sb[1]=h;this.sb[2]=j;this.sb[3]=j;this.sb[4]=j;this.sb[5]=m;this.sb[fd]=r;this.sb[gd]=
o;this.sb[hd]=p;this.sb[11]=E;this.sb[jd]=z;this.sb[17]=v;this.sb[25]=y;this.sb[id]=i;r=this.po?this.qr:this.pr;h=X(this,this.kj,r);o=X(this,this.kj,r,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);p=X(this,this.kj,this.$o,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);i=X(this,this.fs,this.$o,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);r=X(this,this.kj,r,true,a.ONE,a.ONE_MINUS_SRC_COLOR);E=X(this,this.ih,this.Lk);z=X(this,this.ih,this.Lk,true,a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);y=X(this,this.kj,this.sr);this.tb[0]=
h;this.tb[1]=h;this.tb[2]=j;this.tb[3]=j;this.tb[4]=j;this.tb[5]=m;this.tb[fd]=r;this.tb[gd]=o;this.tb[hd]=p;this.tb[11]=E;this.tb[jd]=z;this.tb[17]=v;this.tb[25]=y;this.tb[id]=i;this.Zi=true;for(h=0;h<this.Be;++h){if(this.eb[h]==null)this.eb[h]=b;if(this.rb[h]==null)this.rb[h]=b;if(this.lb[h]==null)this.lb[h]=b;if(this.sb[h]==null)this.sb[h]=b;if(this.tb[h]==null)this.tb[h]=b}a.useProgram(g);this.ub=g;a.clearColor(0,0,1,1);a.clearDepth(1);a.depthMask(true);a.enable(a.DEPTH_TEST);a.disable(a.BLEND);
a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);a.enable(a.CULL_FACE);a.cullFace(a.BACK);Vd(this)}return true};function Wd(a,b,c){var d=a.P,e=d.createShader(b);if(e==null)return null;d.shaderSource(e,c);d.compileShader(e);if(!d.getShaderParameter(e,d.COMPILE_STATUS)){if(a.Zi){a="Error loading "+(b==d.VERTEX_SHADER?"vertex":"fragment")+" shader: "+d.getShaderInfoLog(e);n.va&&ja(n.va,a)}return null}return e}
function Xd(a,b,c,d,e,f,g){b=X(a,b,c,d,e,f);if(!b)return-1;b.nn=g;a.Be+=1;a.eb[a.Be]=b;a.rb[a.Be]=b;a.lb[a.Be]=b;a.sb[a.Be]=b;a.tb[a.Be]=b;return a.Be}function Yd(a,b){var c=null;try{c=a.eb[b]}catch(d){}return c}
function X(a,b,c,d,e,f,g){if(g==null)g=false;g=g;var h=a.P,j=b,m=c;if(j.indexOf("precision ")==-1)j="#ifdef GL_ES\t\t\t\t\t\t\t\t\t\t\t\t\n\tprecision mediump float;\t\t\t\t\t\t\t\t\t\n\t#endif\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n"+b;if(m.indexOf("precision ")==-1)m="#ifdef GL_ES\t\t\t\t\t\t\t\t\t\t\t\t\n\tprecision mediump float;\t\t\t\t\t\t\t\t\t\n\t#endif\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n"+c;b=Wd(a,h.VERTEX_SHADER,j);c=Wd(a,h.FRAGMENT_SHADER,m);if(!b||!c){a.Zi&&n.va.print("Could not create shader program");
g=null}else{m=h.createProgram();h.attachShader(m,b);h.attachShader(m,c);h.bindAttribLocation(m,0,"vPosition");h.bindAttribLocation(m,1,"vTexCoord1");h.bindAttribLocation(m,2,"vTexCoord2");h.bindAttribLocation(m,3,"vNormal");h.bindAttribLocation(m,4,"vColor");if(g){h.bindAttribLocation(m,5,"vBinormal");h.bindAttribLocation(m,6,"vTangent")}h.linkProgram(m);if(h.getProgramParameter(m,h.LINK_STATUS)){h.useProgram(m);h.uniform1i(h.getUniformLocation(m,"texture1"),0);h.uniform1i(h.getUniformLocation(m,
"texture2"),1)}else a.Zi&&n.va.print("Could not link program:"+h.getProgramInfoLog(m));g=m}if(g){g.Qo=d?d:false;g.Ro=e;g.Po=f;a=a.P;g.rp=a.getUniformLocation(g,"worldviewproj");g.mp=a.getUniformLocation(g,"normaltransform");g.kp=a.getUniformLocation(g,"modelviewtransform");g.lp=a.getUniformLocation(g,"worldtransform");g.jp=a.getUniformLocation(g,"arrLightPositions");g.zr=a.getUniformLocation(g,"arrLightColors");g.ep=a.getUniformLocation(g,"vecDirLight");g.fp=a.getUniformLocation(g,"colorDirLight");
g.gp=a.getUniformLocation(g,"fogColor");g.hp=a.getUniformLocation(g,"fogDensity");g.ip=a.getUniformLocation(g,"grassMovement");g.Ar=a.getUniformLocation(g,"windStrength");g.sp=a.getUniformLocation(g,"worldviewprojLight");g.tp=a.getUniformLocation(g,"worldviewprojLight2");g.op=a.getUniformLocation(g,"shadowMapBias1");g.pp=a.getUniformLocation(g,"shadowMapBias2");g.np=a.getUniformLocation(g,"shadowMapBackFaceBias");g.qp=a.getUniformLocation(g,"shadowOpacity");g.nn=null}return g}
Fd.prototype.Ob=function(a){a&&a.ia(this.ja)};function Ld(a,b){return new WebGLFloatArray([b.q,b.v,b.t,b.G,b.w,b.r,b.u,b.H,b.A,b.B,b.p,b.I,b.J,b.K,b.C,b.L])}Fd.prototype.deleteTexture=function(a){if(a!=null){var b=this.P;b.deleteTexture(a.La);a.La=null;a.sc=false;a.Dg&&b.deleteFramebuffer(a.Dg);a:{b=this.Ia;for(var c=0;c<b.Ma.length;++c)if(b.Ma[c]==a){b.Ma.splice(c,1);break a}}a.Dg=null}};
function $d(a,b,c,d,e,f){var g=a.P;if(d)if(a.Ji){h=g.getExtension("EXT_color_buffer_float");if(!h)return null;a.ns=h;h=g.getExtension("OES_texture_float_linear");if(!h)return null;a.jq=h}else{var h=g.getExtension("OES_texture_float");if(!h)return null;a.ms=h;h=g.getExtension("OES_texture_float_linear");if(!h)return null;a.jq=h}if(e&&!a.Ji){h=g.getExtension("WEBGL_depth_texture");if(!h)return null;a.ls=h}h=g.createTexture();g.bindTexture(g.TEXTURE_2D,h);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,
g.LINEAR);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR);if(e)g.texImage2D(g.TEXTURE_2D,0,g.DEPTH_COMPONENT,b,c,0,g.DEPTH_COMPONENT,g.UNSIGNED_SHORT,null);else if(d)a.Ji?g.texStorage2D(g.TEXTURE_2D,1,g.RGBA32F,b,c):g.texImage2D(g.TEXTURE_2D,0,g.RGBA,b,c,0,g.RGBA,g.FLOAT,null);else g.texImage2D(g.TEXTURE_2D,0,g.RGBA,b,c,0,g.RGBA,g.UNSIGNED_BYTE,null);var j=g.createFramebuffer();g.bindFramebuffer(g.FRAMEBUFFER,j);j.width=b;j.height=c;if(e)g.framebufferTexture2D(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,
g.TEXTURE_2D,h,0);else{e=g.createRenderbuffer();g.bindRenderbuffer(g.RENDERBUFFER,e);g.renderbufferStorage(g.RENDERBUFFER,g.DEPTH_COMPONENT16,b,c);g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,h,0);g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,e)}if(d)if(g.checkFramebufferStatus(g.FRAMEBUFFER)!=g.FRAMEBUFFER_COMPLETE){g.bindTexture(g.TEXTURE_2D,null);g.bindRenderbuffer(g.RENDERBUFFER,null);g.bindFramebuffer(g.FRAMEBUFFER,null);return null}g.bindTexture(g.TEXTURE_2D,
null);g.bindRenderbuffer(g.RENDERBUFFER,null);g.bindFramebuffer(g.FRAMEBUFFER,null);g=new Ob;g.n="";g.La=h;g.rd=null;g.sc=true;g.Id=b;g.Hd=c;g.uf=b;g.tf=c;g.Dg=j;g.qs=d;if(f!=null){g.n=f;xd(a.Ia,g)}return g}
function ae(a,b,c,d,e){var f=a.P;if(b!=null){f.bindFramebuffer(f.FRAMEBUFFER,b.Dg);f.viewport(0,0,b.Id,b.Hd)}else{f.bindFramebuffer(f.FRAMEBUFFER,null);f.viewport(0,0,a.width,a.height)}if(a.Md!=null){f.bindTexture(f.TEXTURE_2D,a.Md.La);f.generateMipmap(f.TEXTURE_2D)}a.Md=b;if(c||d){b=0;if(c){b|=f.COLOR_BUFFER_BIT;f.clearColor(n.Dc(e)/255,n.Bc(e)/255,n.Ac(e)/255,1)}if(d){f.clearDepth(a.nf?0:1);b|=f.DEPTH_BUFFER_BIT}f.clear(b)}return true}
function be(a){if(a.Md)return new Na(a.Md.Id,a.Md.Hd);return new Na(a.width,a.height)}
function cd(a,b,c,d){var e=a.P;b=b.La;e.bindTexture(e.TEXTURE_2D,b);var f=c.width,g=c.height;if(c.videoWidth)f=c.videoWidth;if(c.videoHeight)g=c.videoHeight;if((f&f-1)!=0||(g&g-1)!=0){var h=document.createElement("canvas");h.width=yd(a,f);h.height=yd(a,g);var j=h.getContext("2d");j.fillStyle="rgba(0, 255, 255, 1)";j.fillRect(0,0,h.width,h.height);d?j.drawImage(c,0,0,f,g,0,0,f,g):j.drawImage(c,0,0,f,g,0,0,h.width,h.height);c=h}zd(a,b,c);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);
e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);e.generateMipmap(e.TEXTURE_2D);e.bindTexture(e.TEXTURE_2D,null)}
function bd(a,b,c){var d=a.P,e=d.createTexture();d.bindTexture(d.TEXTURE_2D,e);var f=b.width,g=b.height;if(b.videoWidth)f=b.videoWidth;if(b.videoHeight)g=b.videoHeight;var h=f,j=g;if((f&f-1)!=0||(g&g-1)!=0){j=document.createElement("canvas");j.width=yd(a,f);j.height=yd(a,g);h=j.getContext("2d");c?h.drawImage(b,0,0,f,g,0,0,f,g):h.drawImage(b,0,0,f,g,0,0,j.width,j.height);b=j;h=j.width;j=j.height}zd(a,e,b);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,
d.NEAREST);d.generateMipmap(d.TEXTURE_2D);d.bindTexture(d.TEXTURE_2D,null);a=new Ob;a.n="";a.La=e;a.rd=null;a.sc=true;a.Id=h;a.Hd=j;a.uf=f;a.tf=g;return a}function yd(a,b){--b;for(a=1;a<32;a<<=1)b|=b>>a;return b+1}
function zd(a,b,c){b=a.P;try{b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,c)}catch(d){if(d.code!=null&&DOMException!=null&&DOMException.SECURITY_ERR!=null&&d.code==DOMException.SECURITY_ERR){a.Wo==false&&ja(n.va,"<i>A security setting in the browser prevented loading a texture.<br/>Workaround: run this from a webserver, change security settings, or allow the specific domain.</i>",true);a.Wo=true}else try{b.texImage2D(b.TEXTURE_2D,0,c)}catch(e){}}}
function ce(a){if(a.zk==null){var b=null;b=new kd;var c=new Nb(true),d=new Nb(true),e=new Nb(true),f=new Nb(true),g=b.T;g.push(0);g.push(2);g.push(1);g.push(0);g.push(3);g.push(2);g=b.k;g.push(c);g.push(d);g.push(e);g.push(f);c.ta.c=1;c.ta.b=1;c.f.set(1,-1,0);d.ta.c=1;d.ta.b=0;d.f.set(1,1,0);e.ta.c=0;e.ta.b=0;e.f.set(-1,1,0);f.ta.c=0;f.ta.b=1;f.f.set(-1,-1,0);a.zk=b}}function de(a,b){a.bd=b}function ee(a,b,c,d,e,f){a.bd=b;a.vm=c;a.wm=e;a.Pg=d!=null?d.e():null;a.ui=f!=null?f.e():null}l=Fd.prototype;
l.bs="\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        gl_Position = vPosition;\t\t\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";l.Vp="\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t\tattribute vec4 vTexCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        gl_Position = vPosition;\t\t\t\t\t\t\t\t\t\tv_texCoord1 = vTexCoord1.st;\t\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.rr="\t\t\t\t\t\tuniform vec4 vColor;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t         gl_FragColor = vColor;\t\t\t\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";l.jr="\t\t\t\tuniform vec4 vColor;\t\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    vec2 texCoord = vec2(v_texCoord1.s, v_texCoord1.t);\t\t        float alpha = texture2D(texture1, texCoord).r;\t\t        gl_FragColor = vec4(vColor.rgb, alpha);\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.Wb="\t\t\t\t\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t    attribute vec4 vNormal;\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vColor;\t\t\t\t\t\t\t\t\t\t    attribute vec2 vTexCoord1;\t\t\t\t\t\t\t\t\t\tattribute vec2 vTexCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv_color = vColor;\t\t\t\t\t\t\t\t\t\t        gl_Position = worldviewproj * vPosition;\t\t\t\t        v_texCoord1 = vTexCoord1.st;\t\t\t\t\t\t\t\t\tv_texCoord2 = vTexCoord2.st;\t\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.Yp="\t\t\t\t\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\tuniform mat4 worldtransform;\t\t\t\t\t\t\t\t\n\tuniform float grassMovement;\t\t\t\t\t\t\t\t\n\tuniform float windStrength;\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t    attribute vec4 vNormal;\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vColor;\t\t\t\t\t\t\t\t\t\t    attribute vec2 vTexCoord1;\t\t\t\t\t\t\t\t\t\tattribute vec2 vTexCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv_color = vColor;\t\t\t\t\t\t\t\t\t\t\t\tvec4 grasspos = vPosition;\t\t\t\t\t\t\t\t\tgrasspos.x += sin(grassMovement + ((worldtransform[3].x + vPosition.x) / 10.0)) * (1.0 - vTexCoord1.y) * windStrength;\t        gl_Position = worldviewproj * grasspos;\t\t\t\t\t        v_texCoord1 = vTexCoord1.st;\t\t\t\t\t\t\t\t\tv_texCoord2 = vTexCoord2.st;\t\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.jj="\t\t\t\t\t\tvec3 n = normalize(vec3(vNormal.xyz));\t\t\t\t\t\t\tvec4 currentLight = vec4(0, 0, 0, 1.0);\t\t\t\t\t\t\tfor(int i=0; i<4; ++i)\t\t\t\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvec3 lPos = vec3(arrLightPositions[i].xyz);\t\t\t\t\t\tvec3 vertexToLight = lPos - vec3(vPosition.xyz);\t\t\t\tfloat distance = length( vertexToLight );\t\t\t\t\t\tfloat distanceFact = 1.0 / (arrLightPositions[i].w * distance); \t\t\tvertexToLight = normalize(vertexToLight); \t\t\t\t\t\tfloat angle = max(0.0, dot(n, vertexToLight));\t\t\t\t\tfloat intensity = angle * distanceFact * 0.25;\t\t\t\t\t\t\tcurrentLight = currentLight + vec4(arrLightColors[i].x*intensity, arrLightColors[i].y*intensity, arrLightColors[i].z*intensity, 1.0);\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// directional light\t\t\t\t\t\t\t\t\t\n\t\tfloat dirlight = max(0.0, dot(n, vecDirLight));\t\t\t\t\tcurrentLight = currentLight + vec4(colorDirLight.x*dirlight, colorDirLight.y*dirlight, colorDirLight.z*dirlight, 1.0) * vec4(0.25, 0.25, 0.25, 1.0);\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// ambient light\t\t\t\t\t\t\t\t\t\t\n\t\t//currentLight = max(currentLight,arrLightColors[4]);\t\t\n\t\t//currentLight = min(currentLight, vec4(1.0,1.0,1.0,1.0));\n\t\tcurrentLight = currentLight + arrLightColors[4];\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// backface value for shadow map back culling\t\t\t\n\t\tv_backfaceValue = dirlight;\t\t\t\t\t\t\t\n\t\t";
l.Bd="\t\t\t\t\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\n\tuniform vec4 arrLightPositions[4];\t\t\t\t\t\t\t\n\tuniform vec4 arrLightColors[5]; \t\t\t\t\t\t\t\n\tuniform vec3 vecDirLight; \t\t\t\t\t\t\t\t\t\n\tuniform vec4 colorDirLight; \t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t    attribute vec4 vNormal;\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vColor;\t\t\t\t\t\t\t\t\t\t    attribute vec2 vTexCoord1;\t\t\t\t\t\t\t\t\t\tattribute vec2 vTexCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\tvarying float v_backfaceValue;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        gl_Position = worldviewproj * vPosition;\t\t\t\t        v_texCoord1 = vTexCoord1.st;\t\t\t\t\t\t\t\t\tv_texCoord2 = vTexCoord2.st;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n"+
Fd.prototype.jj+"\tcurrentLight = currentLight * vec4(vColor.x, vColor.y, vColor.z, 1.0) * 4.0;\t\t\tv_color = min(currentLight, vec4(1.0,1.0,1.0,1.0));\t\t\t\tv_color.a = vColor.a;\t// preserve vertex alpha \n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";l.Xp="\t\t\t\t\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t    attribute vec2 vTexCoord1;\t\t\t\t\t\t\t\t\t\tattribute vec2 vTexCoord2;\t\t\t\t\t\t\t\t\t\tattribute vec4 vNormal;\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vColor;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        gl_Position = worldviewproj * vPosition;\t\t\t\t        v_texCoord1 = vTexCoord1.st;\t\t\t\t\t\t\t\t\tv_texCoord2 = vTexCoord2.st;\t\t\t\t\t\t\t\t\tv_color = vColor;\t\t\t\t\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.bl="\t\t\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\n\tuniform mat4 normaltransform;\t\t\t\t\t\t\t\t\n\tuniform mat4 modelviewtransform;\t\t\t\t\t\t\t\n\tuniform mat4 worldtransform;\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t    attribute vec3 vNormal;\t\t\t\t\t\t\t\t\t\t    attribute vec2 vTexCoord1;\t\t\t\t\t\t\t\t\t\tattribute vec2 vTexCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\tgl_Position = worldviewproj * vPosition;\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t//\tuse reflection\t\t\t\t\t\t\t\t\t\t\t\n\t\tvec3 pos = normalize((modelviewtransform * vPosition).xyz);\t\t\t\t\t\n\t\tvec3 n = normalize((normaltransform * vec4(vNormal, 1)).xyz);\t\t\n\t\tvec3 r = reflect( pos.xyz, n.xyz );\t\t\t\t\t\t\t\n\t\tfloat m = sqrt( r.x*r.x + r.y*r.y + (r.z+1.0)*(r.z+1.0) ); \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t//\ttexture coordinates\t\t\t\t\t\t\t\t\n\t\tv_texCoord1 = vTexCoord1.st;\t\t\t\t\t\t\n\t\tv_texCoord2.x = (r.x / (2.0 * m)  + 0.5);\t\t\t\t\t\t\n\t\tv_texCoord2.y = (r.y / (2.0 * m)  + 0.5);\t\t\t\t\t\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t";
l.ih="\t\t\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\n\tuniform mat4 normaltransform;\t\t\t\t\t\t\t\t\n\tuniform mat4 modelviewtransform;\t\t\t\t\t\t\t\n\tuniform vec4 arrLightPositions[4];\t\t\t\t\t\t\t\n\tuniform vec4 arrLightColors[5]; \t\t\t\t\t\t\t\n\tuniform vec3 vecDirLight; \t\t\t\t\t\t\t\t\t\n\tuniform vec4 colorDirLight; \t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t    attribute vec3 vNormal;\t\t\t\t\t\t\t\t\t\t    attribute vec2 vTexCoord1;\t\t\t\t\t\t\t\t\t\tattribute vec2 vTexCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\tvarying float v_backfaceValue;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        gl_Position = worldviewproj * vPosition;\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t//\tuse reflection\t\t\t\t\t\t\t\t\t\t\t\n\t\tvec3 pos = normalize((modelviewtransform * vPosition).xyz);\t\t\t\t\t\n\t\tvec3 nt = normalize((normaltransform * vec4(vNormal, 1)).xyz);\t\t\n\t\tvec3 r = reflect( pos.xyz, nt.xyz );\t\t\t\t\t\t\t\n\t\tfloat m = sqrt( r.x*r.x + r.y*r.y + (r.z+1.0)*(r.z+1.0) ); \n\t\t//\ttexture coordinates\t\t\t\t\t\t\t\t\n\t\tv_texCoord1 = vTexCoord1.st;\t\t\t\t\t\t\n\t\tv_texCoord2.x = r.x / (2.0 * m)  + 0.5;\t\t\t\t\t\t\n\t\tv_texCoord2.y = r.y / (2.0 * m)  + 0.5;\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\n"+
Fd.prototype.jj+"\t\tv_color = min(currentLight, vec4(1.0,1.0,1.0,1.0));\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t";
l.Zp="\t\t\t\t\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\n\tuniform mat4 worldtransform;\t\t\t\t\t\t\t\t\n\tuniform vec4 arrLightPositions[4];\t\t\t\t\t\t\t\n\tuniform vec4 arrLightColors[5]; \t\t\t\t\t\t\t\n\tuniform vec3 vecDirLight; \t\t\t\t\t\t\t\t\t\n\tuniform vec4 colorDirLight; \t\t\t\t\t\t\t\t\n\tuniform float grassMovement;\t\t\t\t\t\t\t\t\n\tuniform float windStrength;\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t    attribute vec4 vNormal;\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vColor;\t\t\t\t\t\t\t\t\t\t    attribute vec2 vTexCoord1;\t\t\t\t\t\t\t\t\t\tattribute vec2 vTexCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\tvarying float v_backfaceValue;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvec4 grasspos = vPosition;\t\t\t\t\t\t\t\t\tgrasspos.x += sin(grassMovement + ((worldtransform[3].x + vPosition.x) / 10.0)) * (1.0 - vTexCoord1.y) * windStrength;\t        gl_Position = worldviewproj * grasspos;\t\t\t\t\t        v_texCoord1 = vTexCoord1.st;\t\t\t\t\t\t\t\t\tv_texCoord2 = vTexCoord2.st;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n"+Fd.prototype.jj+
"\tcurrentLight = currentLight * vec4(vColor.x, vColor.y, vColor.z, 1.0);\t\t\tv_color = min(currentLight * 4.0, vec4(1.0,1.0,1.0,1.0));\t\t\t\tv_color.a = vColor.a;\t// preserve vertex alpha \n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";l.Wp="\t\t\t\t\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\n\tuniform mat4 normaltransform;\t\t\t\t\t\t\t\t\n\tuniform mat4 worldtransform;\t\t\t\t\t\t\t\t\n\tuniform vec4 arrLightPositions[4];\t\t\t\t\t\t\t\n\tuniform vec4 arrLightColors[5]; \t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t\n    attribute vec3 vNormal;\t\t\t\t\t\t\t\t\t\t\n\tattribute vec4 vColor;\t\t\t\t\t\t\t\t\t\t\n    attribute vec2 vTexCoord1;\t\t\t\t\t\t\t\t\t\n\tattribute vec2 vTexCoord2;\t\t\t\t\t\t\t\t\t\n\tattribute vec3 vBinormal;\t\t\t\t\t\t\t\t\t\n\tattribute vec3 vTangent;\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t// Output:\t\t\t\t\t\t\t\t\t\t\t\t\t\n    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\n\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\n\tvarying vec3 v_lightVector[4];\t\t\t\t\t\t\t\t\n\tvarying vec3 v_lightColor[4];\t\t\t\t\t\t\t\t\n\tvarying vec3 ambientLight;\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t\n    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n        gl_Position = worldviewproj * vPosition;\t\t\t\t\n        v_texCoord1 = vTexCoord1.st;\t\t\t\t\t\t\t\n\t\tv_texCoord2 = vTexCoord2.st;\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\tvec4 pos = vec4(dot(vPosition, worldtransform[0]), dot(vPosition, worldtransform[1]), dot(vPosition, worldtransform[2]), dot(vPosition, worldtransform[3]));\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t// transform normal, binormal and tangent\t\t\t\t\t\n\t\tvec3 normal = vec3(dot(vNormal.xyz, worldtransform[0].xyz), dot(vNormal.xyz, worldtransform[1].xyz), dot(vNormal.xyz, worldtransform[2].xyz));\t\t\n\t\tvec3 tangent = vec3(dot(vTangent.xyz, worldtransform[0].xyz), dot(vTangent.xyz, worldtransform[1].xyz), dot(vTangent.xyz, worldtransform[2].xyz));     \n\t\tvec3 binormal = vec3(dot(vBinormal.xyz, worldtransform[0].xyz), dot(vBinormal.xyz, worldtransform[1].xyz), dot(vBinormal.xyz, worldtransform[2].xyz));     \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\tvec3 temp = vec3(0.0, 0.0, 0.0);\t\t\t\t\t\t\n\t\tfor(int i=0; i<4; ++i) \t\t\t\t\t\t\t\t\t\n\t\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\tvec3 lightPos = vec3(arrLightPositions[i].xyz);\t\t\n\t\t\tvec3 vertexToLight = lightPos - vec3(pos.xyz); \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// transform the light vector 1 with U, V, W\t\t\n\t\t\ttemp.x = dot(tangent.xyz, vertexToLight);\t\t\t\t\n\t\t\ttemp.y = dot(binormal.xyz, vertexToLight);\t\t\t\t\n\t\t\ttemp.z = dot(normal.xyz, vertexToLight);\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t// normalize light vector\t\t\t\t\t\n\t\t\ttemp = normalize(temp); \t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t// move from -1..1 to 0..1 and put into output\t\t\n\t\t\ttemp = temp * 0.5;\t\t\t\t\t\t\t\n\t\t\ttemp = temp + vec3(0.5,0.5,0.5);\t\t\t\n\t\t\tv_lightVector[i] = temp;\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t// calculate attenuation\t\t\t\t\t\n\t\t\tfloat distanceFact = 1.0 / sqrt(dot(vertexToLight, vertexToLight) * arrLightPositions[i].w); \n\t\t\tv_lightColor[i] = min(vec3(arrLightColors[i].x*distanceFact, arrLightColors[i].y*distanceFact, arrLightColors[i].z*distanceFact), vec3(1,1,1));\t\t\n\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t// ambient light\n\t\tambientLight = arrLightColors[4].xyz;\t\t\t\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t";
l.or="\t\t\t\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord = vec2(v_texCoord1.s, v_texCoord1.t);\t\t        gl_FragColor = texture2D(texture1, texCoord);\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.Yf="\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord = vec2(v_texCoord1.s, v_texCoord1.t);\t\t        gl_FragColor = texture2D(texture1, texCoord) * v_color * 4.0;\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.Mk="\t\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\t\tvec4 clr = texture2D(texture1, texCoord) * v_color;\t\t\tif(clr.a < 0.5)\t\t\t\t\t\t\t\t\t\t\tdiscard;\t\t\t\t\t\t\t\t\t\t\t        gl_FragColor = clr * 4.0;\t\t\t\t\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.Qm="\t\t\t\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord1 = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\tvec2 texCoord2 = vec2(v_texCoord2.s, v_texCoord2.t);\t        vec4 col1 = texture2D(texture1, texCoord1);\t\t\t\t\t\tvec4 col2 = texture2D(texture2, texCoord2);\t\t\t\t\t\tgl_FragColor = col1 * col2 * 4.0;\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.mr="\t\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord1 = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\tvec2 texCoord2 = vec2(v_texCoord2.s, v_texCoord2.t);\t        vec4 col1 = texture2D(texture1, texCoord1);\t\t\t\t\t\tvec4 col2 = texture2D(texture2, texCoord2);\t\t\t\t\t\tgl_FragColor = col1 * col2 * 3.0;\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.Yo="\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord1 = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\tvec2 texCoord2 = vec2(v_texCoord2.s, v_texCoord2.t);\t        vec4 col1 = texture2D(texture1, texCoord1);\t\t\t\t\t\tvec4 col2 = texture2D(texture2, texCoord2);\t\t\t\t\t\tvec4 final = col1 * col2 * v_color * 4.0;\t\t\t\t\t\tgl_FragColor = vec4(final.x, final.y, final.z, col1.w);\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.Zo="\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\tvarying vec3 v_lightVector[4];\t\t\t\t\t\t\t\t\tvarying vec3 v_lightColor[4];\t\t\t\t\t\t\t\t\tvarying vec3 ambientLight;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvec4 colorMapSample = texture2D(texture1, v_texCoord1);\t\t\tvec3 normalMapVector = texture2D(texture2, v_texCoord1).xyz;\t\t//normalMapVector -= vec3(0.5, 0.5, 0.5);\t\t\t\t\t\n\t\t//normalMapVector = normalize(normalMapVector); \t\t\t\n\t\tnormalMapVector *= vec3(2.0, 2.0, 2.0);\t\t\t\t\t\n\t\tnormalMapVector -= vec3(1.0, 1.0, 1.0);\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\tvec3 totallight = vec3(0.0, 0.0, 0.0);\t\t\t\t\t\t\n\t\tfor(int i=0; i<4; ++i) \t\t\t\t\t\t\t\t\t\n\t\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t// process light\t\t\t\t\t\t\t\t\t\n\t\t\t//vec3 lightvect = v_lightVector[i] + vec3(-0.5, -0.5, -0.5); \n\t\t\tvec3 lightvect = (v_lightVector[i] * vec3(2.0, 2.0, 2.0)) - vec3(1.0, 1.0, 1.0); \n\t\t\tlightvect = normalize(lightvect);\t\t\t\t\t\n\t\t\tfloat luminance = dot(lightvect, normalMapVector); // normal DOT light\t\t\n\t\t\tluminance = clamp(luminance, 0.0, 1.0);\t// clamp result to positive numbers\t\t\n\t\t\tlightvect = luminance * v_lightColor[i];\t// luminance * light color \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t// add to previously calculated lights\t\t\t\t\n\t\t\ttotallight = totallight + lightvect;\t\t\t\t\n\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\ttotallight = totallight + ambientLight;\t\t\t\t\t\n\t\t// 0.25 because of new modulatex4 mode\t\t\t\t\t\n\t\tgl_FragColor = colorMapSample * 0.25 * vec4(totallight.x, totallight.y, totallight.z, 0.0) * 4.0;\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t";
l.ap="\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\t\tvec4 color1 = texture2D(texture1, texCoord);\t\t\t\t\tvec4 color2 = texture2D(texture2, texCoord);\t\t\t\t\tcolor1 = ((1.0 - v_color.w) * color1) + (v_color.w * color2);\t// interpolate texture colors based on vertex alpha\t \n\t\tgl_FragColor = color1 * v_color * 4.0;\t\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.Zf="\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\tuniform vec4 fogColor;\t\t\t\t\t\t\t\t\t\t\tuniform float fogDensity;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\t\tvec4 tmpFragColor = texture2D(texture1, texCoord) * v_color;\t\t\t\t\t\t\t\t\tfloat z = gl_FragCoord.z / gl_FragCoord.w; \t\t\t\t\t\t\t\t\t\t\t\t\n\t\tfloat fogFactor = clamp(exp2( -fogDensity * z * 1.442695), 0.0, 1.0); \t\n\t\tgl_FragColor = mix(fogColor, tmpFragColor * 4.0, fogFactor);\t\t\t\t\t\t\t\t\t\n\t\tgl_FragColor.a = tmpFragColor.a;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.Rm="\t\t\t\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\tuniform vec4 fogColor;\t\t\t\t\t\t\t\t\t\t\tuniform float fogDensity;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord1 = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\tvec2 texCoord2 = vec2(v_texCoord2.s, v_texCoord2.t);\t        vec4 col1 = texture2D(texture1, texCoord1);\t\t\t\t\t\tvec4 col2 = texture2D(texture2, texCoord2);\t\t\t\t\t\tvec4 tmpFragColor = col1 * col2;\t\t\t\t\t\t\tfloat z = gl_FragCoord.z / gl_FragCoord.w; \t\t\t\t\t\t\t\t\t\t\t\t\n\t\tfloat fogFactor = clamp(exp2( -fogDensity * z * 1.442695), 0.0, 1.0); \t\n\t\tgl_FragColor = mix(fogColor, tmpFragColor * 4.0, fogFactor);\t\t\t\t\t\t\t\t\t\n\t\tgl_FragColor.a = tmpFragColor.a;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.Nk="\t\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform vec4 fogColor;\t\t\t\t\t\t\t\t\t\t\tuniform float fogDensity;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\t\tvec4 tmpFragColor = texture2D(texture1, texCoord) * v_color;\t\t\t\t\t\t\t\t\tif(tmpFragColor.a < 0.5)\t\t\t\t\t\t\t\t\t\t\tdiscard;\t\t\t\t\t\t\t\t\t\t\t\t\tfloat z = gl_FragCoord.z / gl_FragCoord.w; \t\t\t\t\t\t\t\t\t\t\t\t\n\t\tfloat fogFactor = clamp(exp2( -fogDensity * z * 1.442695), 0.0, 1.0); \t\n\t\tgl_FragColor = mix(fogColor, tmpFragColor * 4.0, fogFactor);\t\t\t\t\t\t\t\t\t\n\t\tgl_FragColor.a = tmpFragColor.a;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.nr="\t\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\tuniform vec4 fogColor;\t\t\t\t\t\t\t\t\t\t\tuniform float fogDensity;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord1 = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\tvec2 texCoord2 = vec2(v_texCoord2.s, v_texCoord2.t);\t        vec4 col1 = texture2D(texture1, texCoord1);\t\t\t\t\t\tvec4 col2 = texture2D(texture2, texCoord2);\t\t\t\t\t\tvec4 tmpFragColor = col1 * col2 * 3.0;\t\t\t\t\t\t\t\t\tfloat z = gl_FragCoord.z / gl_FragCoord.w; \t\t\t\t\t\t\t\t\t\t\t\t\n\t\tfloat fogFactor = clamp(exp2( -fogDensity * z * 1.442695), 0.0, 1.0); \t\n\t\tgl_FragColor = mix(fogColor, tmpFragColor * 4.0, fogFactor);\t\t\t\t\t\t\t\t\t\n\t\tgl_FragColor.a = tmpFragColor.a;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.bp="\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\tuniform vec4 fogColor;\t\t\t\t\t\t\t\t\t\t\tuniform float fogDensity;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\t\tvec4 color1 = texture2D(texture1, texCoord);\t\t\t\t\tvec4 color2 = texture2D(texture2, texCoord);\t\t\t\t\tcolor1 = ((1.0 - v_color.w) * color1) + (v_color.w * color2);\t// interpolate texture colors based on vertex alpha\t \n\t\tvec4 tmpFragColor = color1 * v_color;\t\t\t\t\t\t\t\t\tfloat z = gl_FragCoord.z / gl_FragCoord.w; \t\t\t\t\t\t\t\t\t\t\t\t\n\t\tfloat fogFactor = clamp(exp2( -fogDensity * z * 1.442695), 0.0, 1.0); \t\n\t\tgl_FragColor = mix(fogColor, tmpFragColor * 4.0, fogFactor);\t\t\t\t\t\t\t\t\t\n\t\tgl_FragColor.a = tmpFragColor.a;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.Lk="\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\tuniform vec4 fogColor;\t\t\t\t\t\t\t\t\t\t\tuniform float fogDensity;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord1 = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\tvec2 texCoord2 = vec2(v_texCoord2.s, v_texCoord2.t);\t        vec4 col1 = texture2D(texture1, texCoord1);\t\t\t\t\t\tvec4 col2 = texture2D(texture2, texCoord2);\t\t\t\t\t\tvec4 final = col1 * col2 * v_color;\t\t\t\t\t\t\t\tvec4 tmpFragColor = vec4(final.x, final.y, final.z, col1.w);\t\t\t\t\t\t\t\t\tfloat z = gl_FragCoord.z / gl_FragCoord.w; \t\t\t\t\t\t\t\t\t\t\t\t\n\t\tfloat fogFactor = clamp(exp2( -fogDensity * z * 1.442695), 0.0, 1.0); \t\n\t\tgl_FragColor = mix(fogColor, tmpFragColor * 4.0, fogFactor);\t\t\t\t\t\t\t\t\t\n\t\tgl_FragColor.a = tmpFragColor.a;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.es="\t\t\tprecision highp float;\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        gl_Position = worldviewproj * vPosition;\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";l.kr="\t\t\tprecision highp float;\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgl_FragColor = vec4(gl_FragCoord.z);\t\t\t\t\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.cs="\t\t\tprecision highp float;\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t\tattribute vec2 vTexCoord1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv_texCoord1 = vTexCoord1.st;\t\t\t\t\t\t\t        gl_Position = worldviewproj * vPosition;\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.ds="\t\t\tprecision highp float;\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t\tattribute vec2 vTexCoord1;\t\t\t\t\t\t\t\t\t\tuniform float grassMovement;\t\t\t\t\t\t\t\t\n\tuniform float windStrength;\t\t\t\t\t\t\t\t\t\n\tuniform mat4 worldtransform;\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvec4 grasspos = vPosition;\t\t\t\t\t\t\t\t\tgrasspos.x += sin(grassMovement + ((worldtransform[3].x + vPosition.x) / 10.0)) * (1.0 - vTexCoord1.y) * windStrength;\t        gl_Position = worldviewproj * grasspos;\t\t\t\t\t\t\tv_texCoord1 = vTexCoord1.st;\t\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.Xo="\t\t\tprecision highp float;\t\t\t\t\t\t\t\t\t\t\n\tvarying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvec2 texCoord = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\t\tvec4 diffuseColor = texture2D(texture1, texCoord);\t\t\t\tif (diffuseColor.a < 0.5) discard;\t\t\t\t\t\t\t\tgl_FragColor = vec4(gl_FragCoord.z);\t\t\t\t\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.lr="\t\t\tprecision highp float;\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t const vec4 bitShift = vec4(1.0, 256.0, 256.0*256.0, 256.0*256.0*256.0); \n\t\t const vec4 bitMask = vec4(1.0/256.0, 1.0/256.0, 1.0/256.0, 0.0); \n\t\t vec4 rgbavalue = fract(gl_FragCoord.z * bitShift);\t\n\t\t rgbavalue -= rgbavalue.gbaa * bitMask;\t\t\t\t\n\t\t gl_FragColor = rgbavalue;\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.kj="\t\t\tprecision highp float;\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\n\tuniform mat4 worldviewprojLight; \t\t\t\t\t\t\t\n\tuniform mat4 worldviewprojLight2; \t\t\t\t\t\t\t\n\tuniform vec4 arrLightPositions[4];\t\t\t\t\t\t\t\n\tuniform vec4 arrLightColors[5]; \t\t\t\t\t\t\t\n\tuniform vec3 vecDirLight; \t\t\t\t\t\t\t\t\t\n\tuniform vec4 colorDirLight; \t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t    attribute vec4 vNormal;\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vColor;\t\t\t\t\t\t\t\t\t\t    attribute vec2 vTexCoord1;\t\t\t\t\t\t\t\t\t\tattribute vec2 vTexCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying float v_backfaceValue;\t\t\t\t\t\t\t\t\tvarying vec4 v_posFromLight;\t // position on shadow map\t\n\tvarying vec4 v_posFromLight2;\t // position on 2nd shadow map\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        gl_Position = worldviewproj * vPosition;\t\t\t\t        v_texCoord1 = vTexCoord1.st;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t// Calculate position on shadow map\t\t\t\t\t\t\n\t\tv_posFromLight = worldviewprojLight * vPosition;\t\t\t\tv_posFromLight2 = worldviewprojLight2 * vPosition;\t\t"+
Fd.prototype.jj+"\tcurrentLight = currentLight * vec4(vColor.x, vColor.y, vColor.z, 1.0);\t\t\tv_color = min(currentLight * 4.0, vec4(1.0,1.0,1.0,1.0));\t\t\t\tv_color.a = vColor.a;\t// preserve vertex alpha \t\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";l.qr="\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D shadowmap;\t\t\t\t\t\t\t\t\tuniform sampler2D shadowmap2;\t\t\t\t\t\t\t\t\tuniform vec4 fogColor;\t\t\t\t\t\t\t\t\t\t\tuniform float fogDensity;\t\t\t\t\t\t\t\t\t\tuniform float shadowMapBias1;\t \t\t\t\t\t\t\t\tuniform float shadowMapBias2;\t \t\t\t\t\t\t\t\tuniform float shadowMapBackFaceBias;\t\t\t\t\t\t\tuniform float shadowOpacity;\t \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying float v_backfaceValue;\t\t\t\t\t\t\t\t\tvarying vec4 v_posFromLight;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfloat unpackFromRGBA(const in vec4 valuein) {\t\t\t\t\t\tconst vec4 bitShift = vec4(1.0, 1.0/256.0, 1.0/(256.0*256.0), 1.0/(256.0*256.0*256.0)); \t\treturn dot(valuein, bitShift);\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// diffuse texture\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\tvec4 diffuseColor = texture2D(texture1, v_texCoord1) * v_color;\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t// shadow map lookup\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\tfloat perpDiv = v_posFromLight.w;\t\t\t\t\t\t\t\t\t\t\n\t\tvec3 shadowCoord = (v_posFromLight.xyz / perpDiv) * 0.5 + 0.5;\t\t\t\n\t\tshadowCoord = clamp(shadowCoord, vec3(0.0,0.0,0.0), vec3(1.0,1.0,1.0)); \n\t\tvec4 shadowMapColor = texture2D(shadowmap, shadowCoord.xy);\t\t\t\t\n\t\tfloat shadowDepth = unpackFromRGBA(shadowMapColor);\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\tfloat distanceFromLight = shadowCoord.z; \t\t\t\t\t \t\t\t\n\t\tfloat visibility = 1.0 - (shadowOpacity * step(shadowMapBias1, shadowCoord.z - shadowDepth));\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\tgl_FragColor = diffuseColor * visibility;\t\t\t\t\t\t\t\t\n\t\tgl_FragColor.a = diffuseColor.a;\t\t\t\t\t\t\t\t\t\t\n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.Tm="\t\t\t\t";
l.Um=n.Fk?"\t\t\t\t\t\t\t\t\t// shadow map 1 lookup\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\tvec3 shadowCoord = (v_posFromLight.xyz / v_posFromLight.w) * 0.5 + 0.5;\t\t\n\t\t\tfloat brightnessFactor = 1.0; // when we have shadows, everthing is a bit darker, so compensate for this\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\tfloat visibility = 0.0;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t// now decide which map to use\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\tif (v_backfaceValue < shadowMapBackFaceBias)\t\t\t\t\t\t\t\t\n\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t// backface, no shadow needed there\t\t\t\t\t\t\t\t\t\t\n\t\t\t\tvisibility = 1.0;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t// if (shadowCoord.x < 0.0 || shadowCoord.x > 1.0 || shadowCoord.y < 0.0 || shadowCoord.y > 1.0)\t\n\t\t\t// same as:\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\tif ( ((1.0 - step(1.0, shadowCoord.x)) * (step(0.0, shadowCoord.x)) *\t\t\n\t\t\t\t  (1.0 - step(1.0, shadowCoord.y)) * (step(0.0, shadowCoord.y))) < 0.5)\t\n\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t// use shadowmap 2\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\tvec3 shadowCoord2 = (v_posFromLight2.xyz / v_posFromLight2.w) * 0.5 + 0.5;\n\t\t\t\tvec4 shadowMapColor = texture2D(shadowmap2, shadowCoord2.xy);\t\t\t\t\n\t\t\t\tfloat shadowDepth = shadowMapColor.r;\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\tvisibility = 1.0 - (shadowOpacity * step(shadowMapBias2, shadowCoord2.z - shadowDepth));\t\n\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t// use shadowmap 1\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\tvec4 shadowMapColor = texture2D(shadowmap, shadowCoord.xy);\t\t\t\t\n\t\t\t\tfloat shadowDepth = shadowMapColor.r;\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\tvisibility = 1.0 - (shadowOpacity * step(shadowMapBias1, shadowCoord.z - shadowDepth));\t\n\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\tvec4 colorWithShadow = diffuseColor * visibility * brightnessFactor;\t\t\n\t\t\t":"\t\t\t\t\t\t\t\t\t// shadow map lookup\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\tvec3 shadowCoord = (v_posFromLight.xyz / v_posFromLight.w) * 0.5 + 0.5;\t\t\t\n\t\t\tvec4 shadowMapColor = texture2D(shadowmap, shadowCoord.xy);\t\t\t\t\n\t\t\tfloat shadowDepth = shadowMapColor.r;\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\tfloat distanceFromLight = shadowCoord.z; \t\t\t\t\t\t\t\t\n\t\t\tfloat visibility = 1.0 - (shadowOpacity * step(shadowMapBias1, shadowCoord.z - shadowDepth));\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t// no shadows outside of shadowmap\t\t\t\t\t\t\t\t\t\t\n\t\t\t// if (shadowCoord.x < 0.0 || shadowCoord.x > 1.0 || shadowCoord.y < 0.0 || shadowCoord.y > 1.0)\t\n\t\t\t// same as:\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\tif ( ((1.0 - step(1.0, shadowCoord.x)) * (step(0.0, shadowCoord.x)) *\t\n\t\t\t\t  (1.0 - step(1.0, shadowCoord.y)) * (step(0.0, shadowCoord.y))) < 0.5)\t\n\t\t\t\tvisibility = 1.0;\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\tvec4 colorWithShadow = diffuseColor * visibility * 4.0;\t\t\t\t\t\t\n\t\t\t";
l.Sm="\t\t\t\t\t\t// fog\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\tfloat z = gl_FragCoord.z / gl_FragCoord.w; \t\t\t\t\t\t\t\t\n\t\tfloat fogFactor = clamp(exp2( -fogDensity * z * 1.442695), 0.0, 1.0); \t\n\t\tcolorWithShadow = mix(fogColor, colorWithShadow, fogFactor);\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\tgl_FragColor = colorWithShadow * 4.0;\t\t\t\t\t\t\t\t\t\t\t\n\t\tgl_FragColor.a = diffuseColor.a;\t\t\t\t\t\t\t\t\t\t\n\t\t";
l.pr="\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D shadowmap;\t\t\t\t\t\t\t\t\tuniform sampler2D shadowmap2;\t\t\t\t\t\t\t\t\tuniform vec4 fogColor;\t\t\t\t\t\t\t\t\t\t\tuniform float fogDensity;\t\t\t\t\t\t\t\t\t\tuniform float shadowMapBias1;\t\t\t\t\t\t\t\t\tuniform float shadowMapBias2;\t\t\t\t\t\t\t\t\tuniform float shadowMapBackFaceBias;\t\t\t\t\t\t\tuniform float shadowOpacity;\t \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying float v_backfaceValue;\t\t\t\t\t\t\t\t\tvarying vec4 v_posFromLight;\t\t\t\t\t\t\t\t\tvarying vec4 v_posFromLight2;\t\t\t\t\t\t\t\t"+Fd.prototype.Tm+
"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// diffuse texture\t\t\t\t\t\t\t\t\t\t\n\t\tvec4 diffuseColor = texture2D(texture1, v_texCoord1) * v_color;\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n"+Fd.prototype.Um+Fd.prototype.Sm+" } ";
l.sr="\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\tuniform sampler2D shadowmap;\t\t\t\t\t\t\t\t\tuniform sampler2D shadowmap2;\t\t\t\t\t\t\t\t\tuniform vec4 fogColor;\t\t\t\t\t\t\t\t\t\t\tuniform float fogDensity;\t\t\t\t\t\t\t\t\t\tuniform float shadowMapBias1;\t \t\t\t\t\t\t\t\tuniform float shadowMapBias2;\t \t\t\t\t\t\t\t\tuniform float shadowMapBackFaceBias;\t\t\t\t\t\t\tuniform float shadowOpacity;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\tvarying float v_backfaceValue;\t\t\t\t\t\t\t\t\tvarying vec4 v_posFromLight;\t\t\t\t\t\t\t\t\tvarying vec4 v_posFromLight2;\t\t\t\t\t\t\t\t"+Fd.prototype.Tm+
"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\t\tvec4 color1 = texture2D(texture1, texCoord);\t\t\t\t\tvec4 color2 = texture2D(texture2, texCoord);\t\t\t\t\tcolor1 = ((1.0 - v_color.w) * color1) + (v_color.w * color2);\t// interpolate texture colors based on vertex alpha\t \n\t\tvec4 diffuseColor = color1 * v_color;\t\t\t\t\t\t\t\t\t\n"+Fd.prototype.Um+
Fd.prototype.Sm+" } ";
l.$o="\t\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D shadowmap;\t\t\t\t\t\t\t\t\tuniform sampler2D shadowmap2;\t\t\t\t\t\t\t\t\tuniform vec4 fogColor;\t\t\t\t\t\t\t\t\t\t\tuniform float fogDensity;\t\t\t\t\t\t\t\t\t\tuniform float shadowMapBias1;\t \t\t\t\t\t\t\t\tuniform float shadowMapBias2;\t \t\t\t\t\t\t\t\tuniform float shadowMapBackFaceBias;\t\t\t\t\t\t\tuniform float shadowOpacity;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying float v_backfaceValue;\t\t\t\t\t\t\t\t\tvarying vec4 v_posFromLight;\t\t\t\t\t\t\t\t\tvarying vec4 v_posFromLight2;\t\t\t\t\t\t\t\t"+Fd.prototype.Tm+
"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        vec2 texCoord = vec2(v_texCoord1.s, v_texCoord1.t);\t\t\t\tvec4 diffuseColor = texture2D(texture1, texCoord) * vec4(v_color.r, v_color.g, v_color.b, 1.0);\t\t\t\tif (diffuseColor.a < 0.5) discard;\t\t\t"+Fd.prototype.Um+Fd.prototype.Sm+" } ";
l.fs="\t\t\t\t\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\n\tuniform mat4 worldtransform;\t\t\t\t\t\t\t\t\n\tuniform mat4 worldviewprojLight; \t\t\t\t\t\t\t\n\tuniform mat4 worldviewprojLight2; \t\t\t\t\t\t\t\n\tuniform vec4 arrLightPositions[4];\t\t\t\t\t\t\t\n\tuniform vec4 arrLightColors[5]; \t\t\t\t\t\t\t\n\tuniform vec3 vecDirLight; \t\t\t\t\t\t\t\t\t\n\tuniform vec4 colorDirLight; \t\t\t\t\t\t\t\t\n\tuniform float grassMovement;\t\t\t\t\t\t\t\t\n\tuniform float windStrength;\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t    attribute vec4 vNormal;\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vColor;\t\t\t\t\t\t\t\t\t\t    attribute vec2 vTexCoord1;\t\t\t\t\t\t\t\t\t\tattribute vec2 vTexCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec4 v_color;\t\t\t\t\t\t\t\t\t\t    varying vec2 v_texCoord1;\t\t\t\t\t\t\t\t\t\tvarying vec2 v_texCoord2;\t\t\t\t\t\t\t\t\t\tvarying float v_backfaceValue;\t\t\t\t\t\t\t\t\tvarying vec4 v_posFromLight;\t // position on shadow map\t\n\tvarying vec4 v_posFromLight2;\t // position on 2nd shadow map\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvec4 grasspos = vPosition;\t\t\t\t\t\t\t\t\tgrasspos.x += sin(grassMovement + ((worldtransform[3].x + vPosition.x) / 10.0)) * (1.0 - vTexCoord1.y) * windStrength;\t        gl_Position = worldviewproj * grasspos;\t\t\t\t\t        v_texCoord1 = vTexCoord1.st;\t\t\t\t\t\t\t\t\tv_texCoord2 = vTexCoord2.st;\t\t\t\t\t\t\t\t\t// Calculate position on shadow map\t\t\t\t\t\t\n\t\tv_posFromLight = worldviewprojLight * vPosition;\t\t\t\tv_posFromLight2 = worldviewprojLight2 * vPosition;\t\t"+Fd.prototype.jj+
"\tcurrentLight = currentLight * vec4(vColor.x, vColor.y, vColor.z, 1.0);\t\t\tv_color = min(currentLight * 4.0, vec4(1.0,1.0,1.0,1.0));\t\t\t\tv_color.a = vColor.a;\t// preserve vertex alpha \n    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";function fe(){this.zm=[];this.Kb=[];this.we=1}function ge(a,b){for(var c=0;c<a.zm.length;++c){var d=a.zm[c];if(d.n==b)return d}return null}function he(a,b,c){if(b==null||b=="")return null;var d=ge(a,b);if(d!=null)return d;if(c){b=d=new ie(b);if(b!=null){ge(a,b.n)!=null&&n.va&&n.va.print("ERROR! Cannot add the sound multiple times: "+b.n);a.zm.push(b)}return d}return null}
function Kc(a,b,c,d){if(b==null)return null;var e=null;e=typeof b=="string"?he(a,b,true):b;if(e==null||e.hc==null)return null;je(a);for(b=0;b<a.Kb.length;)if(a.Kb[b].src===e){a.Kb[b].src.hc.pause();a.Kb.splice(b,1)}else++b;try{e.hc.currentTime=0}catch(f){}if(typeof d==="undefined")d=1;e.hc.volume=d*a.we;e.hc.play();var g=new ke(e);g.Ap=d;a.Kb.push(g);e.an&&e.hc.removeEventListener("ended",e.an,false);e.hc.an=null;if(c){g.up=true;a=function(){if(!g.Si){try{this.currentTime=0}catch(h){}this.play()}};
e.hc.addEventListener("ended",a,false);e.hc.an=a}return g}fe.prototype.stop=function(a){if(a){a.src.hc.pause();a.Si=true;je(this)}};function le(a,b){a.we=b;if(a.we<0)a.we=0;if(a.we>1)a.we=1;try{for(b=0;b<a.Kb.length;++b){var c=a.Kb[b];c.src.hc.volume=c.Ap*a.we}}catch(d){}}function je(a){for(var b=0;b<a.Kb.length;)if(me(a.Kb[b]))a.Kb.splice(b,1);else++b}function Mc(a,b){for(var c=0;c<a.Kb.length;++c){var d=a.Kb[c];if(d&&d.src&&d.src.n==b){a.Kb.splice(c,1);d.Si=true;d.src.hc.pause();return}}}n.je=new fe;
function ie(a){this.n=a;var b=null;try{b=new Audio;b.src=a}catch(c){}this.loaded=true;this.hc=b}function ke(a){this.src=a;this.up=this.Si=false;this.Ap=1;this.startTime=(new Date).getTime()}function me(a){if(a.Si)return true;if(a.up)return false;var b=(new Date).getTime(),c=a.src.duration;return c>0&&b>a.startTime+c};function ne(a,b,c,d,e,f,g,h,j){if((b==null||b==true)&&n.va==null)n.va=new ea(a,d);this.iq=a;this.Gb=document.getElementById(this.iq);this.ra=new oe;this.O=null;this.mq=false;this.zg=null;this.Ia=new ud;this.Ne=new n.rq;this.Li=this.Ph=false;this.Pn=0;this.Mc=60;this.Xl=this.Ul=this.Vl=this.Sb=null;this.Ze=this.Ip=false;this.hh=[];this.Cr=h;(this.cp=g?true:false)&&pe(this);this.tq=f==null?'Error: This browser does not support WebGL (or it is disabled).<br/>See <a href="www.ambiera.com/copperlicht/browsersupport.html">here</a> for details.':
f;this.li=[];this.ki=[];this.Wh=false;this.Kl=this.Jl=this.Ml=this.Ll=this.Oc=this.Nc=0;this.Xh=true;this.Rj=false;this.Al=this.Bm=0;this.Xj=null;e!=null&&qe(this,true,e,j);re(this);if(c)this.Mc=c;var m=this;setInterval(function(){m.Xj!=null&&se(m);if(n.va){++m.Pn;var o=0,p=0;if(m.Ia){o=m.Ia;for(var i=p=0;i<o.Ma.length;++i)o.Ma[i].sc==false&&++p;o=p;p=m.Ia.Ma.length}if(m.Li&&o==0){m.Li=false;te(m)}if(m.Ph||o){i="Loading";if(o>0)i="Textures loaded: "+(p-o)+"/"+p;switch(m.Pn%4){case 0:i+="   ";break;
case 1:i+=".  ";break;case 2:i+=".. ";break;case 3:i+="...";break}ia(n.va,i)}else ia(n.va,null)}},500);ue(Z(),this)}function ve(a){if(a.ra==null)return null;return a.ra.bh()}
function we(a){document.onkeydown=function(f){xe(a,f)};document.onkeyup=function(f){ye(a,f)};var b=a.Gb;if(b!=null){b.onmousemove=function(f){ze(a,f)};b.onmousedown=function(f){Ae(a,f)};b.onmouseup=function(f){Be(a,f)};b.onmouseover=function(){a.Xh=true};b.onmouseout=function(){a.Xh=false};Ce(a);try{var c=function(f){(f=f)||(f=event);if(f)De(a,f.detail<0||f.wheelDelta>0?1:-1)};b.addEventListener("mousewheel",c,false);b.addEventListener("DOMMouseScroll",c,false)}catch(d){}try{c=function(f){a.Rj=false;
Be(a,f.changedTouches[0])&&Ee(a,f,true)};b.addEventListener("touchstart",function(f){if(f.touches!=null){a.Rj=f.touches.length==2;if(a.Rj)a.Bm=Fe(a,f)}Ae(a,f.changedTouches[0])&&Ee(a,f,true)},false);b.addEventListener("touchend",c,false);b.addEventListener("touchcancel",c,false);b.addEventListener("touchleave",c,false);b.addEventListener("touchmove",function(f){if(a.Rj&&f.touches!=null&&f.touches.length>=2){f=Fe(a,f);var g=f-a.Bm;a.Bm=f;De(a,g)}else ze(a,f.changedTouches[0])&&Ee(a,f,true)},false)}catch(e){}}}
function Fe(a,b){a=b.touches;if(a[0].pageX==null)return 0;return Math.sqrt((a[0].pageX-a[1].pageX)*(a[0].pageX-a[1].pageX)+(a[0].pageY-a[1].pageY)*(a[0].pageY-a[1].pageY))}ne.prototype.load=function(a,b,c){if(!Ge(this)){qe(this,false,this.tq);return false}var d=this;this.Ph=true;(new la(a,a.indexOf(".ccbz")!=-1)).load(function(e){d.fn(e,a,b);c&&c()});return true};
function Ge(a){if(a.O!=null)return true;var b=a.Gb;if(b==null)return false;var c=n.qm!=null&&n.qm.Fs;a.O=new Fd(a.Ia);if(c||a.O.ib(b)==false)if(n.qm!=null){a.O=new n.qm;if(a.O.ib(b)==false)return false}else return false;if(a.Ia)a.Ia.O=a.O;we(a);var d=1E3/a.Mc,e=q();function f(){var g=q(),h=g-e;if(h>d){e=g-h%d;a.cp&&He(a);Ie(a);if(n.va!=null){a.ra.bh();g=n.va;if(g.En!=null){g.frames+=1;h=(new Date).getTime();if(h-g.cn>1E3){var j="FPS: "+(g.frames/(h-g.cn)*1E3).toFixed(2);g.En.nodeValue=j;g.cn=h;g.frames=
0}}}}window.requestAnimationFrame(f)}window.requestAnimationFrame(f);return true}function pe(){document.body.style.margin="0";document.body.style.padding="0";document.body.style.overflow="hidden"}function He(a){var b=window.innerHeight||window.clientHeight;a.Gb.setAttribute("width",(window.innerWidth||window.clientWidth)+"px");a.Gb.setAttribute("height",b+"px")}
ne.prototype.fn=function(a,b,c){this.Ph=false;var d=new Je;a=d.xr(a,b,this.Ia,this.Ne,this);if(a!=null)if(!c||this.ra==null||this.ra!=null&&this.ra.Tb.length==0){this.ra=a;if(d.On){this.Kn=d.xo;this.oq=b}if(a.Eo)this.Li=true;else te(this)}else for(b=0;b<a.Tb.length;++b)this.ra.Km(a.Tb[b])};function te(a){a.Qk(a.ra.bh());Ie(a);a.Xl!=null&&a.Xl()}
function Ie(a){if(!(a.ra==null||a.O==null))if(!(a.Ph||a.Li)){re(a);Me(a);var b=a.ra.bh();if(!a.mq&&b){for(var c=false,d=0;d<a.hh.length;++d){var e=a.hh[d];e.Yr();if(e.vr()){if(e.Rk!=null&&!e.$m){var f=ve(a);e.Rk.execute(f.Ua,f);e.Rk=null}if(e.Sk!=null&&e.$m){f=ve(a);e.Sk.execute(f.Ua,f);e.Sk=null}a.hh.splice(d,1);--d}else c=true}c&&Ne(b);a.Sb&&a.Sb();d=a.O;b.Pb=d;if(b.Va==0)b.Va=q();b.Xq=null;c=false;if(b.Ch.length==0)e=false;else{e=q();f=false;for(var g=0;g<b.Ch.length;){var h=b.Ch[g];if(h.Wr<e){h.Ve.mb&&
h.Ve.mb.removeChild(h.Ve);b.Ch.splice(g,1);f=true;b.Jd&&h.Ve.gb&&Oe(b.Jd,h.Ve.gb)}else++g}e=f}if(e)c=true;if(b.Ua.Sb(b,q()))c=true;if(b.da){e=new I(false);b.da.oa.ia(e);e=K(e,b.da.Bb);e=!e.F(b.Vj)}else e=true;d=d?Gd(d):false;if(b.ql||b.ok==0&&(e||d)||b.ok==1&&(e||c||d)||b.ok==2||Pe(Z())){b.ql=false;c=true}else c=false;if(c){c=a.O;d=b.eg;if(c.P!=null){Vd(c);e=c.P;e.clearDepth(c.nf?0:1);e.depthMask(true);e.clearColor(n.Dc(d)/255,n.Bc(d)/255,n.Ac(d)/255,1);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}a.Vl&&
a.Vl();c=a.O;b.Je=[];b.Ng=[];b.pi=[];b.Jf=[];b.Ud=[];b.pk=[];b.jk=[];b.Ua.Ta(b);b.xj=null;b.Tq=0;e=false;d=c.Md;be(c);if(n.sl)f=false;else{b:{for(f=0;f<b.Pc.length;++f)if(b.Pc[f].Gc){f=true;break b}f=false}f=f?true:false}if(f){b.lk||Qe(b);Re(b);f=be(c);b.jm=f;f=Se(b,0,true);b.Lc=0;b.Ld=1;if(f)if(ae(c,f,true,true,b.eg))e=true}if(b.wi&&Te(b,c)){ee(c,true,b.Ke,b.Pg,b.qi,b.ui);c.si=b.si;c.ti=b.ti;c.vi=b.vi;c.wk=b.wk}for(f=f=0;f<b.pk.length;++f){b.qb=Ue;b.pk[f].kb(c)}Ve(b,c);if(b.da){b.da.oa.ia(b.Vj);
b.Vj=K(b.Vj,b.da.Bb)}b.wi&&ee(c,false,null,null);if(e){b.lk||Qe(b);e=b.Pb;f=e.ja.e();g=e.Ab.e();h=e.oa.e();var j=new I;e.Ob(j);j.ia(e.Ab);j.ia(e.oa);for(j=0;j<b.Pc.length;++j)b.Pc[j].Gc&&We(b,j,1);e.Ob(f);g.ia(e.Ab);h.ia(e.oa);ae(c,d,false,false);if(f=Se(b,b.Lc,false,b.Ld)){d=c.ja.e();e=c.Ab.e();g=c.oa.e();h=new I;c.Ob(h);h.ia(c.Ab);h.ia(c.oa);b.xa.m.h=0;b.xa.m.pa=f;Xe(b);c.Ob(d);e.ia(c.Ab);g.ia(c.oa);if(n.gq)for(e=d=0;e<c.Ia.Ma.length;++e)if((f=c.Ia.Ma[e])&&f.Dg){Pd(c,10+100*d,10,100,100,f,false);
++d}}}b.qb=Ye;for(f=0;f<b.jk.length;++f)b.jk[f].kb(c);a.Ul&&a.Ul();b=n.$;b!=null&&Ze(b,a.O);b=a.O;b.P!=null&&b.P.flush()}}Me(a)}}ne.prototype.Km=function(a){if(this.ra){this.ra.Tb.push(a);this.ra.Tb.length==1&&this.ra.Lp(a)}};function ic(a,b,c){if(!a.ra)return false;var d=a.ra.Tb;b=b;if(c)b=b.toLowerCase();for(var e=0;e<d.length;++e){var f=d[e].n;if(c)f=f.toLowerCase();if(b==f){a.Qk(d[e]);return true}}return false}
ne.prototype.Qk=function(a){if(!a)return false;var b=a.Pk()=="panorama",c=a.Pk()=="free",d=null;this.ra.Lp(a);if(!a.Fo){a.Fo=true;var e=false,f=$e(a,"camera");if(f)for(var g=0;g<f.length;++g){var h=f[g];if(h&&h.Gc){d=h;e=true;af(d,this.O.width,this.O.height);break}}if(!e){e=4/3;if(this.O.width&&this.O.height)e=this.O.width/this.O.height;d=new bf;cf(d,e);vc(a.Ua,d);e=null;if(!b){e=new df(d,this);Zb(d,e)}if(c){if(a.ll!=null)d.f=a.ll.e();if(a.Dj!=null)e!=null?qc(e,a.Dj):pc(d,a.Dj)}e&&ef(e,!b)}a.da=d;
a.Jd=ff(a,true);gf(this,a.Ua,a.Jd)}Z().qa=a;a.ok=this.ra.Zq;Ne(a);return true};function Me(a){if(a.zg!=null){var b=a.ra.bh();if(b!=null)if(a.zg.o===b){a.O&&af(a.zg,a.O.Nb(),a.O.Mb());b.da=a.zg;a.zg=null}}}function xe(a,b){var c=ve(a);if(c==null)return false;if(b==null)b=window.event;var d=false;c=c.da;if(c!=null)d=c.We(b);for(c=0;c<a.ki.length;++c)if(a.ki[c].We(b))d=true;return Ee(a,b,d)}
function ye(a,b){var c=ve(a);if(c==null)return false;if(b==null)b=window.event;var d=false;c=c.da;if(c!=null)d=c.Xe(b);for(c=0;c<a.li.length;++c)if(a.li[c].Xe(b))d=true;return Ee(a,b,d)}function Ee(a,b,c){if(c){try{b.preventDefault()}catch(d){}return true}return false}function re(a){for(var b=0,c=0,d=a.Gb;d!=null;){b+=d.offsetLeft;c+=d.offsetTop;d=d.offsetParent}a.gl=b;a.hl=c}
function hf(a,b){if(a.Ze)return a.O.Nb()/2;return b.pageX?b.pageX-a.gl:b.clientX-a.Gb.offsetLeft+document.body.scrollLeft}function jf(a,b){if(a.Ze)return a.O.Mb()/2;return b.pageY?b.pageY-a.hl:b.clientY-a.Gb.offsetTop+document.body.scrollTop}
function Ae(a,b){if(b==null)b=window.event;a.Wh=true;a.Xh=true;if(b){a.Jl=hf(a,b);a.Kl=jf(a,b);a.Nc=a.Jl;a.Oc=a.Kl}var c=ve(a);if(c==null)return false;var d=false;if(a.Tn)d=a.Tn();if(!d){d=c.da;d!=null&&d.le(b);d=b;for(var e=0;e<c.Xc.length;++e)c.Xc[e].le(d)}return Ee(a,b,true)}function kf(a){if(a.Ze){a.Ll=0;a.Ml=0}else{a.Jl=a.Nc;a.Kl=a.Oc}}
function Be(a,b){if(b==null)b=window.event;a.Wh=false;var c=ve(a);if(c==null)return false;if(b){a.Nc=hf(a,b);a.Oc=jf(a,b)}var d=false;if(a.Un)d=a.Un();if(!d){d=c.da;d!=null&&d.zd(b);d=b;for(var e=0;e<c.Xc.length;++e)c.Xc[e].zd(d)}return Ee(a,b,true)}function De(a,b){a=ve(a);if(a!=null){var c=a.da;c!=null&&c.ag(b);for(c=0;c<a.Xc.length;++c)a.Xc[c].ag(b)}}
function ze(a,b){if(b==null)b=window.event;if(a.Ze){a.Ll=b.movementX||b.mozMovementX||b.webkitMovementX||0;a.Ml=b.movementY||b.mozMovementY||b.webkitMovementY||0}if(b){a.Nc=hf(a,b);a.Oc=jf(a,b)}var c=ve(a);if(c==null)return false;var d=c.da;d!=null&&d.Ye(b);d=b;for(var e=0;e<c.Xc.length;++e)c.Xc[e].Ye(d);return Ee(a,b,true)}l=ne.prototype;l.Sb=null;l.Un=null;l.Tn=null;l.Ul=null;l.Vl=null;l.Xl=null;
function lf(a,b,c){a=a.O;if(a==null)return null;var d=a.oa,e=a.Ab;if(d==null||e==null)return null;d=K(d,e);var f=new Gb;f.Zk(d);d=Ib(f);e=Jb(f).substract(d);f=Lb(f).substract(d);var g=a.Nb();a=a.Mb();c=c/a;return d.add(w(e,b/g)).add(w(f,c))}
function mf(a,b){var c=new I(false),d=a.O;if(!d.oa)return null;d.oa.ia(c);c=K(c,d.Ab);a=d.Nb()/2;d=d.Mb()/2;if(d==0||a==0)return null;b=new s(b.c,b.b,b.d);b.W=1;c=c;var e=b.e();e.Fa=b.W;b.c=e.c*c.q+e.b*c.w+e.d*c.A+e.Fa*c.J;b.b=e.c*c.v+e.b*c.r+e.d*c.B+e.Fa*c.K;b.d=e.c*c.t+e.b*c.u+e.d*c.p+e.Fa*c.C;b.W=e.c*c.G+e.b*c.H+e.d*c.I+e.Fa*c.L;c=b.W==0?1:1/b.W;if(b.d<0)return null;e=new Na;e.c=a*b.c*c+a;e.b=d-d*b.b*c;return e}function nc(a,b){if(b!=null)a.zg=b}
function gf(a,b,c){if(b){for(var d=0;d<b.ma.length;++d){var e=b.ma[d];if(e)if(e.l()=="collisionresponse")e.Ob(c);else if(e.l()=="onclick"||e.l()=="onmove")e.ja=c;else if(e.l()=="gameai")e.ja=c;else if(e.l()=="3rdpersoncamera")e.ja=c}for(d=0;d<b.ba.length;++d)(e=b.ba[d])&&gf(a,e,c)}}
ne.prototype.jn=function(a){if(!a||!this.ra)return false;if(this.Kn==null)return false;for(var b=null,c=-1,d=0;d<this.ra.Tb.length;++d)if(a==this.ra.Tb[d].n){c=d;b=this.ra.Tb[d];break}if(c==-1)return false;a=(new Je).jn(this.Kn,b,c,this.oq,this.Ia,this.Ne,this);if(a!=null){b=this.ra.bh()==b;this.ra.Tb[c]=a;b&&this.Qk(a)}return true};function se(a){if(!a.Ph&&!a.Li){a.Xj.style.display="none";a.Xj=null}}
function qe(a,b,c,d){if(a.Gb!=null){var e=document.createElement("div");a.Gb.parentNode.appendChild(e);var f=document.createElement("div");re(a);var g=b?23:100,h=b?30:0,j=a.gl+(a.Gb.width-200)/2,m=a.hl+a.Gb.height/2;b||(m+=30);var o=b&&c.indexOf("<img")!=-1;c=c.replace("$PROGRESS$","");var p="";if(o){g=new Image;a.ss=g;h=c.indexOf('src="');h=c.substring(h+5,c.indexOf('"',h+5));g.src=h;g="#000000";if(typeof d!=="undefined")g=d;f.style.cssText="position: absolute; left:"+a.gl+"px; top:"+a.hl+"px; color:#ffffff; padding:5px; height:"+
a.Gb.height+"px; width:"+a.Gb.width+"px; background-color:"+g+";";p='<div style="position: relative; top: 50%;  transform: translateY(-50%);">'+c+"</div>"}else{f.style.cssText="position: absolute; left:"+j+"px; top:"+m+"px; color:#ffffff; padding:5px; background-color:#000000; height:"+g+"px; width:200px; border-radius:5px; border:1px solid #777777;  opacity:0.5;";p='<p style="margin:0; padding-left:'+h+'px; padding-bottom:5px;">'+c+"</p> ";if(b&&!o)p+='<img style="position:absolute; left:5px; top:3px;" src="copperlichtdata/loading.gif" />'}f.innerHTML=
p;e.appendChild(f);if(b)a.Xj=e}}ne.prototype.Xk=function(){var a=this.Gb;if(a){a.Xk=a.requestPointerLock||a.mozRequestPointerLock||a.webkitRequestPointerLock;a.Xk()}};
function Ce(a){function b(){a.Ip&&a.Xk()}function c(){var d=a.Gb;a.Ze=document.PointerLockElement===d||document.pointerLockElement===d||document.mozPointerLockElement===d||document.webkitPointerLockElement===d?true:false}document.addEventListener("fullscreenchange",b,false);document.addEventListener("mozfullscreenchange",b,false);document.addEventListener("webkitfullscreenchange",b,false);document.addEventListener("pointerlockchange",c,false);document.addEventListener("mozpointerlockchange",c,false);
document.addEventListener("webkitpointerlockchange",c,false)}function nf(a,b,c){if(c==null)c=a.Gb;a.Ip=b;c.requestFullscreen=c.requestFullscreen||c.Is||c.mozRequestFullScreen||c.msRequestFullscreen||c.webkitRequestFullscreen;c.requestFullscreen()};function $(){this.h=-1;this.f=new s;this.V=new s;this.sa=new s(1,1,1);this.Z=true;this.n="";this.pb=0;this.Oa=-1;this.mb=null;this.ba=[];this.ma=[];this.aa=new I;this.gb=this.o=null}l=$.prototype;l.ib=function(){this.f=new s;this.V=new s;this.sa=new s(1,1,1);this.ba=[];this.ma=[];this.aa=new I};l.f=null;l.V=null;l.sa=null;l.Z=true;l.n="";l.Oa=-1;l.gb=null;l.mb=null;l.l=k("none");l.ob=function(){return new B};
function N(a,b){for(var c=0;c<a.ma.length;++c){var d=a.ma[c];if(d.l()==b)return d}return null}function of(a,b){for(var c=0;c<a.ma.length;++c){var d=a.ma[c].Xf(b);if(d!=null)return d}return null}function pf(a){var b=a.ob().e();yb(a.aa,b);return b}
function qf(a,b,c,d,e){b.n=new String(a.n);b.Z=a.Z;b.pb=a.pb;b.f=a.f.e();b.V=a.V.e();b.sa=a.sa.e();b.h=a.h;b.o=a.o;c&&vc(c,b);for(var f=0;f<a.ba.length;++f){var g=a.ba[f];if(g){var h=-1;if(c&&c.o)h=Yc(c.o);g=g.i(b,g.Oa,h);if(g!=null){g.Oa=h;vc(b,g)}}}for(f=0;f<a.ma.length;++f)Zb(b,a.ma[f].i(a,a.o,d,e));if(a.aa)b.aa=a.aa.e()}$.prototype.i=k(null);function Zb(a,b){b!=null&&a.ma.push(b)}function rf(a,b){if(b!=null){var c;for(c=0;c<a.ma.length;++c)if(a.ma[c]===b){a.ma.splice(c,1);return}}}
function vc(a,b){if(b){b.o=a.o;b.mb&&b.mb.removeChild(b);b.mb=a;a.ba.push(b)}}$.prototype.removeChild=function(a){for(var b=0;b<this.ba.length;++b)if(this.ba[b]===a){a.mb=null;this.ba.splice(b,1);return}};$.prototype.Ta=function(a){if(this.Z)for(var b=0;b<this.ba.length;++b)this.ba[b].Ta(a)};
$.prototype.Sb=function(a,b){var c=false;if(this.Z){var d,e=this.ma.length;for(d=0;d<e;){c=this.ma[d].jb(this,b)||c;var f=e;e=this.ma.length;f>=e&&++d}P(this);for(d=0;d<this.ba.length;++d)c=this.ba[d].Sb(a,b)||c}return c};$.prototype.Zm=function(){var a=new I;ub(a,this.V);wb(a,this.f);if(this.sa.c!=1||this.sa.b!=1||this.sa.d!=1){var b=new I;xb(b,this.sa);a=K(a,b)}return a};function P(a){a.aa=a.mb!=null?K(a.mb.aa,a.Zm()):a.Zm()}$.prototype.kb=aa();function O(a){return new s(a.aa.J,a.aa.K,a.aa.C)}
$.prototype.hd=k(0);$.prototype.Cc=k(null);function sf(a){for(a=a;a;){if(!a.Z)return false;a=a.mb}return true}$.prototype.zp=aa();$.prototype.aj=aa();function tf(a){if(!a.o)return false;if(a.o.da!==a.mb)return false;a=N(a.mb,"camerafps");if(a==null)return false;return a.xn};function bf(){this.ib();this.g=new B;this.Gc=this.oc=false;this.ha=new s(0,0,10);this.zb=new s(0,1,0);this.oa=new I;this.Bb=new I;this.qd=n.PI/2.5;this.Sc=4/3;this.$g=0.1;this.Zg=3E3;this.rj=this.Of=true;this.Qe=false;rb(this.oa,this.qd,this.Sc,this.$g,this.Zg)}bf.prototype=new $;function uf(a){rb(a.oa,a.qd,a.Sc,a.$g,a.Zg)}bf.prototype.l=k("camera");function cf(a,b){if(!n.F(a.Sc,b)){a.rj=false;a.Sc=b;uf(a)}}function vf(a,b){if(!n.F(a.qd,b))if(!isNaN(b)){a.qd=b;uf(a)}}
function pc(a,b){if(b){a.ha=b.e();if(a.Of){P(a);a.V=Ha(b.substract(O(a)))}}}bf.prototype.Sb=function(a,b){a=$.prototype.Sb.call(this,a,b);this.Qe||wf(this);return a};function wf(a){var b=O(a),c=a.ha.e();if(b.F(c))c.c+=1;tb(a.Bb,b,c,a.zb)}l=bf.prototype;l.Ta=function(a){if(a.da===this){xf(a,this,2);$.prototype.Ta.call(this,a)}};l.kb=function(a){this.Qe||wf(this);if(this.Sc==0||this.rj){af(this,a.width,a.height);this.Sc==0&&cf(this,0.75)}this.oa.ia(a.oa);this.Bb.ia(a.Ab)};
l.le=function(a){for(var b=0;b<this.ma.length;++b)this.ma[b].le(a)};l.ag=function(a){for(var b=0;b<this.ma.length;++b)this.ma[b].ag(a)};l.zd=function(a){for(var b=0;b<this.ma.length;++b)this.ma[b].zd(a)};l.Ye=function(a){for(var b=0;b<this.ma.length;++b)this.ma[b].Ye(a)};l.We=function(a){for(var b=false,c=0;c<this.ma.length;++c)if(this.ma[c].We(a))b=true;return b};l.Xe=function(a){for(var b=false,c=0;c<this.ma.length;++c)if(this.ma[c].Xe(a))b=true;return b};
l.i=function(a,b,c){var d=new bf;qf(this,d,a,b,c);if(this.ha)d.ha=this.ha.e();if(this.zb)d.zb=this.zb.e();if(this.oa)d.oa=this.oa.e();if(this.Bb)d.Bb=this.Bb.e();d.qd=this.qd;d.Sc=this.Sc;d.$g=this.$g;d.Zg=this.Zg;if(this.g)d.g=this.g.e();return d};function af(a,b,c){if(!(b==0||c==0))if(n.F(a.Sc,0)||a.rj){cf(a,b/c);a.rj=true}};function yf(){this.ib();this.g=new B;this.oc=false;this.Q=null;this.ws=true;this.gb=null;this.Sn=true;this.io=false}yf.prototype=new $;l=yf.prototype;l.ob=function(){if(this.Q)return this.Q.g;return this.g};l.ur=ca("Q");l.Mp=ba("Q");l.l=k("mesh");l.Ta=function(a){var b=this.Q;if(this.Z&&b){for(var c=false,d=false,e=0;e<b.wa.length;++e)if(ed(b.wa[e].m))c=true;else d=true;if(c)tf(this)?xf(a,this,zf):xf(a,this,Af);if(d)tf(this)?xf(a,this,Bf):xf(a,this,Cf);$.prototype.Ta.call(this,a)}};
l.kb=function(a){a.Ob(this.aa);for(var b=a.bd,c=0;c<this.Q.wa.length;++c){var d=this.Q.wa[c];if(ed(d.m)==(this.o.qb==Af)){if(this.io||!d.m.Qb)a.bd=false;Hd(a,d.m);Id(a,d)}}b&&de(a,true)};l.hd=function(){if(this.Q)return this.Q.wa.length;return 0};l.Cc=function(a){if(this.Q!=null)if(a>=0&&a<this.Q.wa.length)return this.Q.wa[a].m;return null};l.i=function(a,b,c){var d=new yf;qf(this,d,a,b,c);if(this.Q)d.Q=this.Q.i();d.ji=this.ji;d.oc=this.oc;if(this.g)d.g=this.g.e();return d};function Df(){this.Q=new md;var a=[0,1,2,0,2,3],b=new kd;this.Q.Cd(b);b.m.Zb=true;b.T=a;b.k.push(this.Ga(-1,-1,-1,0,0,1,1,1));b.k.push(this.Ga(1,-1,-1,0,0,1,0,1));b.k.push(this.Ga(1,1,-1,0,0,1,0,0));b.k.push(this.Ga(-1,1,-1,0,0,1,1,0));b=new kd;this.Q.Cd(b);b.m.Zb=true;b.T=a;b.k.push(this.Ga(1,-1,-1,-1,0,0,1,1));b.k.push(this.Ga(1,-1,1,-1,0,0,0,1));b.k.push(this.Ga(1,1,1,-1,0,0,0,0));b.k.push(this.Ga(1,1,-1,-1,0,0,1,0));b=new kd;this.Q.Cd(b);b.m.Zb=true;b.T=a;b.k.push(this.Ga(-1,-1,1,1,0,0,1,1));
b.k.push(this.Ga(-1,-1,-1,1,0,0,0,1));b.k.push(this.Ga(-1,1,-1,1,0,0,0,0));b.k.push(this.Ga(-1,1,1,1,0,0,1,0));b=new kd;this.Q.Cd(b);b.m.Zb=true;b.T=a;b.k.push(this.Ga(1,-1,1,0,0,-1,1,1));b.k.push(this.Ga(-1,-1,1,0,0,-1,0,1));b.k.push(this.Ga(-1,1,1,0,0,-1,0,0));b.k.push(this.Ga(1,1,1,0,0,-1,1,0));b=new kd;this.Q.Cd(b);b.m.Zb=true;b.T=a;b.k.push(this.Ga(1,1,-1,0,-1,0,1,1));b.k.push(this.Ga(1,1,1,0,-1,0,0,1));b.k.push(this.Ga(-1,1,1,0,-1,0,0,0));b.k.push(this.Ga(-1,1,-1,0,-1,0,1,0));b=new kd;this.Q.Cd(b);
b.m.Zb=true;b.T=a;b.k.push(this.Ga(1,-1,1,0,1,0,1,1));b.k.push(this.Ga(1,-1,-1,0,1,0,0,1));b.k.push(this.Ga(-1,-1,-1,0,1,0,0,0));b.k.push(this.Ga(-1,-1,1,0,1,0,1,0))}Df.prototype=new yf;l=Df.prototype;l.l=k("sky");l.Ga=function(a,b,c,d,e,f,g,h){d=new Nb(true);d.f.c=a;d.f.b=b;d.f.d=c;d.ta.c=g;d.ta.b=h;return d};l.Ta=function(a){if(this.Z){xf(a,this,1);$.prototype.Ta.call(this,a)}};
l.kb=function(a){var b=this.o.da;if(b&&this.Q){var c=new I(false);this.aa.ia(c);wb(c,O(b));b=(b.$g+b.Zg)*0.5;var d=new I;xb(d,new s(b,b,b));a.Ob(K(c,d));c=this.Q;if(c!=null)for(b=0;b<c.wa.length;++b){d=c.wa[b];Hd(a,d.m,true);Id(a,d)}}};l.i=function(a,b,c){var d=new Df;qf(this,d,a,b,c);if(this.Q)d.Q=this.Q.e();d.ji=this.ji;d.oc=this.oc;if(this.g)d.g=this.g.e();return d};new yf;function Ef(){this.ib();this.g=new B;this.Rg=this.yi=10;this.Nh=false;this.tc=new kd;this.jh=new Nb(true);this.kh=new Nb(true);this.lh=new Nb(true);this.mh=new Nb(true);var a=this.tc.T;a.push(0);a.push(2);a.push(1);a.push(0);a.push(3);a.push(2);a=this.tc.k;a.push(this.jh);a.push(this.kh);a.push(this.lh);a.push(this.mh);this.jh.ta.c=1;this.jh.ta.b=1;this.kh.ta.c=1;this.kh.ta.b=0;this.lh.ta.c=0;this.lh.ta.b=0;this.mh.ta.c=0;this.mh.ta.b=1;for(var b=0;b<4;++b)C(this.g,a[b].f)}Ef.prototype=new $;l=Ef.prototype;
l.ob=ca("g");l.l=k("billboard");l.Ta=function(a){if(this.Z){tf(this)?xf(a,this,ed(this.tc.m)?zf:Bf):xf(a,this,ed(this.tc.m)?Af:Cf);$.prototype.Ta.call(this,a)}};
l.kb=function(a){var b=this.o.da;if(b){var c=a.bd;a.bd=false;if(this.Nh){f=O(this);var d=O(b),e=b.zb;b=b.ha.substract(d);b.normalize();d=Ga(e,b);za(d)==0&&d.set(e.b,e.c,e.d);d.normalize();A(d,0.5*this.yi);e=Ga(d,b);e.normalize();A(e,0.5*this.Rg);this.Nh&&e.set(0,-0.5*this.Rg,0);A(b,1);wa(this.jh.f,f);this.jh.f.ua(d);this.jh.f.ua(e);wa(this.kh.f,f);this.kh.f.ua(d);pa(this.kh.f,e);wa(this.lh.f,f);pa(this.lh.f,d);pa(this.lh.f,e);wa(this.mh.f,f);pa(this.mh.f,d);this.mh.f.ua(e);this.tc.update(true);f=
new I(true);a.Ob(f);Hd(a,this.tc.m);Id(a,this.tc)}else{var f=O(this);a.zk==null&&ce(a);e=a.zk;b=new I(true);xb(b,new s(this.yi*0.5,this.Rg*0.5,0));d=a.Ab.e();wb(d,new s(0,0,0));var g=new I(true);nb(d,g);wb(g,f);b=K(g,b);a.Ob(b);Hd(a,this.tc.m);Id(a,e)}c&&de(a,true)}};l.hd=k(1);l.Cc=function(){return this.tc.m};l.i=function(a,b,c){var d=new Ef;qf(this,d,a,b,c);if(this.g)d.g=this.g.e();d.yi=this.yi;d.Rg=this.Rg;d.Nh=this.Nh;d.tc.m=this.tc.m.e();return d};function Ff(){this.ib();this.g=new B;this.Ca=new kd;this.Na=new s(0,-0.03,0);this.$b=new s(0,0,0);this.Dk=this.Tj=0;this.fb=[]}Ff.prototype=new $;l=Ff.prototype;l.Na=null;l.sd=10;l.$b=null;l.sf=1E3;l.Th=2E3;l.Uh=200;l.vg=10;l.Zj=20;l.bk=4278190080;l.$j=4294967295;l.wg=5;l.xg=5;l.tg=7;l.Vh=7;l.Gh=false;l.Hh=500;l.Jj=0;l.mg=false;l.Nj=500;l.Pd=null;l.Gg=false;l.tk=20;l.uk=20;l.Dn=false;
l.i=function(a,b,c){var d=new Ff;qf(this,d,a,b,c);if(this.g)d.g=this.g.e();d.Na=this.Na.e();d.sd=this.sd;d.$b=this.$b.e();d.sf=this.sf;d.Th=this.Th;d.Uh=this.Uh;d.vg=this.vg;d.Zj=this.Zj;d.bk=this.bk;d.$j=this.$j;d.wg=this.wg;d.xg=this.xg;d.tg=this.tg;d.Vh=this.Vh;d.Gh=true;d.Hh=this.Hh;d.Jj=this.Jj;d.mg=this.mg;d.Nj=this.Nj;d.Pd=this.Pd;d.Gg=this.Gg;d.tk=this.tk;d.uk=this.uk;d.Ca.m=this.Ca.m.e();return d};l.ob=ca("g");l.l=k("particlesystem");
l.Ta=function(a){if(this.Z){xf(a,this,ed(this.Ca.m)?Af:Cf);$.prototype.Ta.call(this,a)}};l.hd=k(1);l.Cc=function(){return this.Ca.m};
l.Sb=function(a,b){var c=false;if(this.Z)if(this.Tj==0){this.Tj=b;c=false}else{c=b-this.Tj;this.Tj=b;if(this.Z){var d=false;d=this.Zj-this.vg;var e=1E3/(d?this.vg+Math.random()*d:this.vg);d=this.fb.length;this.Dk+=c;if(this.Dk<=e)d=false;else{e=this.Dk/e+0.5;this.Dk=0;if(d+e>this.Uh)e-=d+e-this.Uh;if(e<=0)d=false;else{var f=this.Na.e();eb(this.aa,f);for(var g=db(this.aa).getLength(),h=xa(this.$b),j=d;j<d+e;++j){var m=new Gf;m.jd=new s(0,0,0);if(!h){if(this.$b.c!=0)m.jd.c=Math.random()*this.$b.c-this.$b.c*
0.5;if(this.$b.b!=0)m.jd.b=Math.random()*this.$b.b-this.$b.b*0.5;if(this.$b.d!=0)m.jd.d=Math.random()*this.$b.d-this.$b.d*0.5}m.startTime=b;m.hj=f.e();if(this.sd){var o=f.e(),p=Math.random()*this.sd*2-this.sd;p*=n.Nd;var i=Math.cos(p);p=Math.sin(p);var v=o.c,r=o.b;o.c=v*i-r*p;o.b=v*p+r*i;p=Math.random()*this.sd*2-this.sd;p*=n.Nd;i=Math.cos(p);p=Math.sin(p);v=o.b;r=o.d;o.b=v*i-r*p;o.d=v*p+r*i;Ia(o,Math.random()*this.sd*2-this.sd);m.hj=o}m.Ri=this.Th-this.sf==0?b+this.sf:b+this.sf+Math.random()*(this.Th-
this.sf);m.color=n.dp(this.bk,this.$j,Math.random()*100/100);m.Pp=m.color;m.Qp=m.hj.e();if(this.wg==this.tg&&this.xg==this.Vh){m.dj=this.wg;m.ej=this.xg}else{o=Math.random()*100/100;i=1-o;m.dj=this.wg*o+this.tg*i;m.ej=this.xg*o+this.Vh*i}m.dj*=g;m.ej*=g;m.on=m.dj;m.pn=m.ej;lb(this.aa,m.jd);this.fb.unshift(m)}d=true}}if(!this.Gh&&!this.mg&&!this.Gg)e=false;else{e=0;f=null;if(this.Gh)for(e=0;e<this.fb.length;++e){f=this.fb[e];if(f.Ri-b<this.Hh)f.color=n.dp(f.Pp,this.Jj,(f.Ri-b)/this.Hh)}if(this.mg){g=
Ca(this.Pd,db(this.aa));for(e=0;e<this.fb.length;++e){f=this.fb[e];h=(b-f.startTime)/this.Nj;h=n.ic(h,0,1);h=1-h;f.hj=Ja(f.Qp,g,h)}}if(this.Gg){g=db(this.aa).c;for(e=0;e<this.fb.length;++e){f=this.fb[e];h=(b-f.startTime)/(f.Ri-f.startTime);f.on=f.dj+this.tk*h*g;f.pn=f.ej+this.uk*h*g}}e=true}d=e||d;e=new s(this.aa.J,this.aa.K,this.aa.C);this.Ca.g.reset(e.c,e.b,e.d);if(this.fb.length!=0)d=true;for(e=0;e<this.fb.length;){f=this.fb[e];if(b>f.Ri)this.fb.splice(e,1);else{f.jd.ua(w(f.hj,c));C(this.Ca.g,
f.jd);++e}}c=this.tg*0.5;this.Ca.g.N.c+=c;this.Ca.g.N.b+=c;this.Ca.g.N.d+=c;this.Ca.g.D.c-=c;this.Ca.g.D.b-=c;this.Ca.g.D.d-=c;c=new I(false);nb(this.aa,c);yb(c,this.Ca.g);c=d}else c=false}return $.prototype.Sb.call(this,a,b)||c};l.Ta=function(a){if(this.Z){if(this.fb.length!=0)xf(a,this,ed(this.Ca.m)?Af:Cf);$.prototype.Ta.call(this,a)}};
l.kb=function(a){if(this.o.da)if(this.fb.length!=0){var b=a.Od;if(this.Dn)a.Od=false;var c=a.bd;a.bd=false;if(this.fb.length*4>this.Ca.k.length||this.fb.length*6>this.Ca.T.length){for(var d=this.Ca.k.length,e=this.Ca.k;this.Ca.k.length<this.fb.length*4;){var f=null;f=new Nb(true);f.ta.set(0,0);e.push(f);f=new Nb(true);f.ta.set(0,1);e.push(f);f=new Nb(true);f.ta.set(1,1);e.push(f);f=new Nb(true);f.ta.set(1,0);e.push(f)}d=d;e=this.fb.length*6;f=this.Ca.T;for(var g=this.Ca.T.length;g<e;g+=6){f.push(0+
d);f.push(2+d);f.push(1+d);f.push(0+d);f.push(3+d);f.push(2+d);d+=4}}d=a.Ab;e=new s(-d.t,-d.u,-d.p);f=0;var h=null;for(g=0;g<this.fb.length;++g){var j=this.fb[g];h=0.5*j.on;var m=new s(d.q*h,d.w*h,d.A*h);h=-0.5*j.pn;var o=new s(d.v*h,d.r*h,d.B*h),p=n.ie(n.xd(j.color),n.Dc(j.color)/4,n.Bc(j.color)/4,n.Ac(j.color)/4);h=this.Ca.k[0+f];h.f=j.jd.add(m).add(o);h.na=p;h.j=e;h=this.Ca.k[1+f];h.f=j.jd.add(m).substract(o);h.na=p;h.j=e;h=this.Ca.k[2+f];h.f=j.jd.substract(m).substract(o);h.na=p;h.j=e;h=this.Ca.k[3+
f];h.f=j.jd.substract(m).add(o);h.na=p;h.j=e;f+=4}d=new I(true);a.Ob(d);this.Ca.update(false,true);Hd(a,this.Ca.m);Id(a,this.Ca,this.fb.length*2*3);if(this.Dn)a.Od=b;c&&de(a,true)}};function Gf(){this.hj=this.jd=null;this.Pp=this.color=this.Ri=this.startTime=0;this.Qp=null;this.ej=this.dj=this.pn=this.on=0};function Hf(){this.fi=new s(0,0,0);this.na=new oa;this.Ka=100;this.vh=0.01;this.Na=null;this.og=false}l=Hf.prototype;l.e=function(){var a=new Hf;a.fi=this.fi.e();a.na=this.na.e();a.Ka=this.Ka;a.vh=this.vh;a.og=this.og;a.Na=this.Na!=null?this.Na.e():null;return a};l.fi=null;l.na=null;l.vh=null;l.Ka=null;l.Na=null;l.og=false;function If(){this.Ra=new Hf;this.g=new B;this.ib()}If.prototype=new $;l=If.prototype;l.l=k("light");l.Ra=null;
l.i=function(a,b,c){var d=new If;qf(this,d,a,b,c);d.Ra=this.Ra.e();d.g=this.g.e();return d};l.Ta=function(a){this.Z&&xf(a,this,Jf);$.prototype.Ta.call(this,a);this.Ra.fi=O(this)};l.ob=ca("g");l.kb=function(a){this.Ra.og?Ud(a,this.Ra):Td(a,this.Ra)};function Kf(){this.ib();this.g=new B;this.Xg=0;this.of=false;this.Jb=[]}Kf.prototype=new $;l=Kf.prototype;l.Xg=0;l.of=false;l.Jb=[];l.ob=ca("g");l.l=k("path");l.i=function(a,b,c){var d=new Kf;qf(this,d,a,b,c);if(this.g)d.g=this.g.e();d.Xg=this.Xg;d.of=this.of;d.Jb=[];for(a=0;a<this.Jb.length;++a)d.Jb.push(this.Jb[a].e());return d};function Lf(a,b){if(b<0||b>=a.Jb.length)return new s(0,0,0);a.aa||P(a);b=a.Jb[b];b=b.e();lb(a.aa,b);return b}
function Mf(a,b,c){if(a.of)return b<0?c+b:b>=c?b-c:b;return b<0?0:b>=c?c-1:b}
function Nf(a,b,c){var d=a.Jb.length;if(a.of)b*=d;else{b=n.ic(b,0,1);b*=d-1}var e=new s;if(d==0)return e;if(d==1)return e;b=b;var f=n.ir(b),g=Math.floor(b)%d,h=a.Jb[Mf(a,g-1,d)];e=a.Jb[Mf(a,g+0,d)];b=a.Jb[Mf(a,g+1,d)];var j=a.Jb[Mf(a,g+2,d)],m=2*f*f*f-3*f*f+1;d=-2*f*f*f+3*f*f;g=f*f*f-2*f*f+f;f=f*f*f-f*f;h=b.substract(h);A(h,a.Xg);j=j.substract(e);A(j,a.Xg);e=w(e,m);e.ua(w(b,d));e.ua(w(h,g));e.ua(w(j,f));if(!c){a.aa||P(a);lb(a.aa,e)}return e};function Of(){this.ib();this.g=new B;this.Vn=this.Sh=this.Ae=0;this.hq=false;this.Yg=this.Hl=this.Qn=0;this.Bg=false;this.Wc=null;this.Vq=false;this.Wn=this.Fm=0}Of.prototype=new $;Of.prototype.ob=ca("g");Of.prototype.l=k("sound");Of.prototype.Ta=function(a){if(this.Z){xf(a,this,Cf);$.prototype.Ta.call(this,a)}};
function Pf(a,b,c,d){var e=a.Yg;if(d)if(b)if(d=d.da){var f=O(d);d.ha.substract(f);c=f.Cb(c);if(!(c<a.Ae)){c-=a.Ae;d=a.Sh-a.Ae;if(d>0){if(c>d)c=d;d=10;if(c!=0)d=a.Ae/c;e*=d;if(e>10)e=10}else e=10}if(e>1)e=1;if(b)try{b.src.hc.volume=e}catch(g){}}}function Qf(a,b){if(!a.Wc&&a.Ub){a.Vq=false;a.Wc=Kc(n.je,a.Ub,b);if(!a.Bg){b=O(a);Pf(a,a.Wc,b,a.o)}}}
Of.prototype.Sb=function(a,b){try{var c=O(this);this.Wc&&!this.Bg&&Pf(this,this.Wc,c,a);switch(this.Vn){case 0:break;case 1:if(this.Wc&&me(this.Wc)){this.Wc=null;var d=this.Qn-this.Hl;if(d<2)d=2;this.Fm=b+Math.random()*d+this.Hl}else if(!this.Wc&&(!this.Fm||b>this.Fm))this.Ub&&Qf(this,false);break;case 2:this.Wc||this.Ub&&Qf(this,true);break;case 3:if(!this.Wn)if(this.Ub){Qf(this,false);++this.Wn}break}}catch(e){}return false};
Of.prototype.i=function(a,b,c){var d=new Of;qf(this,d,a,b,c);if(this.g)d.g=this.g.e();return d};function Rf(a){this.ib();this.Xa=a;this.g=new B;this.xf=this.wf=100;this.Kf=this.Lf=50;this.zf=this.yf=0.5;this.Nf=1/6;this.Mf=1/6;this.Qg=this.$d=true;this.Tc=0;this.Me=this.La=null;this.Fg=true;this.kf=this.fl=false;this.Tg=1;this.pd=this.hb="";this.Pf=0;this.$h=this.Lh=this.ai=this.Oj=this.Wl=this.sh=false;this.Bi=this.Ci=null;this.zn=this.An="";this.yj=0}Rf.prototype=new $;l=Rf.prototype;l.pd="";l.Pf=0;l.Tg=1;l.So=k(false);l.ob=ca("g");l.l=k("2doverlay");
l.mn=function(a){this.hb=a;this.kf=this.hb!=null&&this.hb!="";if(this.pd=="")this.pd="12;default;arial;normal;bold;true"};l.Ta=function(a){if(this.Z){xf(a,this,Ye);$.prototype.Ta.call(this,a)}};
l.kb=function(a){var b=Sf(this,true,a),c=false;if(this.Xa!=null&&this.sh){c=this.Xa.Nc;var d=this.Xa.Oc;c=b.x<=c&&b.y<=d&&b.x+b.$a>=c&&b.y+b.Ya>=d}if(c&&this.ai)Od(a,b.x,b.y,b.$a,b.Ya,this.Lh,true);else this.Qg&&Od(a,b.x,b.y,b.$a,b.Ya,this.Tc,true);d=this.La;if(c&&this.Me&&this.$h)d=this.Me;if(d!=null&&d.sc){var e=d.Nb(),f=d.Mb();if(this.Fg){if(e&&f&&b.Ya&&b.$a){var g=b.$a;e=g*(f/e);if(e>b.Ya){f=b.Ya/e;g*=f;e*=f}b.$a=g;b.Ya=e;Pd(a,b.x,b.y,b.$a,b.Ya,d,true,null,null,null,!this.fl)}}else Pd(a,b.x,b.y,
b.$a,b.Ya,d,true,null,null,null,!this.fl)}if(this.kf&&this.pd&&this.hb!=""){a:{e=b.$a;(d=this.Ci==null||false)||(d=this.An!=this.hb||this.zn!=this.pd);if(d){Tf(this,a);d=document.createElement("canvas");if(d!=null){d.width=1;d.height=1;g=null;try{g=d.getContext("2d");if(g==null)break a}catch(h){break a}var j=this.pd;f=12;var m="Arial",o=false,p=false;if(j.indexOf("#fnt_")==0)j=j.substr(5);j=j.split(";");for(var i=0;i<j.length;++i){var v=j[i],r=v.toLowerCase();if(i==0)f=parseInt(r);else if(i==2)m=
v;else if(i==3){if(r.indexOf("italic")!=-1)o=true}else if(i==4)if(r.indexOf("bold")!=-1)p=true}j="";if(o)j+="italic ";if(p)j+="bold ";this.yj=f*96/72;j+=this.yj+"px ";j+=m;f=j;g.font=f;if(this.Tg==2){m=[];o=this.hb;p=g;v=i=j="";r=o.length;for(var E=0,z=e-6,u="c",y=0;y<r;++y){u=o.charAt(y);var D=false;if(u=="\r"){D=true;u=" ";if(o.charAt(y+1)=="\n"){o=o.substr(0,y).concat(o.substr(y+2));--r}}else if(u=="\n"){D=true;u=" "}if(u==" "||u==0||y==r-1){if(i.length){var H=p.measureText(v).width,Y=p.measureText(i).width;
if(E+Y+H>z){E=Y;m.push(j);j=i}else{j=j.concat(v);j=j.concat(i);E+=H+Y}v=i=""}v=v.concat(u);if(D){j=j.concat(v);j=j.concat(i);m.push(j);v=i=j="";E=0}}else i=i.concat(u)}j=j.concat(v);j=j.concat(i);m.push(j);o=this.yj*1.2;j=m.length;p=0;d.width=e;d.height=Math.max(1,j*o);g.fillStyle="rgba(0, 0, 0, 1)";g.fillRect(0,0,d.width,d.height);g.fillStyle="rgba(255, 255, 255, 1)";g.textBaseline="top";g.font=f;for(e=0;e<m.length;++e){g.fillText(m[e],0,p);p+=o}}else{e=g.measureText(this.hb);d.width=e.width;d.height=
this.yj*1.2;g.fillStyle="rgba(0, 0, 0, 1)";g.fillRect(0,0,d.width,d.height);g.fillStyle="rgba(255, 255, 255, 1)";g.textBaseline="top";g.font=f;g.fillText(this.hb,0,0)}this.Bi=this.Ci=d=bd(a,d,true);this.An=this.hb;this.zn=this.pd}}}d=this.Ci;g=this.Pf;if(c){if(this.Bi)d=this.Bi;g=this.Oj}if(d){c=d.uf;e=d.tf;this.Tg==1?Qd(a,b.x+(b.$a-c)/2,b.y+(b.Ya-e)/2,c,e,d,g):Qd(a,b.x,b.y,c,e,d,g)}}else Tf(this,a)};function Tf(a,b){b.deleteTexture(a.Ci);b.deleteTexture(a.Bi);a.Ci=null;a.Bi=null}
Rf.prototype.hd=k(0);function Sf(a,b,c){b=c.Nb();c=c.Mb();var d={};if(a.$d){d.x=a.wf;d.y=a.xf;d.$a=a.Lf;d.Ya=a.Kf}else{d.x=a.yf*b;d.y=a.zf*c;d.$a=a.Nf*b;d.Ya=a.Mf*c}return d}
Rf.prototype.i=function(a,b,c){var d=new Rf;qf(this,d,a,b,c);d.wf=this.wf;d.xf=this.xf;d.Lf=this.Lf;d.Kf=this.Kf;d.yf=this.yf;d.zf=this.zf;d.Nf=this.Nf;d.Mf=this.Mf;d.$d=this.$d;d.Qg=this.Qg;d.Tc=this.Tc;d.La=this.La;d.Me=this.Me;d.Fg=this.Fg;d.kf=this.kf;d.Tg=this.Tg;d.hb=this.hb;d.pd=this.pd;d.Pf=this.Pf;d.sh=this.sh;d.Wl=this.Wl;d.Oj=this.Oj;d.ai=this.ai;d.Lh=this.Lh;d.$h=this.$h;return d};function Uf(a,b){Rf.call(this,a);this.jg=null;this.nc=this.mc=0;this.ck=false;this.Vc=this.Pj=this.ho=this.fo=this.om=this.pm=0;Zb(this,new Vf(a,b,this))}Uf.prototype=new Rf;Uf.prototype.l=k("mobile2dinput");Uf.prototype.So=k(true);
Uf.prototype.kb=function(a){var b=Sf(this,true,a),c=false;if(this.Xa!=null){var d=this.Xa.Nc,e=this.Xa.Oc;this.ck=b.x<=d&&b.y<=e&&b.x+b.$a>=d&&b.y+b.Ya>=e;if(this.sh)c=this.ck}if(c&&this.ai)Od(a,b.x,b.y,b.$a,b.Ya,this.Lh,true);else this.Qg&&Od(a,b.x,b.y,b.$a,b.Ya,this.Tc,true);d=this.La;if(c&&this.Me&&this.$h)d=this.Me;e=c=0;if(d!=null&&d.sc){var f=d.Nb(),g=d.Mb();if(this.Fg){if(f&&g&&b.Ya&&b.$a){c=b.$a;e=c*(g/f);if(e>b.Ya){f=b.Ya/e;c*=f;e*=f}b.$a=c;b.Ya=e;Pd(a,b.x,b.y,b.$a,b.Ya,d,true);c=b.$a;e=
b.Ya}}else{Pd(a,b.x,b.y,b.$a,b.Ya,d,true);c=b.$a;e=b.Ya}}this.pm=c;this.om=e;this.fo=b.x;this.ho=b.y;if(this.Pj==0&&this.jg!=null&&this.jg.sc&&d!=null&&d.sc){f=this.mc*Math.sqrt(1-0.5*this.nc*this.nc);g=this.nc*Math.sqrt(1-0.5*this.mc*this.mc);f=(f+1)*0.5;g=(g+1)*0.5;var h=1/(d.Nb()/Number(this.jg.Nb()));d=1/(d.Mb()/Number(this.jg.Mb()));h=h*c;d=d*e;Pd(a,b.x+f*c-h*0.5,b.y+g*e-d*0.5,h,d,this.jg,true)}};function Wf(){this.ib();this.g=new B;this.oc=false;this.gb=this.Pa=null;this.Oh=0;this.Hb=[];this.Fb=0.25;this.gf=q();this.yb=this.Za=this.rl=0;this.ec=false;this.Kc=0;this.nd=250;this.se=true;this.Aj=false;this.qg=[];this.sj=0;this.Go=false;this.Il=20;this.Eb=[]}Wf.prototype=new $;n.lo=function(){this.Da=null;this.fk=this.pg=-1};Wf.prototype.ob=ca("g");Wf.prototype.jc=function(a){if(!this.Pa)return false;a=td(this.Pa,a);if(!a)return false;Xf(this,a.Fd,a.S);this.Fb=a.Mc;return true};
function gc(a,b,c){if(!a.Pa)return false;var d=a.Pa;if(!d)return false;var e=td(d,b);if(e){Xf(a,e.Fd,e.S);e.Mc!=0&&Yf(a,e.Mc);a.ec=c}else if(b){b=b.toLowerCase();if(b=="all"){Xf(a,0,Math.floor(d.md));d.ml!=0&&Yf(a,d.ml);a.ec=c}else if(b=="none"){Xf(a,0,0);a.ec=c}}return true}l=Wf.prototype;l.Mp=function(a){if(a){this.Pa=a;this.g=a.ob();Xf(this,0,Math.floor(a.md))}};l.l=k("animatedmesh");
l.Ta=function(a){if(this.Z&&this.Pa){var b=this.Hb,c=false,d=false;if(b!=null)for(var e=0;e<b.length;++e)if(ed(b[e]))c=true;else d=true;if(c)tf(this)?xf(a,this,zf):xf(a,this,Af);if(d)tf(this)?xf(a,this,Bf):xf(a,this,Cf);$.prototype.Ta.call(this,a)}};l.hd=function(){if(this.Hb!=null)return this.Hb.length;if(this.Q)return this.Q.wa.length;return 0};
l.Cc=function(a){if(this.Hb)if(a>=0&&a<this.Hb.length)return this.Hb[a];else if(this.Pa&&this.Pa.Dd&&a>=0&&this.Hb.length==a&&a<256){a=new dd;this.Hb.push(a);return a}return null};
l.i=function(a,b,c){var d=new Wf;qf(this,d,a,b,c);d.Pa=this.Pa;if(this.g)d.g=this.g.e();d.oc=this.oc;d.gb=this.gb;d.Oh=this.Oh;d.Hb=[];for(a=0;a<this.Hb.length;++a)d.Hb.push(this.Hb[a].e());d.Fb=this.Fb;d.gf=this.gf;d.rl=this.rl;d.Za=this.Za;d.yb=this.yb;d.ec=this.ec;d.Kc=this.Kc;d.Il=this.Il;d.nd=this.nd;d.se=this.se;d.Aj=false;d.qg=[];for(a=d.sj=0;a<this.Eb.length;++a){b=new n.lo;b.Da=this.Eb[a].Da;b.pg=this.Eb[a].pg;b.fk=this.Eb[a].fk;d.Eb.push(b)}return d};function Yf(a,b){a.Fb=b}
function Zf(a,b){a.ec=b}function Xf(a,b,c){if(!a.Pa)return false;var d=Math.floor(a.Pa.md)-1,e=a.Za,f=a.yb;if(c<b){a.Za=n.ic(c,0,d);a.yb=n.ic(b,a.Za,d)}else{a.Za=n.ic(b,0,d);a.yb=n.ic(c,a.Za,d)}if(e!=a.Za||f!=a.yb){b=a.Kc;a.Kc=n.ic(a.Za,a.Za,a.yb);a.gf=q()-Math.floor((a.Kc-a.Za)/a.Fb);a.se&&a.nd&&$f(a,b)}return true}
function ag(a){var b=a.Pa;if(b){var c=false;if((c=bg(a,a.Kc))||b.qn){a:{for(c=0;c<a.Hb.length;++c)if(a.Hb[c].Qb){c=true;break a}c=false}if(b.Qd){b.qn=false;rd(b,null,null);var d=0,e=0,f;for(d=0;d<b.za.length;++d){var g=b.za[d];for(e=0;e<g.th.length;++e){f=b.db[g.th[e]];f.Oe=g.lf.e()}}for(d=0;d<b.db.length;++d){f=b.Gk[d];for(e=0;e<f.length;++e)f[e]=false}for(d=0;d<b.Df.length;++d)sd(b,b.Df[d],null,c)}b.xb.D.set(0,0,0);b.xb.N.set(0,0,0);if(b.db.length){c=b.db[0];ld(c);b.xb.D=c.g.D.e();b.xb.N=c.g.N.e();
for(d=1;d<b.db.length;++d){c=b.db[d];ld(c);if(c.Oe==null){C(b.xb,c.g.D);C(b.xb,c.g.N)}else{e=c.g.e();yb(c.Oe,e);C(b.xb,e.D);C(b.xb,e.N)}}}a.g=b.ob().e();for(c=0;c<b.db.length;++c)b.db[c].update(true)}a.rl=a.Kc}}
Wf.prototype.Sb=function(a,b){var c=q();if(this.Oh==0||c-this.Oh>this.Il){var d;d=0;if(this.Za==this.yb)d=this.Za;else if(this.Fb==0)d=this.Za;else{d=0;if(this.ec){var e=false;d=Math.abs(Math.floor((this.yb-this.Za)/this.Fb));if(this.Fb>0){d=this.Za+(b-this.gf)%d*this.Fb;e=d<this.Kc}else{d=this.yb-(b-this.gf)%d*-this.Fb;e=d>this.Kc}e&&this.se&&$f(this,this.Kc)}else if(this.Fb>0){d=(b-this.gf)*this.Fb;d=this.Za+d;if(d>this.yb)d=this.yb}else{d=(b-this.gf)*-this.Fb;d=this.yb-d;if(d<this.Za)d=this.Za}d=
d}this.Kc=d;this.Oh=c}a=$.prototype.Sb.call(this,a,b);this.Eb.length!=0&&cg(this);return a};
Wf.prototype.kb=function(a){var b=this.o.xj;if(b)if(!Mb(b,pf(this)))return;if(b=this.Pa){a.Ob(this.aa);!b.Qd||ag(this);this.Go=true;for(var c=this.o.qb==dg,d=a.bd,e=0;e<b.db.length;++e){var f=b.db[e];if(e<this.Hb.length)f.m=this.Hb[e];if(c||ed(f.m)==(this.o.qb==Af)){f.Oe!=null&&a.Ob(K(this.aa,f.Oe));if(c){var g=f.m.h;if(g==id){this.o.ri.pa=f.m.pa;Hd(a,this.o.ri)}else if(g==hd){this.o.Og.pa=f.m.pa;Hd(a,this.o.Og)}else Hd(a,this.o.vk)}else{!f.m.Qb&&d&&de(a,false);Hd(a,f.m)}Id(a,f);f.Oe!=null&&a.Ob(this.aa)}}d&&
de(a,true)}};function eg(a,b){b=b.length;if(b>a.qg.length)for(;a.qg.length<b;){var c={};c.Hc=new s(0,0,0);c.Yb=new s(1,1,1);c.Ic=new zb;a.qg.push(c)}}function $f(a,b){if(a.Go){var c=a.Pa;if(c){bg(a,b);a.sj=q();a.Aj=true;eg(a,c.za);for(b=0;b<c.za.length;++b){var d=a.qg[b],e=c.za[b];d.Hc=e.Hc.e();d.Yb=e.Yb.e();d.Ic=e.Ic.e()}}}}
function bg(a,b){var c=a.Pa;if(c){var d=1;if(a.Aj){var e=q();if(e-a.sj>a.nd)a.Aj=false;else{d=(e-a.sj)/a.nd;eg(a,c.za);for(e=0;e<c.za.length;++e){var f=a.qg[e],g=c.za[e];g.Hc=f.Hc.e();g.Yb=f.Yb.e();g.Ic=f.Ic.e()}}}a=d;if(!c.Qd||n.F(c.yl,b)&&a==1)c=false;else{c.yl=b;if(a<0)c=false;else{if(n.F(a,1))for(d=0;d<c.za.length;++d){e=c.za[d];f=e.Hc.e();g=e.Yb.e();var h=e.Ic.e();qd(c,b,e,f,e.Cp,g,e.Kp,h,e.Jp);e.Hc=f.e();e.Yb=g.e();e.Ic=h.e()}else for(d=0;d<c.za.length;++d){e=c.za[d];var j=e.Hc.e(),m=e.Yb.e(),
o=e.Ic.e();f=j.e();g=m.e();h=o.e();qd(c,b,e,f,e.Cp,g,e.Kp,h,e.Jp);e.Hc=Ja(j,f,a);e.Yb=Ja(m,g,a);Cb(e.Ic,o,h,a)}for(b=0;b<c.za.length;++b){a=c.za[b];if(a.Af.length||a.Ie.length||a.Ef.length){if(!a.Ic)a.Ic=new zb;if(!a.Hc)a.Hc=new s;a.sg=Db(a.Ic);d=a.sg;e=a.Hc;d.q+=e.c*d.G;d.v+=e.b*d.G;d.t+=e.d*d.G;d.w+=e.c*d.H;d.r+=e.b*d.H;d.u+=e.d*d.H;d.A+=e.c*d.I;d.B+=e.b*d.I;d.p+=e.d*d.I;d.J+=e.c*d.L;d.K+=e.b*d.L;d.C+=e.d*d.L;d.Qa=false;a.Hn=false;if(a.Ie.length&&a.Yb&&!(n.F(a.Yb.c,1)&&n.F(a.Yb.b,1)&&n.F(a.Yb.d,
1))){e=a.Yb;d.q*=e.c;d.v*=e.c;d.t*=e.c;d.G*=e.c;d.w*=e.b;d.r*=e.b;d.u*=e.b;d.H*=e.b;d.A*=e.d;d.B*=e.d;d.p*=e.d;d.I*=e.d}}else a.sg=a.Rh.e()}c=c.qn=true}}return c}}Wf.prototype.zp=function(){if(this.o!=null)for(var a=0;a<this.Eb.length;){var b=0,c=this.Eb[a].fk;if(c!=-1)b=fg(this.o,this,c);if(b&&b.l()=="dummytrans"){this.Eb[a].Da=b;++a}else this.Eb.splice(a,1)}};
function cg(a){var b=a.Pa;if(b&&b.Qd){bg(a,a.Kc);rd(b,null,null);b=b.za;for(var c=0;c<a.Eb.length;++c){var d=a.Eb[c];if(d.pg>=0&&d.pg<b.length&&d.Da!=null){var e=b[d.pg];if(e)d.Da.Eg=e.lf.e()}}}}Wf.prototype.aj=function(a,b){for(var c=0;c<this.Eb.length;++c)if(this.Eb[c].Da==a)this.Eb[c].Da=b&&b.l()=="dummytrans"?b:null};function gg(){this.g=new B;this.lq=this.ar=0}gg.prototype=new $;function hg(){this.ib();this.g=new B;this.Eg=new I}hg.prototype=new $;hg.prototype.i=function(a,b,c){var d=new hg;qf(this,d,a,b,c);if(this.g)d.g=this.g.e();if(this.Eg)d.Eg=this.Eg;return d};hg.prototype.Zm=ca("Eg");hg.prototype.l=k("dummytrans");function ig(){this.ib();this.g=new B}ig.prototype=new $;ig.prototype.l=k("terrain");function jg(){this.Cn=0;this.Hk=new Na(1,1);this.Io=this.Jo=0.5;this.Mi=n.ie(190,255,255,255);this.yn=true;this.Co=n.ie(190,0,100,0);this.ol=false;this.Cl=0;this.Mn=new I;this.Bj=false;this.m=new dd;this.m.Qb=false;this.m.h=-1;this.m.Ed=false;this.Gn=this.Bf=null}jg.prototype=new yf;l=jg.prototype;l.l=k("water");
l.Ta=function(a){if(this.Z){xf(a,this,Af);$.prototype.Ta.call(this,a);var b=a.da,c=q(),d=false;if(this.Cl){d=100;if(b){var e=O(b),f=Pa(this.ob()).getLength();e=O(this).Cb(e);if(e>f)d*=e/f;if(d>1E3)d=1E3;b.Bb.F(this.Mn)||(d=10);this.Mn=b.Bb.e()}d=this.Cl+d<c}else d=true;if(d){this.Cl=c;xf(a,this,Ue)}if(this.ol)xf(a,this,Ye);else if(b){b=O(b);c=O(this);if(b.b<c.b){c=pf(this);b.c>=c.D.c&&b.c<=c.N.c&&b.d>=c.D.d&&b.d<=c.N.d&&xf(a,this,Ye)}}}};l.Sb=function(a,b){yf.prototype.Sb.call(this,a,b);return true};
l.kb=function(a){var b=this.o.da;if(b&&this.Q){if((b=this.o.xj)&&this.o.qb!=Ye)if(!Mb(b,pf(this)))return;if(this.o.qb==Af){if(!(this.m.h==-1||this.Bf==null))if(!this.Bj){a.Ob(this.aa);if(b=this.Q){this.g=b.g;this.m.pa=this.Bf;if(b&&b.wa&&b.wa.length>0)this.m.yc=b.wa[0].m.pa;for(var c=0;c<b.wa.length;++c){var d=b.wa[c];if(d){Hd(a,this.m);Id(a,d)}}}}}else if(this.o.qb==Ue){if(kg(this,a)){c=a.Md;a.nf=true;if(ae(a,this.Bf,true,true,this.o.eg)){this.Bj=true;b=this.o.da;d=b.oa;var e=b.Bb,f=b.zb,g=b.ha,
h=b.f,j=b.Of,m=b.Qe;b.Qe=true;b.Of=false;var o=O(this).b,p=g.e(),i=h.e();i.b=-h.b+2*o;b.f=i;p.b=-g.b+2*o;b.ha=p;var v=new I;tb(v,i,p,new s(0,1,0));b.Bb=v;p=new Va;o=new s(0,o,0);i=new s(0,1,0);p.j=i.e();Wa(p,o);o=p.e();p=w(o.j,-o.cb);lb(v,p);i=o.j.e();i.normalize();var r=db(v);if(!n.F(r.c,0)&&!n.F(r.b,0)&&!n.F(r.d,0)&&(!n.F(r.c,1)||!n.F(r.b,1)||!n.F(r.d,1))){i.c*=1/(r.c*r.c);i.b*=1/(r.b*r.b);i.d*=1/(r.d*r.d)}eb(v,i);i.normalize();o.j=i.e();Wa(o,p);v=new I;p=v=d.e();i=n.Op(o.j.c+p.A)/p.q;r=n.Op(o.j.b+
p.B)/p.r;i=-2/(i*o.j.c+r*o.j.b+-1*o.j.d+(1+p.p)/p.C*o.cb);p.t=o.j.c*i;p.u=o.j.b*i;p.p=o.j.d*i+1;p.C=o.cb*i;this.Gn=v;Ve(this.o,a,this);b.Qe=m;b.oa=d;b.Bb=e;b.ha=g;b.f=h;b.zb=f;b.Of=j;a.nf=false;ae(a,c,false,true);this.Bj=false}a.nf=false}}else if(this.o.qb==Ye&&!this.Bj){this.yn&&!this.ol&&Od(a,0,0,a.Nb(),a.Mb(),this.Co,true);this.ol&&Pd(a,10,10,250,200,this.Bf,false)}}};l.i=function(a,b,c){var d=new jg;qf(this,d,a,b,c);if(this.Q)d.Q=this.Q.e();d.ji=this.ji;d.oc=this.oc;if(this.g)d.g=this.g.e();return d};
function kg(a,b){if(a.Cq)return a.Bf!=null;a.Cq=true;lg(a,b);if(!a.Bf)return false;var c=b.P;a.m.h=Xd(b,a.gs,a.tr,true,c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,function(){var d=b.P,e=Yd(b,a.m.h);if(e){var f=d.getUniformLocation(e,"mWaterColor");d.uniform4f(f,n.Dc(a.Mi)/255,n.Bc(a.Mi)/255,n.Ac(a.Mi)/255,n.xd(a.Mi)/255);f=q()/1E3%1E3;var g=d.getUniformLocation(e,"mWaveMovement");d.uniform2f(g,a.Hk.c*f,a.Hk.b*f);f=d.getUniformLocation(e,"mWaveLength");d.uniform1f(f,a.Jo*100);e=d.getUniformLocation(e,"mWaveHeight");
d.uniform1f(e,a.Io)}});return true}jg.prototype.gs="\t\t\tuniform mat4 worldviewproj;\t\t\t\t\t\t\t\t\t\tuniform float mWaveLength;\t\t\t\t\t\t\t\t\t\tuniform vec2 mWaveMovement;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vPosition;\t\t\t\t\t\t\t\t\t    attribute vec4 vNormal;\t\t\t\t\t\t\t\t\t\t\tattribute vec4 vColor;\t\t\t\t\t\t\t\t\t\t    attribute vec2 vTexCoord1;\t\t\t\t\t\t\t\t\t\tattribute vec2 vTexCoord2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvarying vec2 WavesTexCoord;\t\t\t\t\t\t\t\t\t\tvarying vec3 TexCoord;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvec4 pos = worldviewproj * vPosition;\t\t\t\t\t        gl_Position = pos;\t\t\t\t\t\t\t\t\t\t\t\tWavesTexCoord = (vPosition.xz / mWaveLength) + mWaveMovement;\t\t\tTexCoord.x = 0.5 * (pos.w + pos.x);\t\t\t\t\t\t\t\tTexCoord.y = 0.5 * (pos.w + pos.y);\t\t\t\t\t\t\t\tTexCoord.z = pos.w;\t\t\t\t\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
jg.prototype.tr="\t\t\tuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\tuniform sampler2D texture2;\t\t\t\t\t\t\t\t\t\tuniform float\t\tmWaveHeight;\t\t\t\t\t\t\t\tuniform vec4\t\tmWaterColor;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    varying vec2 WavesTexCoord;\t\t\t\t\t\t\t\t\t\tvarying vec3 TexCoord;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    void main()\t\t\t\t\t\t\t\t\t\t\t\t\t    {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvec4 normalClr = texture2D(texture2, WavesTexCoord.xy);\t\t\tvec2 waveMovement = mWaveHeight * (normalClr.xy - 0.5);\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvec2 projTexCoord = clamp((TexCoord.xy / TexCoord.z) + waveMovement, 0.0, 1.0);\t\t\t\tvec4 reflectiveColor = texture2D(texture1, vec2(projTexCoord.x, -projTexCoord.y) );\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgl_FragColor = mWaterColor * reflectiveColor;\t\t\t\t\tgl_FragColor.a = mWaterColor.a;\t\t\t\t\t\t\t    }\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
function lg(a,b){if(b!=null){var c=b.Nb(),d=b.Mb(),e=512,f=512;switch(a.Cn){case 0:e=c/2;f=d/2;break;case 1:e=c/3;f=d/3;break;case 2:e=c/4;f=d/4;break}e=yd(b,e);f=yd(b,f);e=Math.min(e,f);f=Math.min(e,f);if(e<64)e=64;if(f<64)f=64;a.Bf=$d(b,e,f)}}function mg(a,b){a.Gn.ia(b.oa)};n.gq=false;function ng(){this.ib()}l=ng.prototype;
l.ib=function(){this.Ua=new $;this.Ua.o=this;this.n="";this.eg=0;this.Jd=null;this.Xb=new oa;this.Xb.wc=0;this.Xb.qc=0;this.Xb.lc=0;this.Pd=1;this.Od=false;this.ac=n.ie(255,200,200,200);this.Ih=0.001;this.Ni=1;this.Oi=4;this.Pc=[];for(var a=0;a<6;++a){var b={};b.Gc=false;this.Pc.push(b)}this.$l=1;this.am=0.5;this.bm=1;this.bi=4294901760;this.cm=0.8;this.em=this.dm=0.5;this.Pb=null;this.Va=0;this.da=null;this.ql=false;this.Vj=new I;this.Xq=null;this.ok=2;this.qb=0;this.Je=[];this.Ng=[];this.pi=[];
this.Jf=[];this.Ud=[];this.pk=[];this.jk=[];this.Xc=[];this.Tq=this.uq=0;this.$q=false;this.xj=null;this.Fo=false;this.Ch=[];this.zl=new s;this.jm=null;this.Lc=-1;this.Ld=1;this.xa=new kd;this.lk=false;this.mk=[]};l.Pk=k("unknown");l.zo=false;l.Ke=null;l.qi=null;l.vk=null;l.Og=null;l.Pg=null;l.wi=false;l.si=0.001;l.ti=1.0E-4;l.vi=0.5;l.wk=0.5;l.Mq=true;l.oo=0.2;l.Nq=1024;
function og(a,b){if(a.Ke)return true;if(a.zo)return false;a.zo=true;if(!a.Ke){var c=a.Nq,d=!b.po;a.Ke=$d(b,c,c,d);if(!a.Ke)return false;if(n.Fk){c=c;if(c>1E3)c/=2;a.qi=$d(b,c,c,d);if(!a.qi){a.Ke=null;return false}}a.vk=new dd;a.Og=new dd;a.ri=new dd;d=Xd(b,b.es,d?b.kr:b.lr);c=Xd(b,b.cs,b.Xo);b=Xd(b,b.ds,b.Xo);if(d==-1||c==-1||b==-1){a.Ke=null;a.qi=null;return false}a.vk.h=d;a.Og.h=c;a.ri.h=b}return true}
function Te(a,b){if(!og(ng.prototype,b))return false;for(var c=null,d=0;d<a.Ud.length;++d){var e=a.Ud[d];if(e.Ra&&e.Ra.og){c=e.Ra.Na.e();break}}if(!c)return false;e=a.da;var f=e.oa.e(),g=e.Bb.e(),h=e.zb.e(),j=e.ha.e(),m=e.f.e(),o=e.Of,p=e.Qe;e.Qe=true;e.Of=false;var i=new B,v=0;for(d=0;d<a.Je.length;++d){var r=a.Je[d],E=pf(r);if(v==0)i=E;else{r=i;C(r,E.D);C(r,E.N)}++v}v=b.Md;for(E=0;E<(n.Fk?2:1);++E){if(!ae(b,E==0?a.Ke:a.qi,true,true))break;d=new s(40,100,40);var z=new s(0,0,0);r=120;var u=Pa(i).getLength();
z=Oa(i);if(E==0){d=j.substract(m);ua(d,r);z=m.add(d);r=u*a.oo}else r=u*0.9;var y=c.e();ua(y,u*1);d=z.substract(y);ua(y,u*-1);z=z.substract(y);y=new s(0,1,0);var D;D=z.substract(d);var H=D.c*D.c+D.b*D.b+D.d*D.d;if(H>-1.0E-7&&H<1.0E-7)D=new s(0,0,0);else{H=1/Math.sqrt(H);D=new s(D.c*H,D.b*H,D.d*H)}if(D.la(y)==-1)y.c+=0.01;tb(e.Bb,d,z,y);u=Math.max(100,u)*2;a.Mq?sb(e.oa,r,r,1,u):rb(e.oa,n.PI/3.5,4/3,1,u);r=new I;r=K(r,e.oa);r=K(r,e.Bb);if(E==0)a.Pg=r;else a.ui=r;a.qb=pg;if(a.da){e.oa.ia(b.oa);e.Bb.ia(b.Ab)}u=
qg(a,b,b.oa,b.Ab,d);a.qb=dg;for(d=0;d<a.Je.length;++d){r=a.Je[d];y=r.l();z=y=="mesh";y=y=="animatedmesh";if(z||y)if(u==null||Sa(u,pf(r)))if(z){if(r.Sn){b.Ob(r.aa);for(z=0;z<r.Q.wa.length;++z){y=r.Q.wa[z];D=y.m.h;if(D==hd){a.Og.pa=y.m.pa;Hd(b,a.Og);Id(b,y)}else if(D==id){a.ri.pa=y.m.pa;Hd(b,a.ri);Id(b,y)}else if(!ed(y.m)){Hd(b,a.vk);Id(b,y)}}}}else y&&r.kb(b)}}ae(b,v,false,true);e.Qe=p;e.oa=f;e.Bb=g;e.ha=j;e.f=m;e.zb=h;e.Of=o;return true}
function qg(a,b,c,d,e,f){var g=b=null;if(c!=null&&d!=null&&e!=null){g=new Gb;g.Zk(K(c,d));if(a.$q||f)b=g.ob(e)}a.xj=g;return b}
function Ve(a,b,c){a.qb=pg;var d=null;if(a.da){d=O(a.da);a.da.kb(b)}a.qb=rg;a.so&&a.so.kb(b);Sd(b);b.Xb=a.Xb.e();b.Od=a.Od;b.ac.cg=1;b.ac.wc=n.Dc(a.ac)/255;b.ac.qc=n.Bc(a.ac)/255;b.ac.lc=n.Ac(a.ac)/255;b.Ih=a.Od?a.Ih:0;b.Ni=a.Ni;b.Oi=a.Oi;var e,f=0;d!=null&&a.Ud.length>0&&a.Ud.sort(function(j,m){j=ya(d,O(j));m=ya(d,O(m));if(j>m)return 1;if(j<m)return-1;return 0});a.qb=Jf;for(e=0;e<a.Ud.length;++e)a.Ud[e].kb(b);f+=a.Ud.length;c&&mg(c,b);c=qg(a,b,b.oa,b.Ab,d);a.qb=Cf;for(e=0;e<a.Je.length;++e){var g=
a.Je[e];if(c==null||Sa(c,pf(g))){g.kb(b);f+=1}}a.qb=Af;function h(j,m){j=ya(d,O(j));m=ya(d,O(m));if(j<m)return 1;if(j>m)return-1;return 0}d!=null&&a.Ng.length>0&&a.Ng.sort(h);for(e=0;e<a.Ng.length;++e){g=a.Ng[e];if(c==null||Sa(c,pf(g))){g.kb(b);f+=1}}if(a.pi.length||a.Jf.length){Rd(b);a.qb=Cf;for(e=0;e<a.pi.length;++e){g=a.pi[e];if(c==null||Sa(c,pf(g))){g.kb(b);f+=1}}a.qb=Af;if(d!=null&&a.Jf.length>0){a.Jf.sort(h);for(e=0;e<a.Jf.length;++e){g=a.Jf[e];if(c==null||Sa(c,pf(g))){g.kb(b);f+=1}}}}a.uq=
f}ng.prototype.getName=ca("n");ng.prototype.ln=ba("n");function sg(a,b){a.da=b}function Ne(a){a.ql=true}function xf(a,b,c){if(c==null)c=Cf;switch(c){case rg:a.so=b;break;case Cf:a.Je.push(b);break;case Jf:a.Ud.push(b);break;case Bf:a.pi.push(b);break;case zf:a.Jf.push(b);break;case pg:break;case Af:a.Ng.push(b);break;case Ye:a.jk.push(b);break;case Ue:a.pk.push(b);break}}function $e(a,b){if(a.Ua==null)return null;var c=[];tg(a,a.Ua,b,c);return c}
function tg(a,b,c,d){b.l()==c&&d.push(b);for(var e=0;e<b.ba.length;++e)tg(a,b.ba[e],c,d)}function sc(a,b){if(a.Ua==null)return null;var c=[];ug(a,a.Ua,b,c);return c}function ug(a,b,c,d){N(b,c)!=null&&d.push(b);for(var e=0;e<b.ba.length;++e)ug(a,b.ba[e],c,d)}function vg(a,b){if(a.Ua==null)return null;return wg(a,a.Ua,b)}function wg(a,b,c){if(b.n==c)return b;for(var d=0;d<b.ba.length;++d){var e=wg(a,b.ba[d],c);if(e)return e}return null}
function Qb(a,b){if(a.Ua==null)return null;return fg(a,a.Ua,b)}function fg(a,b,c){if(b.Oa==c)return b;for(var d=0;d<b.ba.length;++d){var e=fg(a,b.ba[d],c);if(e)return e}return null}function xg(a,b){if(b!=null){for(var c=0;c<a.Xc.length;++c)if(a.Xc[c]===b)return;a.Xc.push(b)}}
function ff(a,b,c){var d=$e(a,"mesh");if(d==null)return null;var e=null;if(c){c.clear();e=c}else e=new yg;for(c=0;c<d.length;++c){var f=d[c];if(f&&f.oc){var g=null;if(f.gb)g=f.gb;else{var h=g=null;if(f.mb&&f.mb.l()=="terrain"){g=hd;h=id}g=f.Q&&nd(f.Q)>100?new zg(f.Q,f,64,g,h):new Ag(f.Q,f,g,h)}if(b&&f.gb==null)f.gb=g;Zc(e,g)}}d=$e(a,"animatedmesh");for(c=0;c<d.length;++c)if((a=d[c])&&a.Pa&&!a.Pa.Qd&&a.Pa.Ai&&!a.Pa.Ai.N.F(a.Pa.Ai.D)){g=a.gb?a.gb:new Bg(a.Pa.Ai,a);if(b&&a.gb==null)a.gb=g;Zc(e,g)}return e}
function Wc(a,b,c){var d={};d.Ve=b;d.Wr=c+q();a.Ch.push(d)}function Cg(a,b,c,d,e){if(b&&b.Z&&(b.l()=="2doverlay"||b.l()=="mobile2dinput"))if(!e||e&&b.So()){var f=Sf(b,true,a.Pb);if(f.x<=c&&f.y<=d&&f.x+f.$a>=c&&f.y+f.Ya>=d)return b}for(f=0;f<b.ba.length;++f){var g=Cg(a,b.ba[f],c,d,e);if(g)return g}return null}function Yc(a){for(var b=0;b<1E3;++b){var c=Math.round(Math.random()*1E4+10);if(Qb(a,c)==null)return c}return-1}
ng.prototype.aj=function(a,b){if(a&&b){for(var c=0;c<a.ba.length&&c<b.ba.length;++c){var d=a.ba[c],e=b.ba[c];d&&e&&d.l()==e.l()&&b.aj(d,e)}return-1}};function Re(a){be(a.Pb);var b=n.ie(255,64,64,64);if(a.xa.k==null||a.xa.k.length==0){a.xa.k=[];a.xa.k.push(null);a.xa.k.push(null);a.xa.k.push(null);a.xa.k.push(null)}a.xa.k[0]=n.Ga(-1,-1,0,0,0,-1,b,0,0,0,0);a.xa.k[1]=n.Ga(1,-1,0,0,0,-1,b,1,0,1,0);a.xa.k[2]=n.Ga(-1,1,0,0,0,-1,b,0,1,0,1);a.xa.k[3]=n.Ga(1,1,0,0,0,-1,b,1,1,1,1)}
function Se(a,b,c,d){if(d==null)d=1;var e=new Na(a.jm.c*d>>0,a.jm.b*d>>0);if(!a.Pb.Ji){e.c=Math.pow(2,Math.ceil(Math.log(e.c)/Math.log(2)));e.b=Math.pow(2,Math.ceil(Math.log(e.b)/Math.log(2)))}var f="postEffectRTT";f+=b;f+="s"+d;b=wd(a.Pb.Ia,f);if(!c)return b;if(!b||b.uf!=e.c||b.tf!=e.b){b&&a.Pb.deleteTexture(b);b=$d(a.Pb,e.c,e.b,false,false,f)}return b}
function We(a,b,c){var d=a.Pb;switch(b){case Dg:var e=Se(a,a.Lc,false,a.Ld);b=Se(a,3,true,c);Eg(a,e,b);We(a,Fg,c);for(e=0;e<a.$l;++e){We(a,Mg,0.25);We(a,Ng,0.25);We(a,Mg,1);We(a,Ng,1)}e=Se(a,a.Lc,false,a.Ld);ae(d,b,false,false);a.xa.m.h=fd;a.xa.m.pa=e;Xe(a);if(!n.F(a.Ld,1)){a.Lc=(a.Lc+1)%2;a.Ld=c;Se(a,a.Lc,true,c)}Eg(a,b,Se(a,a.Lc,false,a.Ld));break;case Og:d=a.bm;d=n.ic(d,1,100);for(e=0;e<d;++e){We(a,Mg,c);We(a,Ng,c)}break;default:if(b<a.mk.length&&a.mk[b]!=-1){e=Se(a,a.Lc,false,a.Ld);if(!e)return;
a.Lc=(a.Lc+1)%2;a.Ld=c;c=Se(a,a.Lc,true,c);if(!c)return;ae(d,c,false,false);a.xa.m.h=a.mk[b];a.xa.m.pa=e;Xe(a)}break}}l=ng.prototype;l.yq="\t\t\t\nuniform vec4\tPARAM_Colorize_Color;\t\t\t\t\t\t\t\nuniform sampler2D\ttexture1;\t\t\t\t\t\t\t\t\t\nvarying vec2 v_texCoord1;     \t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nvoid main()\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tvec4 col = texture2D( texture1, v_texCoord1.xy );\t\t\t\n\tgl_FragColor = col * PARAM_Colorize_Color;\t\t\t\t\t\n}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n";
l.wq="\t\t\nuniform sampler2D\ttexture1;\t\t\t\t\t\t\t\t\t\nuniform float PARAM_SCREENX;\t\t\t\t\t\t\t\t\t\nvarying vec2 v_texCoord1;     \t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nvoid main()\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tconst int sampleCount = 4; \t\t\t\t\t\t\t\t\t\n\tconst float sampleFactor = 2.0; \t\t\t\t\t\t\t\n\tconst float sampleStart = (float(sampleCount)*sampleFactor) / -2.0;\t\t\t\n\tvec2 halfPixel = vec2(0.5 / PARAM_SCREENX, 0.5 / PARAM_SCREENX); \n\tvec4 col = vec4(0.0, 0.0, 0.0, 0.0);\t\t\t\t\t\t\n\tfor(int i=0; i<sampleCount; ++i)\t\t\t\t\t\t\t\n\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\tvec2 tcoord = v_texCoord1.xy + vec2((sampleStart + float(i)*sampleFactor) / PARAM_SCREENX, 0.0) + halfPixel; \n\t\tcol += texture2D( texture1, clamp(tcoord, vec2(0.0, 0.0), vec2(1.0, 1.0) ) ); \n\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tcol /= float(sampleCount);\t\t\t\t\t\t\t\t\t\t\t\n\tgl_FragColor = col;\t\t\t\t\t\t\t\t\t\t\t\n}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";
l.xq="\t\t\nuniform sampler2D\ttexture1;\t\t\t\t\t\t\t\t\t\nuniform float PARAM_SCREENY;\t\t\t\t\t\t\t\t\t\nvarying vec2 v_texCoord1;     \t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nvoid main()\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tconst int sampleCount = 4; \t\t\t\t\t\t\t\t\t\n\tconst float sampleFactor = 2.0; \t\t\t\t\t\t\t\n\tconst float sampleStart = (float(sampleCount)*sampleFactor) / -2.0;\t\t\t\n\tvec2 halfPixel = vec2(0.5 / PARAM_SCREENY, 0.5 / PARAM_SCREENY); \n\tvec4 col = vec4(0.0, 0.0, 0.0, 0.0);\t\t\t\t\t\t\n\tfor(int i=0; i<sampleCount; ++i)\t\t\t\t\t\t\t\n\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\tvec2 tcoord = v_texCoord1.xy + vec2(0.0, (sampleStart + float(i)*sampleFactor) / PARAM_SCREENY) + halfPixel; \n\t\tcol += texture2D( texture1, clamp(tcoord, vec2(0.0, 0.0), vec2(1.0, 1.0) ) ); \n\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tcol /= float(sampleCount);\t\t\t\t\t\t\t\t\t\t\t\n\tgl_FragColor = col;\t\t\t\t\t\t\t\t\t\t\t\n}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n";
l.Aq="\t\t\nuniform sampler2D\ttexture1;\t\t\t\t\t\t\t\t\t\nuniform float PARAM_LightTreshold_Treshold;\t\t\t\t\t\t\nvarying vec2 v_texCoord1;     \t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nvoid main()\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tvec4 col = texture2D( texture1, v_texCoord1.xy );\t\t\t\n\tfloat lum = 0.3*col.r + 0.59*col.g + 0.11*col.b;\t\t\t\n\tif (lum > PARAM_LightTreshold_Treshold)\t\t\t\t\t\t\n\t\tgl_FragColor = col;\t\t\t\t\t\t\t\t\t\t\n\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\tgl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\t\t\t\t\n}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n";
l.vq="\t\t\nuniform sampler2D\ttexture1;\t\t\t\t\t\t\t\t\t\nvarying vec2 v_texCoord1;     \t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nvoid main()\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tvec4 col = texture2D( texture1, v_texCoord1.xy );\t\t\t\n\tfloat lum = 0.3*col.r + 0.59*col.g + 0.11*col.b;\t\t\t\n\tgl_FragColor = vec4(lum, lum, lum, 1.0);\t\t\t\t\t\n}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n";l.Bq="\t\t\t\nuniform float PARAM_Vignette_Intensity;\t\t\t\t\t\t\t\nuniform float PARAM_Vignette_RadiusA;\t\t\t\t\t\t\t\nuniform float PARAM_Vignette_RadiusB;\t\t\t\t\t\t\t\nuniform sampler2D\ttexture1;\t\t\t\t\t\t\t\t\t\nvarying vec2 v_texCoord1;     \t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nvoid main()\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tvec4 col = texture2D( texture1, v_texCoord1.xy );\t\t\t\n\tfloat e1 =  ( v_texCoord1.x - 0.5 ) / ( PARAM_Vignette_RadiusA );\t\n\tfloat e2 =  ( v_texCoord1.y - 0.5 ) / ( PARAM_Vignette_RadiusB ); \n\tfloat d  = clamp(2.0 - ((e1 * e1) + (e2 * e2)), 0.0, 1.0);\t\n\tgl_FragColor = col * ((1.0 - PARAM_Vignette_Intensity) + (PARAM_Vignette_Intensity * d));\t\n}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n";
l.zq="\t\t\t\t\nuniform sampler2D texture1;\t\t\t\t\t\t\t\t\t\t\nvarying vec2 v_texCoord1;     \t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nvoid main()\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tvec4 col = texture2D( texture1, v_texCoord1 );\t\t\t\t\n\tgl_FragColor = vec4(1.0 - col.rgb, 1.0);\t\t\t\t\t\n}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n";
function Qe(a){if(!a.lk){a.lk=true;var b=a.Pb,c=b.P;a.xa.m.Qb=false;a.xa.m.Ik=false;a.xa.m.Re=false;a.xa.m.Ed=false;Re(a);a.xa.T.push(0);a.xa.T.push(1);a.xa.T.push(2);a.xa.T.push(3);a.xa.T.push(1);a.xa.T.push(2);for(var d=0;d<Pg;++d){var e="",f=-1,g=null;switch(d){case Dg:break;case Qg:e=a.zq;break;case Rg:e=a.yq;g=function(){var h=c.getUniformLocation(b.ub,"PARAM_Colorize_Color");c.uniform4f(h,n.Dc(a.bi)/255,n.Bc(a.bi)/255,n.Ac(a.bi)/255,1)};break;case Og:break;case Mg:e=a.wq;g=function(){var h=
c.getUniformLocation(b.ub,"PARAM_SCREENX");c.uniform1f(h,be(b).c)};break;case Ng:e=a.xq;g=function(){var h=c.getUniformLocation(b.ub,"PARAM_SCREENY");c.uniform1f(h,be(b).b)};break;case Fg:e=a.Aq;g=function(){var h=c.getUniformLocation(b.ub,"PARAM_LightTreshold_Treshold");c.uniform1f(h,a.am)};break;case Sg:e=a.vq;break;case Tg:e=a.Bq;g=function(){var h=c.getUniformLocation(b.ub,"PARAM_Vignette_Intensity");c.uniform1f(h,a.cm);h=c.getUniformLocation(b.ub,"PARAM_Vignette_RadiusA");c.uniform1f(h,a.dm);
h=c.getUniformLocation(b.ub,"PARAM_Vignette_RadiusB");c.uniform1f(h,a.em)};break}if(e!=""){f=Xd(b,b.Wb,e,null,null,null,g);if(f==-1)n.sl=true}a.mk.push(f)}}}function Xe(a){var b=a.Pb;Hd(b,a.xa.m);Id(b,a.xa)}function Eg(a,b,c){ae(a.Pb,c,false,false);a.xa.m.h=0;a.xa.m.pa=b;Xe(a)}var rg=1,Cf=0,Jf=2,pg=3,Af=4,Ye=5,Ue=6,dg=8,Bf=9,zf=10,Dg=0,Sg=1,Qg=2,Og=3,Rg=4,Tg=5,Fg=6,Mg=7,Ng=8,Pg=9;function Ug(){this.ib()}Ug.prototype=new ng;Ug.prototype.Pk=k("panorama");function Vg(){this.ib();this.ll=new s;this.Dj=new s}Vg.prototype=new ng;Vg.prototype.Pk=k("free");function Je(){this.a=this.ra=null;this.pl="";this.Ib=0;this.Y=this.Ia=null;this.kk="";this.xo=this.Ne=null;this.On=false;this.bq=function(a){var b="";a=new Uint8Array(a);for(var c=0;c<a.byteLength;c++)b+=String.fromCharCode(a[c]);return b};this.xr=function(a,b,c,d,e){this.pl=b;this.Ia=c;this.Y=e;this.Ne=d;if(this.Ia!=null)Z().Ia=c;if(a!=null&&b.indexOf(".ccbz")!=-1)a=this.bq(a);if(a==null||a.length==0){ja(n.va,"Error: Could not load file '"+b+"'");a=navigator.appVersion;a!=null&&a.indexOf("Chrome")!=
-1&&ja(n.va,"<i>For using local files with Chrome, run the file from a web server<br/>Or use Firefox instead. Or run it from CopperCube.</i>",true);return null}if(b.indexOf(".ccbz")!=-1)a=JSInflate.wr(a);else if(b.indexOf(".ccbjs")!=-1)a=n.dr(a);this.ra=b=new oe;this.Np();this.a=new Ad(a);if(!this.fn())return null;this.xo=a;return b};this.Np=function(){var a=this.pl,b=a.lastIndexOf("/");if(b!=-1)a=a.substring(0,b+1);this.kk=a};this.fn=function(){if(U(this.a)!=1701014630)return false;U(this.a);Ed(this.a,
4);for(var a=0;Bd(this.a)>0;){var b=this.vb();++a;if(a==1&&b!=1)return false;switch(b){case 1:this.Dr();break;case 12:this.Er();break;default:this.Ea()}}return true};this.Ea=function(){this.a.Wa=0+this.Ib};this.vb=function(){var a=0;a=Ed(this.a,2);var b=0;this.zj=b=Ed(this.a,4);this.Ib=this.a.Wa+b;return a};this.bo=function(){var a=new I(false);this.Hq(a);return a};this.Hq=function(a){for(var b=0;b<16;++b)qb(a,b,V(this.a))};this.Jq=function(){var a=new zb;a.Fa=V(this.a);a.c=V(this.a);a.b=V(this.a);
a.d=V(this.a);return a};this.Gp=function(a){for(var b=0,c=[],d=[0,12416,925824,63447168,4194836608,2181570688],e=[],f=0;f<a;++f)e.push(Ed(this.a,1));for(;b<a;){f=0;var g=this.Xr[e[b]];if(b+g>=a)return c.join("");for(var h=g;h>=0;--h){f+=e[b];++b;if(h!=0)f<<=6}if(b>a)break;f-=d[g];if(f<1114111)c.push(this.hr(f));else return c.join("")}return c.join("")};this.R=function(){var a=Ed(this.a,4);if(a>104857600)return"";if(a<=0)return"";return this.Gp(a)};this.Xr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,5,5,5,5];this.hr=function(a){if(a>65535){a-=
65536;return String.fromCharCode(55296+(a>>10),56320+(a&1023))}else return String.fromCharCode(a)};this.Dr=function(){for(var a=this.Ib;Bd(this.a)>0&&this.a.Wa<a;)switch(this.vb()){case 1004:this.ra.zh=U(this.a);break;case 20:this.Qr();break;case 2:var b=null;switch(U(this.a)){case 0:b=new Vg;this.Ep(b);break;case 1:b=new Ug;this.Fp(b);break;default:this.Ea()}this.ra.Km(b);break;default:this.Ea()}};this.jn=function(a,b,c,d,e,f,g){this.pl=d;this.Ia=e;this.Y=g;this.Ne=f;this.a=new Ad(a);this.Np();U(this.a);
U(this.a);Ed(this.a,4);a=-1;d=this.vb();if(d!=1)return null;for(b=this.Ib;Bd(this.a)>0&&this.a.Wa<b;){d=this.vb();switch(d){case 2:d=U(this.a);++a;if(a==c){c=null;switch(d){case 0:c=new Vg;this.Ep(c);break;case 1:c=new Ug;this.Fp(c);break;default:this.Ea()}return c}else this.Ea();default:this.Ea()}}return null};this.Qr=function(){U(this.a);this.ra.aq=this.R();for(var a=this.Ib;Bd(this.a)>0&&this.a.Wa<a;)switch(this.vb()){case 35:U(this.a);U(this.a);U(this.a);U(this.a);var b=U(this.a);if((b&1)!=0)this.ra.Eo=
true;if((b&16)!=0)n.sl=true;this.Ea();break;case 37:b=U(this.a);U(this.a);if((b&1)!=0)if(n.va==null)n.va=new ea(elementIdOfCanvas,showFPSCounter);else fa(n.va);if((b&2)!=0){U(this.a);this.R()}(b&4)!=0&&this.R();break;default:this.Ea()}};this.Ep=function(a){var b=this.Ib;for(this.Rr(a);Bd(this.a)>0&&this.a.Wa<b;)switch(this.vb()){case 1007:a.ll=this.U();a.Dj=this.U();break;case 8:this.Kq(a);break;case 1008:a.Pd=V(this.a);break;case 1009:a.Od=R(this.a);a.Ih=V(this.a);a.ac=U(this.a);break;case 1010:R(this.a);
a.Ni=V(this.a);a.Oi=V(this.a);break;case 1011:a.wi=R(this.a);a.si=V(this.a);a.ti=V(this.a);a.wk=V(this.a);a.vi=V(this.a);a.oo=V(this.a);break;case 1012:for(var c=0;c<6;++c)a.Pc[c].Gc=R(this.a);a.$l=U(this.a);a.am=V(this.a);a.bm=U(this.a);a.bi=U(this.a);a.cm=V(this.a);a.dm=V(this.a);a.em=V(this.a);break;default:this.Ea()}};this.Fp=function(){this.Ea()};this.U=function(){var a=new s;a.c=V(this.a);a.b=V(this.a);a.d=V(this.a);return a};this.lm=function(){var a=new oa;a.wc=V(this.a);a.qc=V(this.a);a.lc=
V(this.a);a.cg=V(this.a);return a};this.vs=function(){var a=V(this.a),b=V(this.a),c=V(this.a),d=V(this.a);if(a>1)a=1;if(b>1)b=1;if(c>1)c=1;if(d>1)d=1;return n.ie(d*255,a*255,b*255,c*255)};this.ii=function(){var a=new Na;a.c=V(this.a);a.b=V(this.a);return a};this.xc=function(){var a=new B;a.D=this.U();a.N=this.U();return a};this.Rr=function(a){if(this.vb()==26){a.n=this.R();a.eg=U(this.a)}else this.nq()};this.nq=function(){this.a.position-=10};this.Kq=function(a){for(var b=this.Ib;Bd(this.a)>0&&this.a.Wa<
b;)switch(this.vb()){case 9:this.eo(a,a.Ua,0);break;default:this.Ea()}};this.eo=function(a,b,c){if(b!=null){var d=this.Ib,e=U(this.a),f=U(this.a),g=this.R(),h=this.U(),j=this.U(),m=this.U(),o=R(this.a),p=U(this.a),i=null,v=0;if(c==0){b.Z=o;b.n=g;b.pb=p}for(;Bd(this.a)>0&&this.a.Wa<d;)switch(this.vb()){case 9:this.eo(a,i?i:b,c+1);break;case 10:switch(e){case 2037085030:i=new Df;i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=f;i.o=a;this.gn(i);vc(b,i);i=i;P(i);break;case 1752395110:i=new yf;i.h=e;
i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=f;i.o=a;this.gn(i);vc(b,i);i=i;P(i);break;case 1835950438:i=new Wf;i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=f;i.o=a;this.Ir(i);vc(b,i);i=i;P(i);break;case 1953526632:i=new gg(this.Y,null);i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=f;i.o=a;this.Lr(i);vc(b,i);i=i;P(i);break;case 1819042406:i=new Ef;i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=f;i.o=a;this.Jr(i);vc(b,i);i=i;P(i);break;case 1835098982:i=new bf;i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;
i.n=g;i.pb=p;i.o=a;i.Oa=f;this.Kr(i);vc(b,i);i=i;P(i);break;case 1751608422:i=new If;i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=f;i.o=a;this.Mr(i);vc(b,i);i=i;P(i);break;case 1935946598:i=new Of;i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=f;i.o=a;this.Hr(i);vc(b,i);i=i;P(i);break;case 1752461414:i=new Kf;i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=f;i.o=a;this.Nr(i);vc(b,i);i=i;P(i);break;case 1954112614:i=new hg;i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=f;i.o=a;i.g=this.xc();
for(var r=0;r<16;++r)qb(i.Eg,r,V(this.a));vc(b,i);i=i;P(i);break;case 1868837478:i=new Rf(this.Y);i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=f;i.o=a;this.Gr(i);vc(b,i);i=i;P(i);break;case 1668575334:i=new Ff;i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=f;i.o=a;this.Pr(i);vc(b,i);i=i;P(i);break;case 1835283046:i=new Uf(this.Y,a);i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=f;i.o=a;this.Fr(i);vc(b,i);i=i;P(i);break;case 1920103526:i=new ig;i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=
f;i.o=a;i.g=this.xc();vc(b,i);i=i;P(i);this.Ea();break;case 1920235366:i=new jg;i.h=e;i.f=h;i.V=j;i.sa=m;i.Z=o;i.n=g;i.pb=p;i.Oa=f;i.o=a;this.Tr(i);vc(b,i);i=i;P(i);break;default:if(c==0)a.Xb=this.lm();this.Ea();break}break;case 11:r=this.ao();i&&i.Cc(v)&&i.Cc(v).Zk(r);++v;break;case 25:r=i;if(r==null&&c==0)r=a.Ua;this.Gq(r,a);break;default:this.Ea()}i&&i.zp()}};this.gn=function(a){var b=this.Ib;a.g=this.xc();R(this.a);a.io=R(this.a);a.oc=R(this.a);for(a.Sn=R(this.a);Bd(this.a)>0&&this.a.Wa<b;)switch(this.vb()){case 14:var c=
this.Iq();a.Q=c;break;default:this.Ea()}};this.Iq=function(){var a=new md;a.g=this.xc();for(var b=this.Ib;Bd(this.a)>0&&this.a.Wa<b;)switch(this.vb()){case 15:var c=this.co();c!=null&&a.Cd(c);break;default:this.Ea()}return a};this.co=function(){var a=new kd;a.g=this.xc();for(var b=this.Ib;Bd(this.a)>0&&this.a.Wa<b;)switch(this.vb()){case 11:a.m=this.ao();break;case 16:for(var c=Math.floor(this.zj/2),d=0;d<c;++d)a.T.push(Ed(this.a,2));break;case 17:c=Math.floor(this.zj/36);for(d=0;d<c;++d){var e=new Nb;
e.f=this.U();e.j=this.U();e.na=U(this.a);e.ta=this.ii();e.ud=new Na;a.k.push(e)}break;case 18:c=Math.floor(this.zj/44);for(d=0;d<c;++d){e=new Nb;e.f=this.U();e.j=this.U();e.na=U(this.a);e.ta=this.ii();e.ud=this.ii();a.k.push(e)}break;case 19:c=this.zj/60;a.de=[];a.Gd=[];for(d=0;d<c;++d){e=new Nb;e.f=this.U();e.j=this.U();e.na=U(this.a);e.ta=this.ii();e.ud=new Na;a.de.push(this.U());a.Gd.push(this.U());a.k.push(e)}break;default:this.Ea()}return a};this.ao=function(){var a=new dd;a.h=U(this.a);U(this.a);
U(this.a);U(this.a);U(this.a);V(this.a);U(this.a);U(this.a);R(this.a);R(this.a);a.Qb=R(this.a);a.Re=R(this.a);Dd(this.a,1);a.Ed=R(this.a);R(this.a);R(this.a);R(this.a);for(var b=0;b<4;++b){var c=this.td();switch(b){case 0:a.pa=c;break;case 1:a.yc=c;break}R(this.a);R(this.a);R(this.a);if(Ed(this.a,2)!=0)switch(b){case 0:a.Zb=true;break;case 1:break}}return a};this.mm=function(){return this.R()};this.nm=function(){var a=this.kk+this.mm();return he(n.je,a,true)};this.td=function(){var a=this.mm(),b=
this.kk+a;if(this.Ia!=null&&a!="")return vd(this.Ia,b,true);return null};this.Lr=function(a){var b=this.Ib;a.g=this.xc();a.ar=U(this.a);for(a.lq=U(this.a);Bd(this.a)>0&&this.a.Wa<b;)switch(this.vb()){case 3:this.Or(a);break;default:this.Ea()}};this.Or=function(a){var b=this.Ib;a.caption=this.R();a.Vg=this.td();this.ii();U(this.a);a.Es=this.R();for(a.Ms=R(this.a);Bd(this.a)>0&&this.a.Wa<b;)switch(this.vb()){case 6:a.As=true;a.Gs=this.R();break;case 4:a.Bs=true;a.Qk=this.R();break;case 5:a.Cs=true;
a.Ns=this.R();a.Os=this.R();break;default:this.Ea()}};this.Kr=function(a){a.g=this.xc();a.ha=this.U();a.zb=this.U();a.qd=V(this.a);a.Sc=V(this.a);a.$g=V(this.a);a.Zg=V(this.a);a.Gc=R(this.a);uf(a)};this.Tr=function(a){U(this.a);a.Cn=U(this.a);a.Hk.c=V(this.a);a.Hk.b=V(this.a);a.Jo=V(this.a);a.Io=V(this.a);a.Mi=U(this.a);a.yn=R(this.a);a.Co=U(this.a);this.gn(a)};this.Mr=function(a){a.g=this.xc();if(U(this.a)==2)a.Ra.og=true;a.Ra.na=this.lm();this.lm();R(this.a);a.Ra.Na=this.U();var b=V(this.a);a.Ra.Ka=
b;if(b!=0)a.Ra.vh=1/b};this.Jr=function(a){a.tc.g=this.xc();a.g=a.tc.g;a.yi=V(this.a);a.Rg=V(this.a);var b=Dd(this.a,1);a.Nh=(b&2)!=0};this.Hr=function(a){a.g=this.xc();a.Ub=this.nm();a.Ae=V(this.a);a.Sh=V(this.a);a.Vn=U(this.a);a.hq=R(this.a);a.Qn=U(this.a);a.Hl=U(this.a);a.Yg=V(this.a);a.Bg=R(this.a);U(this.a)};this.Nr=function(a){a.g=this.xc();a.Xg=V(this.a);a.of=R(this.a);U(this.a);for(var b=U(this.a),c=0;c<b;++c)a.Jb.push(this.U())};this.Pr=function(a){a.Na=this.U();a.sd=U(this.a);a.$b=this.U();
a.sf=U(this.a);a.Th=U(this.a);a.Uh=U(this.a);a.vg=U(this.a);a.Zj=U(this.a);a.bk=U(this.a);a.$j=U(this.a);a.wg=V(this.a);a.xg=V(this.a);a.tg=V(this.a);a.Vh=V(this.a);var b=U(this.a);if(b&1){a.Gh=true;a.Hh=U(this.a);a.Jj=U(this.a)}else a.Gh=false;if(b&2){a.mg=true;a.Nj=U(this.a);a.Pd=this.U()}else a.mg=false;if(b&4){a.Gg=true;a.tk=V(this.a);a.uk=V(this.a)}else a.Gg=false};this.Fr=function(a){U(this.a);a.$d=R(this.a);if(a.$d){a.wf=U(this.a);a.xf=U(this.a);a.Lf=U(this.a);a.Kf=U(this.a)}else{a.yf=V(this.a);
a.zf=V(this.a);a.Nf=V(this.a);a.Mf=V(this.a)}a.Qg=R(this.a);a.Tc=U(this.a);a.La=this.td();a.Me=this.td();a.Fg=R(this.a);a.jg=this.td();a.Pj=U(this.a);if(a.Pj==1)a.Vc=U(this.a)};this.Gr=function(a){if(U(this.a)&1)a.fl=true;a.$d=R(this.a);if(a.$d){a.wf=U(this.a);a.xf=U(this.a);a.Lf=U(this.a);a.Kf=U(this.a)}else{a.yf=V(this.a);a.zf=V(this.a);a.Nf=V(this.a);a.Mf=V(this.a)}a.Qg=R(this.a);a.Tc=U(this.a);a.La=this.td();a.Me=this.td();a.Fg=R(this.a);a.kf=R(this.a);a.Tg=Dd(this.a,1);a.hb=this.R();a.pd=this.R();
a.Pf=U(this.a);a.sh=R(this.a);a.Wl=R(this.a);a.Oj=U(this.a);a.ai=R(this.a);a.Lh=U(this.a);a.$h=R(this.a)};this.Gq=function(a,b){if(a){var c=null;switch(U(this.a)){case 100:b=new ac;b.He=this.U();c=b;break;case 101:b=new Xb;b.ca=this.U();b.S=this.U();b.wd=U(this.a);b.dc=R(this.a);Yb(b);c=b;break;case 102:b=new Wg;b.xh=this.U();b.Na=this.U();b.Ka=V(this.a);b.zi=V(this.a);b.ib();c=b;break;case 103:b=new Xg;b.Ka=this.U();V(this.a);b.oj=!n.F(V(this.a),0);V(this.a);b.Sf=this.U();c=U(this.a);U(this.a);U(this.a);
if(c&1)b.Ek=true;b.Lb=V(this.a);c=b;break;case 104:b=new df(a,this.Y);b.ug=V(this.a);b.Rb=V(this.a);b.fc=V(this.a);b.xe=V(this.a);b.De=R(this.a);c=U(this.a);if(c&1){b.Wi=false;b.gh=true}else{b.Wi=true;b.gh=false}if(c&2)b.dk=U(this.a);if(c&4)b.xn=true;if(a){b.Rp=n.$i(a.qd);b.dn=b.Rp+10;b.hs=(b.dn-b.vp)/50}c=b;break;case 105:b=new Yg(a,this.Y);b.Ka=V(this.a);b.fc=V(this.a);b.De=R(this.a);c=U(this.a);if(c&2){b.to=true;b.Lb=V(this.a)}if(c&4){b.un=true;b.Ce=V(this.a);b.ze=V(this.a);b.Pi=V(this.a)}c=b;
break;case 106:var d=new Zg(b);d.Hi=U(this.a);d.Yj=R(this.a);d.di=this.R();d.gk=R(this.a);d.df=this.U();d.lg=Dd(this.a,1);d.wh=this.R();c=U(this.a);if(c&1)d.Fi=U(this.a);if(d.lg==3||d.lg==4)d.s=this.nb(b);c=d;break;case 107:c=new yc(b,this.Y);c.hf=R(this.a);c.Jc=R(this.a);U(this.a);c.s=this.nb(b);c=c;break;case 108:d=new $g(b);d.Eh=U(this.a);d.nk=U(this.a);d.hi=V(this.a);d.Mg=U(this.a);c=U(this.a);if(c&1){d.vn=1;d.km=this.U()}d.s=this.nb(b);c=d;break;case 109:b=new ah;b.vd=U(this.a);b.Rf=U(this.a);
b.Ug=U(this.a);b.dc=R(this.a);c=U(this.a);b.Ma=[];for(d=0;d<c;++d)b.Ma.push(this.td());c=b;break;case 110:c=new bh(b,this.Y);c.hf=R(this.a);c.Jc=R(this.a);U(this.a);c.re=this.nb(b);c.pe=this.nb(b);c=c;break;case 111:c=new ch(b);c.Wg=U(this.a);U(this.a);c.s=this.nb(b);c=c;break;case 112:c=new dh(b,this.Y);c.rg=U(this.a);c.Vc=U(this.a);c.ps=R(this.a);U(this.a);c.s=this.nb(b);c=c;break;case 113:d=new eh(b);d.kd=U(this.a);d.Wd=V(this.a);d.ph=V(this.a);d.gg=R(this.a);d.bc=U(this.a);d.Bk=this.R();d.uh=
this.R();d.ei=V(this.a);d.mi=U(this.a);d.Db=this.U();d.ce=this.R();d.he=this.R();d.Fj=this.R();d.qj=this.R();if(d.kd==3)d.ci=U(this.a);c=U(this.a);if(c&1)d.Ag=U(this.a);else{d.Ag=1E4;if(d.Wd!=0)d.Ag=d.ei/(d.Wd/1E3)}d.ld=this.nb(b);d.ne=this.nb(b);d.qe=this.nb(b);d.oe=this.nb(b);c=d;break;case 114:b=new fh;b.ni=U(this.a);b.Db=this.U();b.Lj=U(this.a);b.ve=V(this.a);b.Ck=V(this.a);c=U(this.a);b.Jc=c&1?true:false;c=b;break;case 115:b=new gh(b,this.Y);U(this.a);b.sk=V(this.a);b.Rb=V(this.a);b.fc=V(this.a);
b.xe=V(this.a);b.Db=this.U();b.ce=this.R();b.he=this.R();b.Sj=this.R();b.rk=this.R();c=U(this.a);if(c&1)b.Hj=true;if(c&2){b.Ii=true;b.lj=V(this.a);b.kg=V(this.a)}if(c&4)b.fm=true;c=b;break;case 116:c=new hh(b);c.$p=R(this.a);U(this.a);c.s=this.nb(b);c=c;break;case 117:c=new n.ef(b);c.cc=this.R();U(this.a);this.$n(c.vc,b);c=c;break;default:this.Ea();return}c&&Zb(a,c)}else this.Ea()};this.$n=function(a,b){for(var c=U(this.a),d=0;d<c;++d){var e=new ih;e.h=U(this.a);e.n=this.R();switch(e.h){case 1:e.pc=
V(this.a);break;case 2:e.cd=this.R();break;case 6:e.Uf=this.U();break;case 7:e.Di=this.td();break;case 9:e.oh=this.nb(b);break;case 0:case 4:case 5:case 8:case 3:default:e.rc=U(this.a);break}a.push(e)}};this.nb=function(a){if(U(this.a)){var b=new Rc(a);this.Eq(b,a);return b}return null};this.Eq=function(a,b){var c=this.vb();if(c!=29)this.Ea();else for(var d=this.Ib;Bd(this.a)>0&&this.a.Wa<d;){c=this.vb();if(c==30)(c=this.Dq(U(this.a),b))&&Sc(a,c);else this.Ea()}};this.Er=function(){for(var a=this.Ib;Bd(this.a)>
0&&this.a.Wa<a;)switch(this.vb()){case 13:var b=U(this.a),c=this.R(),d=U(this.a);if(b&4){if(b=od(this.Ne,c))b.za.length>0||b.db.length>0?this.Ea():this.Sr(b,d)}else if(b&8){b=null;try{b=this.Gp(d)}catch(e){ja(n.va,"error reading script: "+e)}if(b!=null){d=Z();jh(d,b)}}this.Ea();break;default:this.Ea()}};this.Ir=function(a){a.g=this.xc();R(this.a);U(this.a);var b=U(this.a),c=U(this.a);a.Fb=V(this.a);Dd(this.a,1);a.ec=R(this.a);var d=U(this.a);if(d==0){a.nd=250;a.se=true}else if(d&1){a.nd=U(this.a);
a.se=a.nd>0}a.Mp(this.Fq(a));a.Za=b;a.yb=c;if(d&2){b=U(this.a);for(c=0;c<b;++c){d=new n.lo;d.fk=U(this.a);d.pg=U(this.a);a.Eb.push(d)}}};this.Fq=function(a){var b=this.mm(),c=od(this.Ne,b);if(c==null){c=new n.ym;c.n=b;c!=null&&this.Ne.Gl.push(c);c=c}if(a!=null&&c!=null){if(c.Dd==null)c.Dd=[];c.Dd.push(a)}return c};this.Sr=function(a,b){if(a!=null){var c=U(this.a);a.ml=V(this.a);if(c&1)a.Ai=this.xc();c=this.Ib;b=this.a.Wa+b;for(var d=[],e=0;Bd(this.a)>0&&this.a.Wa<c&&this.a.Wa<b;){var f=this.vb();
if(f==33){f=new n.Oq;f.n=this.R();f.Rh=this.bo();f.Kh=this.bo();a.za.push(f);e=U(this.a);d.push(f);e>=0&&e<d.length&&d[e].ba.push(f);e=U(this.a);for(var g=0;g<e;++g)f.th.push(U(this.a));g=U(this.a);for(e=0;e<g;++e){var h=new n.Pq;h.frame=V(this.a);h.position=this.U();f.Af.push(h)}g=U(this.a);for(e=0;e<g;++e){h=new n.Rq;h.frame=V(this.a);h.scale=this.U();f.Ie.push(h)}g=U(this.a);for(e=0;e<g;++e){h=new n.Qq;h.frame=V(this.a);h.rotation=this.Jq();f.Ef.push(h)}g=U(this.a);for(e=0;e<g;++e){h=new n.Sq;
h.Qi=Ed(this.a,2);h.ij=U(this.a);h.fj=V(this.a);f.Vf.push(h)}}else if(f==15){f=this.co();f!=null&&a.Cd(f)}else if(f==34){f=new n.Yh;f.n=this.R();f.Fd=V(this.a);f.S=V(this.a);f.Mc=V(this.a);a.Ol.push(f)}else this.Ea()}try{a.yl=-1;a.pq=-1;b=c=0;var j,m;for(d=0;d<a.za.length;++d){f=false;for(c=0;c<a.za.length;++c){m=a.za[c];for(e=0;e<m.ba.length;++e)if(m.ba[e]===a.za[d])f=true}f||a.Df.push(a.za[d])}for(c=0;c<a.db.length;++c){d=[];a.Gk.push(d);j=a.db[c];var o=j.k.length;for(f=0;f<o;++f)d.push(false)}a.Qd=
false;d=o=0;var p,i;for(o=0;o<a.za.length;++o){i=a.za[o];if(i.Af.length||i.Ie.length||i.Ef.length||i.Vf.length){a.Qd=true;break}}if(a.Qd)for(o=a.md=0;o<a.za.length;++o){i=a.za[o];if(i.Af.length){var v=i.Af[i.Af.length-1];if(v.frame>a.md)a.md=v.frame}if(i.Ie.length){var r=i.Ie[i.Ie.length-1];if(r.frame>a.md)a.md=r.frame}if(i.Ef.length){var E=i.Ef[i.Ef.length-1];if(E.frame>a.md)a.md=E.frame}}if(a.Qd&&!a.Xn){a.Xn=true;for(o=0;o<a.za.length;++o){i=a.za[o];for(d=0;d<i.Vf.length;++d){var z=i.Vf[d],u=z.ij;
p=a.db[z.Qi];var y=p.k[u];z.wo=y.f.e();z.vo=y.j.e()}}}pd(a,null,null);for(c=0;c<a.za.length;++c){m=a.za[c];for(b=0;b<m.th.length;++b){j=a.db[m.th[b]];j.Oe=m.lf.e()}}if(a.db.length==0){a.xb.D.set(0,0,0);a.xb.N.set(0,0,0)}else{j=a.db[0];a.xb.D=j.g.D.e();a.xb.N=j.g.N.e();for(c=1;c<a.db.length;++c){j=a.db[c];if(j.Oe==null){C(a.xb,j.g.D);C(a.xb,j.g.N)}else{var D=j.g.e();yb(j.Oe,D);C(a.xb,D.D);C(a.xb,D.N)}}}}catch(H){ja(n.va,"error finalizing skinned mesh: "+H)}if(a.Dd&&a.Dd.length){for(e=0;e<a.Dd.length;++e)(j=
a.Dd[e])&&Xf(j,j.Za,j.yb);a.Dd=null}}};this.Dq=function(a,b){var c=0;switch(a){case 0:c=new Vb;c.Qj=U(this.a);c.Gf=U(this.a);c.ea=R(this.a);U(this.a);return c;case 1:b=new Wb;b.Ee=U(this.a);b.Zc=U(this.a);b.ea=R(this.a);b.ka=this.U();if(b.Ee==4)b.pj=this.U();b.Cf=R(this.a);b.Yc=U(this.a);c=U(this.a);if(c&1){b.fe=true;b.dd=U(this.a)}return b;case 2:b=new $b;b.sm=U(this.a);b.Ig=U(this.a);b.ea=R(this.a);b.ka=this.U();b.qk=false;c=U(this.a);if(c&1){b.qk=true;b.Gm=U(this.a)}return b;case 3:c=new bc;c.um=
U(this.a);c.Jg=U(this.a);c.ea=R(this.a);c.ka=this.U();U(this.a);return c;case 4:c=new cc;c.vd=U(this.a);c.gc=U(this.a);c.ea=R(this.a);c.Vg=this.td();if(c.vd==1)c.tl=U(this.a);U(this.a);return c;case 5:b=new Jc;c=U(this.a);b.vf=(c&1)!=0;b.Ub=this.nm();b.Ae=V(this.a);b.Sh=V(this.a);b.Yg=V(this.a);b.Bg=R(this.a);b.$c=U(this.a);b.Cg=R(this.a);b.gm=this.U();return b;case 6:c=new Nc;c.uo=U(this.a);return c;case 7:c=new dc;U(this.a);c.wl=this.R();return c;case 8:c=new ec;U(this.a);c.Jm=this.R();c.ha=this.R();
return c;case 9:c=new fc;c.Hg=U(this.a);c.ea=R(this.a);c.dc=R(this.a);c.dl=this.R();U(this.a);return c;case 10:c=new hc(this.Y);c.Ff=this.R();U(this.a);return c;case 11:c=new mc(this.Y);c.fg=U(this.a);U(this.a);return c;case 12:b=new oc;b.Ee=U(this.a);b.Zc=U(this.a);b.ea=R(this.a);b.ka=this.U();b.Cf=R(this.a);b.Yc=U(this.a);c=U(this.a);if(c&1){b.fe=true;b.dd=U(this.a)}return b;case 13:a=new rc;a.xi=U(this.a);a.te=U(this.a);a.uj=V(this.a);a.If=U(this.a);a.ed=V(this.a);c=U(this.a);if(c&1){a.Hf=U(this.a);
a.yk=R(this.a);a.qh=this.U()}if(c&2)a.nh=this.nb(b);if(c&4)a.xk=this.U();return a;case 14:this.Ea();return null;case 15:c=new Pb;U(this.a);c.gc=U(this.a);c.ea=R(this.a);c.hb=this.R();return c;case 16:c=new Ac;U(this.a);c.Vb=this.R();c.Yl=U(this.a);c.Tf=U(this.a);c.ge=this.R();return c;case 17:a=new Hc;c=U(this.a);a.Vb=this.R();a.wj=U(this.a);a.Tf=U(this.a);a.ge=this.R();a.s=this.nb(b);if(c&1)a.Ei=this.nb(b);return a;case 18:c=new Ic;c.oi=U(this.a);c.ea=R(this.a);U(this.a);return c;case 19:c=new Oc;
U(this.a);c.Vb=this.R();c.Wj=R(this.a);return c;case 20:c=new Uc(this.Y);U(this.a);c.Ff=this.R();this.On=true;return c;case 22:c=new Xc;c.Kg=U(this.a);c.il=R(this.a);U(this.a);c.s=this.nb(b);return c;case 23:c=new Vc;c.Lg=U(this.a);c.nl=R(this.a);c.Cm=U(this.a);U(this.a);return c;case 24:c=new kh;c.cc=this.R();U(this.a);this.$n(c.vc,b);return c;case 25:a=new $c(this.Y);c=U(this.a);a.vf=(c&1)!=0;a.vj=U(this.a);a.Hm=this.R();U(this.a);a.$c=U(this.a);a.Cg=R(this.a);a.Fl=U(this.a);a.nj=this.nb(b);a.mj=
this.nb(b);return a;case 26:c=new Lc;U(this.a);c.Ub=this.nm();return c;default:this.Ea()}return null}};function lh(){this.h=-1}l=lh.prototype;l.l=k("none");l.jb=k(false);l.le=aa();l.ag=aa();l.zd=aa();l.Ye=aa();l.We=k(false);l.Xe=k(false);l.reset=aa();l.Xf=k(null);l.i=k(null);function df(a,b){this.h=-1;this.Ec=0;this.De=false;this.gh=true;this.Vi=this.Se=this.bf=this.$e=this.Ue=this.en=this.Wi=false;this.dk=0;this.fh=new s(0,0,0);this.bn=0;this.xn=true;this.hn=this.me=0;this.vp=20;this.dn=100;this.hs=(this.dn-this.vp)/50;this.Rp=90;this.Ec=q();this.Ja=a;this.Y=b;this.Td=this.Sd=-1;this.El=true;a&&qc(this,a.ha)}df.prototype=new lh;l=df.prototype;l.l=k("camerafps");l.ug=88;l.Rb=0.06;l.fc=200;l.xe=0;l.De=false;l.ak=true;function ef(a,b){a.ak=b}
function qc(a,b){if(a.Ja!=null){b=b.substract(a.Ja.f);b=Ha(b);a.me=b.c;a.hn=b.b;if(a.me>a.ug)a.me-=360}}l=df.prototype;
l.jb=function(a){if(this.Ja==null)return false;if(this.Ja.o.da!==this.Ja)return false;var b=q(),c=b-this.Ec;if(c==0)return false;if(c>250)c=250;this.Ec=b;var d=new s(0,0,0);if(this.ak&&(this.bf||this.Se)){var e=this.Ja.f.substract(this.Ja.ha);if(this.De)e.b=0;e.normalize();this.bf&&d.ua(w(e,this.Rb*-c));this.Se&&d.ua(w(e,this.Rb*c))}if(this.ak&&(this.Ue||this.$e)){e=Ga(this.Ja.f.substract(this.Ja.ha),this.Ja.zb);e.normalize();if(this.Ue){e=w(e,this.Rb*-c);d.ua(e)}if(this.$e){e=w(e,this.Rb*c);d.ua(e)}}if(this.dk!=
0){e=d.e();if(xa(e)){if(this.bn!=0&&!xa(this.fh)){e=b-this.bn;if(e>0&&e<this.dk){e=this.fh.getLength()*(1-e/this.dk)*c;var f=this.fh.e();f.normalize();A(f,e*0.5);d.ua(f)}else this.fh.set(0,0,0)}}else{this.fh=e;A(this.fh,1/c);this.bn=b}}d.normalize();A(d,c*this.Rb);this.Ja.f.ua(d);pc(this.Ja,this.Ja.ha.add(d));d=new s(0,0,1);e=new I;ub(e,new s(this.me,this.hn,0));lb(e,d);e=false;if(this.Y!=null)e=this.Y.Ze;var g=0;var h=f=2.0E-5,j=false;if(this.Y!=null&&a.o!=null&&!e){j=a.o;j=j.Ua==null||j.Pb==null?
null:Cg(j,j.Ua,this.Y.Nc,this.Y.Oc,true);j=j!=null}if(this.gh){f*=3;h*=3}if(!j)if(e)g=this.Y.Ml;else if(this.Wi){var m=this.Y.O.Mb(),o=this.Y.Oc;if(m>0&&o>0&&this.Y.Xh)g=Math.sin((o-m/2)/m)*100*0.5}else if(this.gh||this.en)if(this.Y.Wh){m=this.Y.Oc;g=this.Td==-1?0:m-this.Td;if(g!=0)this.Y.Al=b;this.Td=m}else this.Td=-1;g+=0;c=c;if(c>100)c=100;if(g>300)g=300;if(g<-300)g=-300;this.me+=g*c*this.fc*h;if(this.me<-this.ug)this.me=-this.ug;if(this.me>this.ug)this.me=this.ug;g=0;if(!j)if(e)g=this.Y.Ll;else if(this.Wi){b=
this.Y.O.Nb();h=this.Y.Nc;if(b>0&&h>0&&this.Y.Xh)g=Math.sin((h-b/2)/b)*100*0.5}else if(this.gh||this.en)if(this.Y.Wh){h=this.Y.Nc;g=this.Sd==-1?0:h-this.Sd;if(g!=0)this.Y.Al=b;this.Sd=h}else this.Sd=-1;g+=0;if(g>300)g=300;if(g<-300)g=-300;this.hn+=g*c*this.fc*f;if(e||this.gh||this.en)kf(this.Y);if(this.ak)if(this.Vi){if(this.El)if((a=N(a,"collisionresponse"))&&!a.ue){this.El=false;if(a.Rd==0)a.Rd=this.xe*100}}else this.El=true;pc(this.Ja,this.Ja.f.add(d));return false};
l.le=function(a){lh.prototype.le.call(this,a);this.Wi&&this.Y.Cr&&!this.Y.Ze&&this.Y.Xk()};l.ag=aa();l.zd=function(a){lh.prototype.zd.call(this,a)};l.Ye=function(a){lh.prototype.Ye.call(this,a)};l.bj=function(a,b){if(b==37||b==65){if(this.Ue=a)this.$e=false;return true}if(b==39||b==68){if(this.$e=a)this.Ue=false;return true}if(b==38||b==87){if(this.bf=a)this.Se=false;return true}if(b==40||b==83){if(this.Se=a)this.bf=false;return true}if(b==32){this.Vi=a;return true}return false};
l.We=function(a){return this.bj(true,a.keyCode)};l.Xe=function(a){return this.bj(false,a.keyCode)};function Yg(a,b){this.h=-1;this.fc=1E4;this.Ka=100;this.De=false;this.Ec=q();this.Ja=a;this.Y=b;this.to=false;this.be=this.ae=this.Lb=0;this.un=false;this.Pi=this.ze=this.Ce=0;this.Qc=90;this.Sl=-66666;this.Td=this.Sd=-1}Yg.prototype=new lh;l=Yg.prototype;l.l=k("cameramodelviewer");l.fc=0.06;l.Ka=100;l.De=false;
l.jb=function(){if(this.Ja==null)return false;if(this.Ja.o.da!==this.Ja)return false;var a=q(),b=a-this.Ec;if(b>250)b=250;this.Ec=a;a=this.Ja.f.e();var c=this.Ja.ha.e(),d=c.substract(O(this.Ja)),e=0,f=0;if(this.Y.Wh){var g=this.Y.Nc,h=this.Y.Oc;e=(this.Sd==-1?0:g-this.Sd)*this.fc/5E4;f=(this.Td==-1?0:h-this.Td)*this.fc/5E4;this.Sd=g;this.Td=h}else this.Td=this.Sd=-1;if(this.to&&this.Lb!=0){if(n.ya(e)){e=this.ae;this.ae*=0.9;if(this.ae>0)this.ae=Math.max(0,this.ae-b/this.Lb);else if(this.ae<0)this.ae=
Math.min(0,this.ae+b/this.Lb)}else this.ae=e*(this.Lb/1E3);if(n.ya(f)){f=this.be;this.be*=0.9;if(this.be>0)this.be=Math.max(0,this.be-b/this.Lb);else if(this.be<0)this.be=Math.min(0,this.be+b/this.Lb)}else this.be=f*(this.Lb/1E3)}d=Ga(d,this.Ja.zb);d.b=0;d.normalize();if(!n.ya(e)){A(d,b*e);a.ua(d)}if(!this.De&&!n.ya(f)){e=this.Ja.zb.e();e.normalize();b=a.add(w(e,b*f));f=b.e();f.b=c.b;e=this.Ka/10;if(f.Cb(c)>e)a=b}if(this.De){if(n.F(this.Sl,-66666))this.Sl=a.b;a.b=this.Sl}kf(this.Y);if(this.un){b=
n.$i(this.Ja.qd);if(this.Qc<this.Ce)this.Qc=this.Ce;if(this.Qc>this.ze)this.Qc=this.ze;f=this.Pi;f=Math.abs(this.Qc-b)/8;if(f<this.Pi)f=this.Pi;if(b<this.ze-f&&b<this.Qc){b+=f;if(b>this.ze)b=this.ze}if(b>this.Ce+f&&b>this.Qc){b-=f;if(b<this.Ce)b=this.Ce}vf(this.Ja,n.Vo(b))}d=a.substract(c);ua(d,this.Ka);a=c.add(d);this.Ja.f=a;return false};l.ag=function(a){this.Qc+=a*this.Pi;if(this.Qc<this.Ce)this.Qc=this.Ce;if(this.Qc>this.ze)this.Qc=this.ze};function Zg(a){this.Hi=5E3;this.Yj=this.ul=this.Bo=false;this.gk=true;this.Fi=0;this.Dl=true;this.lg=mh;this.Ak=false;this.Vd=a;this.Va=0;this.Bo=false;this.Yd=this.Uj=null;this.Ak=false;this.di=null;this.Fi=0;this.wh=this.df=null;this.Ln=0;this.Mo=false}Zg.prototype=new lh;var mh=0;Zg.prototype.l=k("followpath");
Zg.prototype.i=function(a,b,c,d){a=new Zg;a.Hi=this.Hi;a.Yj=this.Yj;a.gk=this.gk;a.di=this.di;a.Fi=this.Fi;a.df=this.df?this.df.e():null;a.lg=this.lg;a.wh=this.wh;a.s=this.s?this.s.i(c,d):null;return a};
Zg.prototype.jb=function(a,b){if(a==null||!this.Vd||!this.Hi)return false;if(a!==this.Uj){if(this.Uj=a)this.ul=this.Uj.l()=="camera";return false}if(!this.Yd)if(!this.Bo)if(this.di.length)if(this.Vd){var c=vg(this.Vd,this.di);c&&c.l()=="path"&&nh(this,c)}if(this.Yd==null)return false;c=false;var d=null;if(this.ul&&this.gk){c=!this.Dl;d=a;if(this.Vd.da!==d){if(this.Yd.Jb.length)d.f=Lf(this.Yd,0);this.Dl=true;return false}else this.Dl=false;if(!this.Va||!c)this.Va=b}if(!this.Va)this.Va=this.Vd.Va;d=
(b-this.Va+this.Fi)/this.Hi;if(d>1&&!this.Yd.of)switch(this.lg){case mh:d%=1;break;case 1:d=1;break;case 2:d=1;if(!this.Ak){if(this.Vd)if(this.wh.length)if((c=vg(this.Vd,this.wh))&&c.l()=="camera"){(b=this.Vd.Pb)&&af(c,b.Nb(),b.Mb());this.Vd.da=c}this.Ak=true}break;case 3:if(d>this.Ln+1&&this.s!=null){this.s.execute(a);this.Ln=d}d%=1;break;case 4:d=1;if(!this.Mo&&this.s!=null){this.s.execute(a);this.Mo=true}break}else this.Ak=false;b=Nf(this.Yd,d);c=!b.F(a.f);a.f=b;if(this.Yj&&this.Yd.Jb.length){d=
Nf(this.Yd,d+0.001);if(!n.ya(d.Cb(b))){var e=d.substract(b);ua(e,100);if(this.ul){d=a;a=b.add(e);c=c||!a.F(d.ha);pc(d,a)}else{if(!this.df||xa(this.df))d=Ha(e);else{d=new I;ub(d,Ha(e));b=new I;ub(b,this.df);d=K(d,b);d=vb(d)}c=c||!d.F(a.V);a.V=d}}}return c};function nh(a,b){a.Yd=b}Zg.prototype.Xf=function(a){if(this.s)return Tc(this.s,a);return null};function Xb(a,b,c,d,e,f){this.ca=new s(0,0,0);this.S=new s(40,40,40);this.Va=q();this.wd=3E3;this.yo=this.rh=this.Bh=this.dc=false;this.ro=null;this.qo=0;this.dg=this.Ej=false;this.Fh=0;if(a)this.ca=a.e();if(b)this.S=b.e();if(c)this.wd=c;if(d)this.dc=d;Yb(this);if(e)this.Bh=e;if(f)this.rh=f}Xb.prototype=new lh;Xb.prototype.l=k("flystraight");
Xb.prototype.i=function(a,b,c,d){a=new Xb;a.ca=this.ca.e();a.S=this.S.e();a.ka=this.ka.e();a.Im=this.Im;a.Dm=this.Dm;a.wd=this.wd;a.dc=this.dc;a.rh=this.rh;a.Ej=this.Ej;a.dg=this.dg?this.dg.i(c,d):null;a.Fh=this.Fh;return a};
Xb.prototype.jb=function(a,b){var c=b-this.Va,d=false;if(c!=0){var e=this.ca.e();if(!this.dc&&c>=this.wd){e=this.S.e();d=true}else e.ua(w(this.ka,c%this.wd*this.Dm));if(this.rh){if(a.l()=="camera"){pc(a,e);var f=N(a,"camerafps");f!=null&&qc(f,e)}}else a.f=e;if(this.yo&&this.Va!=b){if(a){P(a);b=pf(a);e=false;f=sc(a.o,"gameai");for(var g=0;g<f.length;++g)if(f[g]!==this.ro){var h=N(f[g],"gameai");if(!(h&&!(h.bc>0)))if(Sa(b,pf(f[g]))){wc(h,this.qo,f[g]);e=true;break}}b=e}else b=false;d=b||d}if(d){if(a.o)a.o.zl=
a.f.e();if(this.dg){d=true;if(this.Fh>0&&c>this.Fh)d=false;d&&this.dg.execute(a)}this.Bh&&rf(a,this);this.Ej&&a.o&&Wc(a.o,a,0)}return true}return false};function Yb(a){a.ka=a.S.substract(a.ca);a.Im=a.ka.getLength();a.ka.normalize();a.Dm=a.Im/a.wd};function Wg(a,b,c,d){this.xh=new s;this.Na=new s(0,1,0);this.Ki=new s;this.Pe=new s;this.Va=q();this.zi=0.01;this.Ka=100;if(a)this.xh=a.e();if(b)this.Ka=b;if(c)this.Na=c.e();if(d)this.zi=d;this.ib()}Wg.prototype=new lh;Wg.prototype.l=k("flycircle");Wg.prototype.i=function(){var a=new Wg;a.xh=this.xh.e();a.Na=this.Na.e();a.Ki=this.Ki.e();a.Pe=this.Pe.e();a.zi=this.zi;a.Ka=this.Ka;return a};
Wg.prototype.jb=function(a,b){b=b-this.Va;if(b!=0){b=b*this.zi;b=w(this.Ki,Math.cos(b)).add(w(this.Pe,Math.sin(b)));A(b,this.Ka);a.f=this.xh.add(b);return true}return false};Wg.prototype.ib=function(){this.Na.normalize();this.Pe=this.Na.b!=0?new s(50,0,0):new s(0,50,0);this.Pe=Ga(this.Pe,this.Na);this.Pe.normalize();this.Ki=Ga(this.Pe,this.Na);this.Ki.normalize()};function ac(a){this.He=new s;if(a)this.He=a.e();this.Va=q();this.jo=false;this.rm=0;this.wn=null}ac.prototype=new lh;ac.prototype.l=k("rotation");ac.prototype.i=function(){var a=new ac(this.Ba,this.Xa);a.He=this.He.e();a.Va=this.Va;return a};
ac.prototype.jb=function(a,b){var c=b-this.Va;if(this.jo){if(this.rm-this.Va==0)return false;b=(b-this.Va)/(this.rm-this.Va);if(b>1){a.V=this.He.e();rf(a,this)}else{c=new zb;var d=w(this.He,n.Nd);Fb(c,d.c,d.b,d.d);var e=new zb;d=w(this.wn,n.Nd);Fb(e,d.c,d.b,d.d);Cb(e,e,c,b);d=new s;Eb(e,d);A(d,n.Fe);a.V=d;return true}}else if(c!=0){a.V.ua(w(this.He,c/10));this.Va=b;return true}return false};function ah(a,b,c){this.Ma=[];this.dc=true;this.Rf=20;this.Nl=this.Ug=this.vd=0;if(a)this.Ma=a;if(b)this.Rf=b;if(c==true)this.loop=false}ah.prototype=new lh;ah.prototype.l=k("animatetexture");ah.prototype.i=function(){var a=new ah;a.Ma=this.Ma;a.dc=this.dc;a.Rf=this.Rf;a.vd=this.vd;a.Ug=this.Ug;return a};
ah.prototype.jb=function(a,b){if(a==null||this.Ma==null)return false;var c=false,d=null;if(this.Ma.length){var e=this.Nl==0?a.o.Va:this.Nl;d=b-e;var f=e+this.Rf*this.Ma.length;e=0;e=!this.dc&&b>=f?this.Ma.length-1:this.Rf>0?Math.floor(d/this.Rf%this.Ma.length):0;if(e<this.Ma.length)if(this.vd==1){if(this.Ug>=0&&this.Ug<a.hd())if((d=a.Cc(this.Ug))&&d.pa!==this.Ma[e]){d.pa=this.Ma[e];c=true}}else{b=a.hd();for(f=0;f<b;++f)if((d=a.Cc(f))&&d.pa!==this.Ma[e]){d.pa=this.Ma[e];c=true}}}return c};
ah.prototype.reset=function(){this.Nl=q()};function yc(a,b,c,d){this.Xa=b;this.Yq=0;this.Lq=false;this.rs=null;this.Ba=a;this.Jh=c;this.qf=false;this.hf=true;this.Jc=false;this.ee=this.ja=this.s=null;d!=true&&xg(a,this)}yc.prototype=new lh;l=yc.prototype;l.l=k("onclick");l.i=function(a,b,c,d){a=new yc(this.Ba,this.Xa);a.hf=this.hf;a.Jc=this.Jc;a.s=this.s?this.s.i(c,d):null;a.ja=this.ja;return a};l.jb=function(a){this.ee=a;a=this.qf;this.qf=false;return a};
l.zd=function(a){var b=this.ee;if(!b)return false;if(b.o!==this.Ba)return false;if(q()-this.Xa.Al<250)return false;var c=hf(this.Xa,a);a=jf(this.Xa,a);if(this.Xa.Ze){a=this.Ba.Pb;if(!a)return false;c=a.Nb()/2;a=a.Mb()/2}if(this.ee.mb==null){this.ee=null;return false}if(sf(b)&&oh(this,b,c,a)){this.qf=true;this.Jh&&this.Jh();this.Vk(b);Ne(this.Ba);return true}};l.Vk=function(a){this.s&&this.s.execute(a)};
function oh(a,b,c,d){if(b==null)return false;if(b.l()=="2doverlay"){var e=Sf(b,false,a.Xa.O);if(e.x<=c&&e.y<=d&&e.x+e.$a>=c&&e.y+e.Ya>=d)return true}c=lf(a.Xa,c,d);if(c==null)return false;d=a.Ba.da;if(d==null)return false;d=O(d);e=new La;e.ca=d;e.S=c;return zc(a,a.Ba,b,e,a.hf,a.Jc,a.ja,null)}function xc(a,b,c,d,e,f){if(!e||!b)return 999999999999;if(a=e.ah(c,d,true,null,f))return c.Cb(a);return 999999999999}
function zc(a,b,c,d,e,f,g,h){var j=c.ob(),m=0;m=new I(false);if(nb(c.aa,m))if(Ra(j,kb(m,d.ca),kb(m,d.S))){m=null;if(c.ur&&c.Q)m=c;e=m==null||e;if(!e){j=m.gb;if(j==null){j=m.Q&&nd(m.Q)>100?new zg(m.Q,m,0):new Ag(m.Q,m);m.gb=j}if(j){j=j.ah(d.ca,d.S,true,null,true);if(j!=null)if(f){m=xc(a,b,d.ca,j,g,true);a=j.Cb(d.ca);if(m+n.Wq<a)return false;else{if(h!=null)h.Sa=j.Cb(d.ca);return true}}else{if(h!=null)h.Sa=d.ca.Cb(Oa(pf(c)));return true}}else e=true}if(e)if(f){d=d.ca.e();j=pf(c);m=Pa(j);A(m,0.5);f=
n.Br(m.c,m.b,m.d);f=Math.sqrt(f*f+f*f);c=Oa(pf(c));m=xc(a,b,d,c,g,true);a=c.Cb(d)-f;if(m<a)return false;else{if(h!=null)h.Sa=a;return true}}else{if(h!=null)h.Sa=d.ca.Cb(Oa(pf(c)));return true}}return false}yc.prototype.Xf=function(a){if(this.s)return Tc(this.s,a);return null};function bh(a,b){this.Xa=b;this.Ba=a;this.re=this.pe=null;this.Mm=this.Em=0}bh.prototype=new yc(null,null,null,true);bh.prototype.l=k("onmove");bh.prototype.i=function(a,b,c,d){a=new bh(this.Ba,this.Xa);a.hf=this.hf;a.Jc=this.Jc;a.s=this.s?this.s.i(c,d):null;a.ja=this.ja;a.pe=this.pe?this.pe.i(c,d):null;a.re=this.re?this.re.i(c,d):null;return a};
bh.prototype.jb=function(a){var b=this.Em==0,c=q();if(b||c-this.Em>100){this.Em=c;c=oh(this,a,this.Xa.Nc,this.Xa.Oc);if(b)this.Mm=c;else if(c!=this.Mm){if((this.Mm=c)&&this.pe)this.pe.execute(a);else!c&&this.re&&this.re.execute(a);return true}}return false};bh.prototype.Xf=function(a){var b=null;if(this.re)if(b=Tc(this.re,a))return b;if(this.pe)if(b=Tc(this.pe,a))return b;return null};function $g(a,b,c,d,e){this.Yq=0;this.Yk=a;this.hi=this.vn=this.nk=this.Eh=0;this.km=null;this.Mg=0;this.s=null;this.Jh=d;if(b)this.hi=b;if(c)this.Mg=c;if(e)this.Eh=1;this.vl=false}$g.prototype=new lh;l=$g.prototype;l.l=k("oncollide");l.i=function(a,b,c,d){a=new $g(this.Yk);a.Eh=this.Eh;a.nk=this.nk;a.hi=this.hi;a.Mg=this.Mg;a.s=this.s?this.s.i(c,d):null;return a};
l.jb=function(a){if(a==null||this.Yk==null)return false;var b=false,c=null;if(this.nk==0)c=this.Yk.da;else if(this.Mg!=-1)c=Qb(this.Yk,this.Mg);if(c){if(a===c)return false;var d=O(c),e=O(a),f=false;switch(this.vn){case 0:f=d.Cb(e)<this.hi;break;case 1:e=new I(false);if(nb(a.aa,e)){d=d.e();lb(e,d);f=new B;f.D=w(this.km,-0.5);f.N=w(this.km,0.5);f=f.eh(d)}}switch(this.Eh){case 0:if(f&&!this.vl){this.Vk(c,a);b=true}break;case 1:if(!f&&this.vl){this.Vk(c,a);b=true}break}this.vl=f}return b};
l.Vk=function(a,b){this.Jh&&this.Jh.call(a,b);this.s&&this.s.execute(a)};l.Xf=function(a){if(this.s)return Tc(this.s,a);return null};function Xg(a,b,c,d){this.Ka=a;this.oj=true;this.Sf=b;this.ja=c;this.Lb=d;this.Do=false;this.pf=this.Da=null;this.ye=new s(0,0,0);this.ue=false;this.Rd=this.Fn=0;this.Ek=false;if(this.Ka==null)this.Ka=new s(30,50,30);if(this.Sf==null)this.Sf=new s(0,0,0);if(this.Lb==null)this.Lb=5.0E-4;this.reset()}Xg.prototype=new lh;l=Xg.prototype;l.l=k("collisionresponse");l.i=function(){var a=new Xg;a.Ka=this.Ka.e();a.oj=this.oj;a.Sf=this.Sf.e();a.ye=this.ye.e();a.Ek=this.Ek;a.ja=this.ja;return a};
l.reset=function(){this.Da=null;this.pf=q()};l.Ob=ba("ja");
l.jb=function(a,b){var c=b-this.pf;if(!this.ja)return false;if(c>150)c=150;if(c==0)return false;this.pf=b;if(this.Da!==a){this.Da=a;this.ye=a.f.e();return false}var d=a.f.e(),e=a.f.substract(this.ye),f=new s(0,-0.1*a.o.Pd,0);if(!this.oj)f.b=0;d=w(f,c);if(this.ue){f=(b-this.Fn)/1E3;if(f>5)f=5;A(d,f)}else A(d,0.001);if(this.Rd>0){e.b+=this.Rd*0.001*c;this.Rd-=c;if(this.Rd<0)this.Rd=0}c=e.add(d);if(!xa(c)){if(!this.Do)this.Lb=this.Ka.getLength()*0.001;c=null;if(a&&a.l()=="camera")c=a;var g;if(c)g=c.ha.substract(c.f);
f=new F;var h={};h.Sa=0;this.ja.cj(a);var j=this.ja,m=this.ye.substract(this.Sf),o=this.Ka,p=this.Lb;if(!j||o.c==0||o.b==0||o.d==0)d=m;else{var i={};i.gi=m.e();i.im=e.e();i.zc=o.e();i.Xi=9.99999999E7;i.Ur=j;i.Vr=p;i.$k=0;i.Ti=new s;j=Fa(i.gi,i.zc);e=Fa(i.im,i.zc);j=ph(this,0,i,j,e);h.Sa=0;if(!xa(d)){i.gi=Ca(j,i.zc);i.im=d.e();i.$k=0;e=Fa(d,i.zc);j=ph(this,0,i,j,e);h.Sa=i.$k==0?1:0;if(h.Sa<0.5&&i.Ui){d=ab(i.Ui);d.normalize();if(!(Math.abs(d.b)>Math.abs(d.c)&&Math.abs(d.b)>Math.abs(d.d)))h.Sa=1}}if(i.$k&&
f!=null){f.X=i.Ui.X.e();f.fa=i.Ui.fa.e();f.ga=i.Ui.ga.e();Ba(f.X,i.zc);Ba(f.fa,i.zc);Ba(f.ga,i.zc)}Ba(j,i.zc);d=j}this.ja.cj(null);d.ua(this.Sf);if(h.Sa<0.5)this.ue=false;else{if(!this.ue)this.Fn=b;this.ue=true}if(a.f.F(d)){this.ye=a.f.e();return false}a.f=d.e();if(this.Ek)if(!this.ue)if(!(xa(f.X)&&xa(f.fa)&&xa(f.ga))){b=a.V.b;d=f.X.add(f.fa).add(f.ga);A(d,1/3);f.X.c-=d.c;f.X.d-=d.d;f.fa.c-=d.c;f.fa.d-=d.d;f.ga.c-=d.c;f.ga.d-=d.d;Ia(f.X,b);Ia(f.fa,b);Ia(f.ga,b);f.X.c+=d.c;f.X.d+=d.d;f.fa.c+=d.c;f.fa.d+=
d.d;f.ga.c+=d.c;f.ga.d+=d.d;b=ab(f);f=new s;f.c=Math.atan2(b.d,b.b)*n.Fe;f.b=a.V.b;f.d=-Math.atan2(b.c,b.b)*n.Fe;a.V=f}if(c&&g){b=true;for(f=0;f<a.ma.length;++f)if((d=a.ma[f])&&d.l()=="cameramodelviewer"){b=false;break}if(b)c.ha=a.f.add(g)}}this.ye.F(a.f);this.ye=a.f.e();return false};
function ph(a,b,c,d,e){var f=c.Vr;if(b>5){a=e.e();ua(a,f);return d.add(a)}c.al=e.e();c.yp=e.e();c.yp.normalize();c.Jk=d.e();c.Pm=false;c.Xi=9.99999999E7;var g=new B;c.gi.ia(g.D);c.gi.ia(g.N);C(g,c.gi.add(c.im));pa(g.D,c.zc);g.N.ua(c.zc);var h=[],j=new I,m=1/c.zc.b,o=1/c.zc.d;j.q=1/c.zc.c;j.r=m;j.p=o;j.Qa=false;c.Ur.dh(g,j,h);for(g=0;g<h.length;++g)a:{j=h[g];var p=Za(j);if(Ya(p,c.yp)){var i=m=0,v=false,r=0;m=p.Cb(c.Jk);o=p.j.la(c.al);if(n.ya(o))if(Math.abs(m)>=1)break a;else{v=true;i=0}else{o=1/o;
i=(-1-m)*o;m=(1-m)*o;if(i>m){o=m;m=i;i=o}if(i>1||m<0)break a;i=n.ic(i,0,1);n.ic(m,0,1)}m=new s;o=false;var E=1;if(!v){p=c.Jk.substract(p.j).add(w(c.al,i));r=j.fa.substract(j.X);var z=j.ga.substract(j.X);v=r.la(r);var u=r.la(z),y=z.la(z),D=p.substract(j.X);r=D.la(r);D=D.la(z);z=r*y-D*u;r=D*v-r*u;if(z+r-(v*y-u*u)<0&&!(z<0||r<0)){o=true;E=i;m=p.e()}}if(!o){i=c.al.e();p=c.Jk.e();v=za(i);var H=z=r=0;u={};u.Sa=0;r=v;z=2*i.la(p.substract(j.X));H=za(j.X.substract(p))-1;if(qh(a,r,z,H,E,u)){E=u.Sa;o=true;m=
j.X.e()}if(!o){z=2*i.la(p.substract(j.fa));H=za(j.fa.substract(p))-1;if(qh(a,r,z,H,E,u)){E=u.Sa;o=true;m=j.fa.e()}}if(!o){z=2*i.la(p.substract(j.ga));H=za(j.ga.substract(p))-1;if(qh(a,r,z,H,E,u)){E=u.Sa;o=true;m=j.ga.e()}}y=j.fa.substract(j.X);H=j.X.substract(p);D=za(y);var Y=y.la(i),ha=y.la(H);r=D*-v+Y*Y;z=D*2*i.la(H)-2*Y*ha;H=D*(1-za(H))+ha*ha;if(qh(a,r,z,H,E,u)){r=(Y*u.Sa-ha)/D;if(r>=0&&r<=1){E=u.Sa;o=true;m=j.X.add(w(y,r))}}y=j.ga.substract(j.fa);H=j.fa.substract(p);D=za(y);Y=y.la(i);ha=y.la(H);
r=D*-v+Y*Y;z=D*2*i.la(H)-2*Y*ha;H=D*(1-za(H))+ha*ha;if(qh(a,r,z,H,E,u)){r=(Y*u.Sa-ha)/D;if(r>=0&&r<=1){E=u.Sa;o=true;m=j.fa.add(w(y,r))}}y=j.X.substract(j.ga);H=j.ga.substract(p);D=za(y);Y=y.la(i);ha=y.la(H);r=D*-v+Y*Y;z=D*2*i.la(H)-2*Y*ha;H=D*(1-za(H))+ha*ha;if(qh(a,r,z,H,E,u)){r=(Y*u.Sa-ha)/D;if(r>=0&&r<=1){E=u.Sa;o=true;m=j.ga.add(w(y,r))}}}if(o){o=E*c.al.getLength();if(!c.Pm||o<c.Xi){c.Xi=o;c.Ti=m.e();c.Pm=true;c.Ui=j;++c.$k}}}}if(!c.Pm)return d.add(e);h=d.add(e);d=d.e();if(c.Xi>=f){e=e.e();ua(e,
c.Xi-f);d=c.Jk.add(e);e.normalize();pa(c.Ti,w(e,f))}e=c.Ti.e();g=d.substract(c.Ti);g.normalize();j=new Va;j.j=g.e();Wa(j,e);e=h.substract(w(g,j.Cb(h))).substract(c.Ti);if(e.getLength()<f)return d;return ph(a,b+1,c,d,e)}function qh(a,b,c,d,e,f){a=c*c-4*b*d;if(a<0)return false;d=Math.sqrt(a);a=(-c-d)/(2*b);b=(-c+d)/(2*b);if(a>b){c=b;b=a;a=c}if(a>0&&a<e){f.Sa=a;return true}if(b>0&&b<e){f.Sa=b;return true}return false};function ch(a){this.Gi=0;this.Ba=a;this.s=null;this.Wg=0;this.Gi=q()}ch.prototype=new lh;ch.prototype.l=k("timer");ch.prototype.i=function(a,b,c,d){a=new ch(this.Ba);a.s=this.s?this.s.i(c,d):null;a.Gi=this.Gi;a.Wg=this.Wg;return a};ch.prototype.jb=function(a){if(a==null)return false;if(this.Wg>0){var b=q();if(b-this.Gi>this.Wg){this.Gi=b;this.s&&this.s.execute(a);return true}}return false};
function dh(a,b){this.Ba=a;this.Ha=b;this.s=null;this.Wg=0;this.Xd=null;this.qf=false;this!=null&&b.li.push(this);this!=null&&b.ki.push(this);xg(a,this)}dh.prototype=new lh;l=dh.prototype;l.l=k("keypress");l.i=function(a,b,c,d){a=new dh(this.Ba,this.Ha);a.rg=this.rg;a.Vc=this.Vc;a.s=this.s?this.s.i(c,d):null;return a};l.jb=function(a){this.Xd=a;a=this.qf;this.qf=false;return a};l.We=function(a){if(this.rg==0&&a.keyCode==this.Vc){rh(this);return true}return false};
l.Xe=function(a){if(this.rg==1&&a.keyCode==this.Vc){rh(this);return true}return false};l.zd=function(a){if(this.rg==1)if(a.button>1&&this.Vc==2)rh(this);else a.button<=1&&this.Vc==1&&rh(this)};l.le=function(a){if(this.rg==0)if(a.button>1&&this.Vc==2)rh(this);else a.button<=1&&this.Vc==1&&rh(this)};l.Xf=function(a){if(this.s)return Tc(this.s,a);return null};
function rh(a){if(a.Xd&&a.Xd.o===a.Ba&&sf(a.Xd)&&ve(a.Ha)===a.Xd.o){if(a.Xd.mb==null&&a.Xd.h!=-1){a.Xd=null;return}a.qf=true;a.s&&a.s.execute(a.Xd);Ne(a.Ba);return true}return null}
function eh(a){this.ph=this.Wd=this.kd=0;this.gg=false;this.bc=100;this.Ag=3E3;this.ci=-1;this.uh=this.Bk="";this.ei=100;this.mi=0;this.Db=new s;this.qj=this.Fj=this.he=this.ce="";this.oe=this.qe=this.ne=this.ld=null;this.Bl=this.Rl=this.Uc=0;this.ig=null;this.tj=this.jf=this.Kd=this.yh=0;this.kq=null;this.jl=this.tn=this.el=false;this.kl=new La;this.ek=0;this.ee=this.ja=null;this.Qf=a;this.Nn=0;this.Am=new s;this.Pl=null;this.Ql=0}eh.prototype=new lh;eh.prototype.l=k("gameai");
eh.prototype.i=function(a,b,c,d){a=new eh(this.Qf);a.kd=this.kd;a.Wd=this.Wd;a.ph=this.ph;a.gg=this.gg;a.bc=this.bc;a.Bk=this.Bk;a.uh=this.uh;a.ei=this.ei;a.mi=this.mi;a.ci=this.ci;a.Ag=this.Ag;a.Db=this.Db?this.Db.e():null;a.ce=this.ce;a.he=this.he;a.Fj=this.Fj;a.qj=this.qj;a.ld=this.ld?this.ld.i(c,d):null;a.ne=this.ne?this.ne.i(c,d):null;a.qe=this.qe?this.qe.i(c,d):null;a.oe=this.oe?this.oe.i(c,d):null;return a};
eh.prototype.jb=function(a,b){if(a==null||this.Qf==null)return false;var c=b-this.Nn;if(c>150)c=150;this.Nn=b;var d=0,e=false;if(this.ee!==a){this.ee=a;P(a);this.Am=O(a)}var f=O(a);if(this.Uc!=3)if(this.Uc==1){d=sh(this,a);if(this.ig.substract(f).getLength()<d){this.Uc=0;this.jc(a,0);e=true}else{e=false;if(this.Kd>2){d=this.Kd*(this.Wd/1E3);if(this.tj.substract(f).getLength()*1.2<d){this.Uc=0;this.jc(a,0);e=true}}if(!e){this.Kd+=c;e=this.ig.substract(f);ua(e,this.Wd/1E3*c);if(!this.gg)e.b=0;a.f.ua(e)}e=
th(this,a,b-this.yh,this.ig.substract(f),this.mi)}}else if(this.Uc==2){this.Kd+=c;if(!this.el&&this.Kd>this.jf/2){this.jl=true;this.ld&&this.ld.execute(a);this.jl=false;e=this.el=true}if(this.Kd>this.jf)this.Uc=0;else e=th(this,a,b-this.yh,this.ig.substract(f),Math.min(this.mi,this.jf))}else if(this.Uc==0)if(this.kd==1||this.kd==2||this.kd==3){if(this.ph<=0||!this.ee||this.uh.length==0||!this.Qf)c=null;else if(!this.Rl||b>this.Rl){this.Ql=this.ph;this.Pl=null;uh(this,this.Qf.Ua,f,this.uh);this.Rl=
b+500+Math.random()*1E3;c=this.Pl}else c=null;if(c!=null){e=1E3;if(this.ld)if(d=Tc(this.ld,"Shoot"))e=d.ed;d=e;!this.tn&&this.ne&&this.ne.execute(a);e=this.tn=true;if(O(c).Cb(f)<d){if(!c||!a)d=false;else{d=Oa(pf(c));var g=Oa(pf(a));if(this.ee==a)if(a.l()=="mesh")if(a.oc){var h=Pa(a.ob()).getLength()*0.5,j=g.substract(d);j.normalize();A(j,h+h*0.02);d.ua(j)}d=!this.ja||!this.Qf?true:this.ja.ah(d,g,true,null,true)!=null?false:true}if(d){this.kl.ca=Oa(pf(a));this.kl.S=Oa(pf(c));vh(this,a,c,O(c),f,b)}else wh(this,
a,O(c),f,b)}else wh(this,a,O(c),f,b)}else if(this.kd==2||this.kd==3)if(!this.Bl||b>this.Bl+this.Ag){d=sh(this,a);c=null;if(this.kd==3){g=null;if(this.ci!=-1&&this.Qf!=null)g=Qb(this.Qf,this.ci);if(g!=null&&g.l()=="path"){if(this.ek>=g.Jb.length)this.ek=0;c=Lf(g,this.ek)}++this.ek}else{c=this.ei;this.Bl=b;c=new s((Math.random()-0.5)*c,(Math.random()-0.5)*c,(Math.random()-0.5)*c);c.ua(this.Am);if(!this.gg)c.b=this.Am.b}if(!(c.substract(f).getLength()<d)){wh(this,a,c,f,b);e=true}}}return e};
function th(a,b,c,d,e){if(!b)return false;if(b.l()=="camera")return false;if(!a.gg)d.b=0;var f=new I;ub(f,Ha(d));d=new I;ub(d,a.Db);f=K(f,d);a=vb(f);f=b.V.e();c=Math.min(c,e)/e;c=n.ic(c,0,1);A(a,n.Nd);A(f,n.Nd);e=new zb;Fb(e,a.c,a.b,a.d);d=new zb;Fb(d,f.c,f.b,f.d);Cb(d,d,e,c);Eb(d,a);A(a,n.Fe);if(b.V.F(a))return false;b.V=a;return true}function wh(a,b,c,d,e){a.Uc=1;a.ig=c;a.yh=e;a.tj=d;a.Kd=0;a.jf=0;a.jc(b,1)}
function vh(a,b,c,d,e,f){a.Uc=2;a.ig=d;a.yh=f;a.kq=c;a.tj=e;a.Kd=0;a.jf=500;a.el=false;b=a.jc(b,2);if(b!=0)a.jf=b}function uh(a,b,c,d){if(b&&b.Z){var e=false,f=c.Cb(O(b));if(f<a.Ql){var g=N(b,"gameai");if(g&&d!=""&&g!==a&&g.bc>0)e=g.Bk.indexOf(d)!=-1}if(e){a.Ql=f;a.Pl=b}for(e=0;e<b.ba.length;++e)uh(a,b.ba[e],c,d)}}function sh(a,b){if(b!=null)return 10;a=Pa(pf(b));a.b=0;return a.getLength()}eh.prototype.Xm=function(a){switch(a){case 0:return this.ce;case 1:return this.he;case 2:return this.qj;case 3:return this.Fj}return""};
eh.prototype.jc=function(a,b){if(!a||a.l()!="animatedmesh")return 0;var c=a.Pa;if(!c)return 0;if(c=td(c,this.Xm(b))){Xf(a,c.Fd,c.S);c.Mc!=0&&Yf(a,c.Mc);a.ec=b==1||b==0;return(c.S-c.Fd)*c.Mc*1E3}else{Xf(a,1,1);a.ec=false}return 0};function wc(a,b,c){if(c)if(a.bc!=0){a.bc-=b;if(a.bc<0)a.bc=0;if(a.bc==0){a.oe!=null&&a.oe.execute(c);b=O(c);a.Uc=3;a.yh=0;a.tj=b;a.Kd=0;a.jf=500;a.jc(c,3)}else a.qe!=null&&a.qe.execute(c)}}
eh.prototype.Xf=function(a){var b=null;if(this.ld)if(b=Tc(this.ld,a))return b;if(this.ne)if(b=Tc(this.ne,a))return b;if(this.qe)if(b=Tc(this.qe,a))return b;if(this.oe)if(b=Tc(this.oe,a))return b;return null};n.dq=[];function Bc(){this.cd=this.n="";this.pc=this.rc=this.kc=0}
function Rb(a,b,c){if(a==null)return null;for(var d=a.toLowerCase(),e=n.dq,f=0;f<e.length;++f){var g=e[f];if(g!=null&&g.getName().toLowerCase()==d)return g}f=xh(a,c);if(f==null)c=null;else{c=new Bc;c.ln(a);Ec(c,0);d=f.Ve;if(f.fd=="health"&&d!=null){d=N(d,"gameai");d!=null&&Ec(c,d.bc)}else if(f.fd=="movementspeed"&&d!=null){f=N(d,"gameai");g=N(d,"keyboardcontrolled");if(d=N(d,"camerafps"))Dc(c,d.Rb);else if(g)Dc(c,g.Rb);else f&&Dc(c,f.Wd)}else if(f.fd=="damage"&&d!=null)(d=of(d,"Shoot"))&&Ec(c,d.te);
else if(f.fd=="colsmalldistance"&&d!=null){d=N(d,"collisionresponse");d!=null&&Dc(c,d.Lb)}else f.fd=="soundvolume"&&Dc(c,n.je.we*100);c=c}if(c)return c;if(b==true){b=new Bc;b.ln(a);e.push(b);return b}return null}
function Gc(a,b){var c=xh(a.n,b);if(c!=null){b=c.Ve;if(c.fd=="health"&&b!=null){c=N(b,"gameai");if(c!=null){var d=c.bc;a=yh(a);d=d-a;if(d>0)wc(c,d,b);else c.bc=a}}else if(c.fd=="movementspeed"&&b!=null){c=N(b,"gameai");d=N(b,"keyboardcontrolled");if(b=N(b,"camerafps"))b.Rb=Q(a);else if(d)d.Rb=Q(a);else if(c)c.Wd=Q(a)}else if(c.fd=="damage"&&b!=null){if(b=of(b,"Shoot"))b.te=yh(a)}else if(c.fd=="damage"&&b!=null){if(b=of(b,"Shoot"))b.te=yh(a)}else if(c.fd=="colsmalldistance"&&b!=null){b=N(b,"collisionresponse");
if(b!=null){b.Lb=yh(a);b.Do=true}}else c.fd=="soundvolume"&&le(n.je,Q(a)/100)}}function xh(a,b){if(a.length==0||b==null)return null;if(a[0]!="#")return null;var c=a.indexOf(".");if(c==-1)return null;var d=a.substr(c+1,a.length-c);if(d.length==0)return null;c=a.substr(1,c-1);a=null;if(c!="system"){a=vg(b,c);if(a==null)return null}b={};b.Ve=a;b.fd=d;return b}Bc.prototype.getName=ca("n");Bc.prototype.ln=ba("n");
function Ub(a){switch(a.kc){case 1:return String(a.rc);case 2:return a.pc%1==0?String(a.pc):a.pc.toFixed(6)}return a.cd}function yh(a){switch(a.kc){case 0:return Math.floor(a.cd);case 1:return a.rc;case 2:return a.pc}return 0}function Q(a){switch(a.kc){case 0:return Number(a.cd);case 1:return a.rc;case 2:return a.pc}return 0}function Cc(a,b){a.kc=0;a.cd=b}function Ec(a,b){a.kc=1;a.rc=b}function Dc(a,b){a.kc=2;a.pc=b}
function gh(a,b){this.Ec=0;this.Ba=a;this.xe=this.fc=this.sk=this.Rb=0;this.Ii=this.fm=false;this.kg=this.lj=0;this.ve=15;this.Db=new s;this.rk=this.Sj=this.he=this.ce="";this.Jn=this.pf=q();this.Vi=this.Se=this.bf=this.$e=this.Ue=this.Lq=this.xm=this.Ho=false;this.Fc=0;this.cl=false;this.Kk=true;this.Hj=false;this.Ha=b;this!=null&&b.li.push(this);this!=null&&b.ki.push(this)}gh.prototype=new lh;l=gh.prototype;l.l=k("keyboardcontrolled");
l.i=function(){var a=new gh(this.Ba,this.Ha);a.Rb=this.Rb;a.sk=this.sk;a.fc=this.fc;a.xe=this.xe;a.ve=this.ve;a.Db=this.Db?this.Db.e():null;a.ce=this.ce;a.he=this.he;a.Sj=this.Sj;a.rk=this.rk;a.Ii=this.Ii;a.lj=this.lj;a.kg=this.kg;a.Hj=this.Hj;return a};
l.bj=function(a,b){if(b==37||b==65){if(this.Ue=a)this.$e=false;return true}if(b==39||b==68){if(this.$e=a)this.Ue=false;return true}if(b==38||b==87){if(this.bf=a)this.Se=false;return true}if(b==40||b==83){if(this.Se=a)this.bf=false;return true}if(b==32){this.Vi=a;return true}return false};l.We=function(a){this.xm=a.shiftKey==1;return this.bj(true,a.keyCode)};l.Xe=function(a){this.xm=a.shiftKey==1;return this.bj(false,a.keyCode)};
l.jb=function(a,b){var c=b-this.Ec;if(c>250)c=250;this.Ec=b;var d=false;this.pf=b;if(this.Hj){var e=a.o.da;if(e!=null){e=N(e,"3rdpersoncamera");if(e!=null){if(e.uc!==a)return false}else return false}}e=a.V;if(this.Ue){e.b-=c*this.fc*0.001;d=true}if(this.$e){e.b+=c*this.fc*0.001;d=true}var f=new I;ub(f,e);e=new s(0,0,1);var g=new I;ub(g,this.Db);f=K(f,g);eb(f,e);f=this.xm;var h=(f?this.sk:this.Rb)*c,j=0;g=this.Se;var m=this.bf;if(this.Ii&&c)if(m||g){if(this.cl!=m)if(this.kg==0)this.Fc*=-1;else this.Fc=
0;this.cl=!g;j=h/c;this.Fc+=this.lj*j*(c/1E3);if(this.Fc>j)this.Fc=j;h=this.Fc*c}else if(this.kg==0)this.Fc=0;else{j=h/Number(c);this.Fc-=this.kg*j*(c/1E3);if(this.Fc<0)this.Fc=0;h=this.Fc*c}ua(e,h);if(m||g||this.Ii&&this.Fc!=0){d=e.e();if(g||!(m||g)&&!this.cl)A(d,-1);a.f.ua(d);this.Ho=d=true}if(m||g){this.jc(a,f?3:1,g);d=this.Ho=true}else{c=false;if(e=N(a,"collisionresponse"))c=e.ue;if(!c&&(this.jc(a,1,false,true)||this.jc(a,3,false,true)||this.jc(a,2,false,true)))this.jc(a,0,false)}if(this.Vi)if((c=
N(a,"collisionresponse"))&&!c.ue){e=0;if(this.Ba&&this.Ba.Pd!=0)e=Math.floor(this.xe*(1/this.Ba.Pd)*2E3);if(!this.fm||this.fm&&b-this.Jn>e){if(c.Rd==0)c.Rd=this.xe*100;this.jc(a,2,false);this.Jn=b;d=true}}return d};l.Xm=function(a){switch(a){case 0:return this.ce;case 1:return this.he;case 2:return this.Sj;case 3:return this.rk}return""};
l.jc=function(a,b,c,d){if(!a||a.l()!="animatedmesh")return false;var e=a.Pa;if(!e)return false;if(e=td(e,this.Xm(b))){var f=1*e.Mc;if(c)f*=-1;if(d)return a.yb==e.S&&a.Za==e.Fd;if(!(a.yb==e.S&&a.Za==e.Fd&&n.F(a.Fb,f))){Xf(a,e.Fd,e.S);f&&Yf(a,f);a.ec=b==0||b==1||b==3}return false}else if(!d){Xf(a,1,1);a.ec=false}return false};
function fh(a){this.Ec=0;this.Ba=a;this.ni=-1;this.ve=15;this.Db=new s;this.Ck=this.Lj=0;this.Jc=false;this.pf=this.ja=0;this.mf=new s;this.Dh=new s;this.uc=null;this.Ao=false;this.Kk=true}fh.prototype=new lh;fh.prototype.l=k("3rdpersoncamera");fh.prototype.i=function(){var a=new fh(this.Ba);a.ni=this.ni;a.ve=this.ve;a.Db=this.Db.e();a.Lj=this.Lj;a.Ck=this.Ck;a.Jc=this.Jc;a.ja=this.ja;return a};
fh.prototype.jb=function(a,b){var c=b-this.Ec;if(c>250)c=250;this.Ec=b;var d=false;if(a==null)return false;d=a.o;if(!this.Ao)if(this.ni!=-1)if(d!=null){if((d=Qb(d,this.ni))&&d!==this.uc){this.uc=d;this.Kk=true}this.Ao=true}if(!this.uc)return false;d=false;var e=a.ha.e();a.ha=O(this.uc);a.ha.ua(this.Dh);a.ha.b+=this.Ck;a.ha.F(e)||(d=true);if(this.Kk){P(this.uc);P(a);this.Dh=Pa(this.uc.ob());this.Dh.b/=2;this.Dh.c=0;this.Dh.d=0;this.Ec=b;this.Kk=false}if(a.o.da!==a)return false;if(xa(this.mf)){this.mf=
O(this.uc).substract(O(a));b=new I;ub(b,this.uc.V);e=this.mf;var f=e.e();e.c=f.c*b.q+f.b*b.v+f.d*b.t;e.b=f.c*b.w+f.b*b.r+f.d*b.u;e.d=f.c*b.A+f.b*b.B+f.d*b.p}b=this.uc.V;e=new I;ub(e,b);b=new I;ub(b,this.Db);e=K(e,b);b=a.f.e();switch(this.Lj){case 0:break;case 2:b=O(this.uc).substract(this.mf);break;case 1:b=this.mf.e();eb(e,b);b=O(this.uc).substract(b);e=O(a).Cb(b);f=this.mf.getLength();f=e>f*2.2;if(n.F(this.ve,0)||f)b=b;else{c=Math.sqrt(e)*(c/1E3)*this.ve;if(c>e)c=e;b=b.substract(a.f);ua(b,c);b.ua(a.f);
b=b}break}if(this.Jc&&this.ja!=null&&!a.f.F(b)){this.ja.cj(this.uc);c=new La;c.ca=a.ha.e();c.S=b.e();var g=Ma(c);e=g.getLength();f=this.mf.getLength()/10;ua(g,f);c.S.ua(g);g=new F;g=this.ja.ah(c.ca,c.S,true,g,true);if(g!=null){b=g.substract(c.ca);g=b.getLength();if(g<f)g=f;g-=f;if(g>e)g=e;ua(b,g);b=c.ca.add(b)}this.ja.cj(null)}if(!a.f.F(b)){d=true;a.f=b}return d};function hh(a){this.$p=this.ko=false;this.Ba=a;this.s=null}hh.prototype=new lh;hh.prototype.l=k("onfirstframe");
hh.prototype.jb=function(a){if(this.ko)return false;this.ko=true;if(this.s){this.s.execute(a);return true}return false};function Vf(a,b,c){this.Ba=b;this.Aa=c;this.Xa=a;this.yg=false;xg(b,this);this.xl=[];for(a=0;a<255;++a)this.xl.push(false);this.hg=[];this.hg.push(new Na(-1,0));this.hg.push(new Na(0,-1));this.hg.push(new Na(1,0));this.hg.push(new Na(0,1))}Vf.prototype=new lh;Vf.prototype.l=k("mobileinput");
Vf.prototype.jb=function(){var a=false;if(this.Aa.Pj==1)zh(this,this.yg&&this.Aa.ck,this.Aa.Vc);else if(Math.sqrt(this.Aa.mc*this.Aa.mc+this.Aa.nc*this.Aa.nc)<0.3||!this.yg){if(!this.yg){a=this.Aa.mc!=0&&this.Aa.nc!=0;this.Aa.mc=0;this.Aa.nc=0}zh(this,false,37);zh(this,false,38);zh(this,false,39);zh(this,false,40)}else for(var b=0;b<4;++b){var c=this.hg[b].c-this.Aa.mc,d=this.hg[b].b-this.Aa.nc;c=Math.sqrt(c*c+d*d)<1;zh(this,c,37+b)}return a};
function zh(a,b,c){if(a.xl[c]!=b){a.xl[c]=b;var d={};d.keyCode=c;b?xe(a.Xa,d):ye(a.Xa,d)}}Vf.prototype.zd=function(){this.yg=false};Vf.prototype.le=function(){this.yg=true};Vf.prototype.Ye=function(a){if(this.yg&&this.Aa.ck&&this.Aa.pm!=0&&this.Aa.om!=0){var b=hf(this.Xa,a)-this.Aa.fo;a=jf(this.Xa,a)-this.Aa.ho;this.Aa.mc=b/this.Aa.pm;this.Aa.nc=a/this.Aa.om;this.Aa.mc=n.ic(this.Aa.mc,0,1);this.Aa.nc=n.ic(this.Aa.nc,0,1);this.Aa.mc=this.Aa.mc*2-1;this.Aa.nc=this.Aa.nc*2-1}};function vector3d(a,b,c){if(a!==null){this.x=a;this.y=b;this.z=c}else this.z=this.y=this.x=0}l=vector3d.prototype;l.add=function(a){return new vector3d(this.x+a.x,this.y+a.y,this.z+a.z)};l.substract=function(a){return new vector3d(this.x-a.x,this.y-a.y,this.z-a.z)};l.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};l.normalize=function(){var a=this.getLength();if(a!=0){a=1/a;this.x*=a;this.y*=a;this.z*=a}};
l.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};l.x=0;l.y=0;l.z=0;function Ah(){this.wp=-1;this.Sg=[];this.Mh=false;this.Ha=this.O=this.Ia=this.Cj=this.qa=null;this.Wf=[];this.To=[];this.In=0;this.mo=false;this.Zl=null;this.no={};this.Bn=0}n.$=null;function Z(){if(n.$==null)n.$=new Ah;return n.$}function ue(a,b){a.Ha=b}function Pe(a){return a.Wf.length!=0}function jh(a,b){try{eval(b)}catch(c){ka(n.va,c)}}function Bh(a){++a.wp;return a.wp}
function Ze(a,b){a.Mh=true;if(a.Wf.length!=null){a.O=b;for(b=0;b<a.Wf.length;++b)a.Wf[b]();a.O=null}a.Mh=false}
function Ch(a,b,c,d,e){switch(c){case "Position Mode":b.$d=d=="absolute (pixels)";break;case "Pos X (percent)":b.yf=d/100;break;case "Pos Y (percent)":b.zf=d/100;break;case "Width (percent)":b.Lf=d;break;case "Height (percent)":b.Kf=d;break;case "Pos X (pixels)":b.wf=d;break;case "Pos Y (pixels)":b.xf=d;break;case "Width (pixels)":b.Nf=d/100;break;case "Height (pixels)":b.Mf=d/100;break;case "Alpha":b.Tc=(d&255)<<24|b.Tc&16777215;break;case "Image":a=wd(a.Ia,d);b.La=a;break;case "Background Color":b.Tc=
e;break;case "Draw Text":b.kf=d?true:false;break;case "TextColor":b.Pf=e;break;case "Text":b.hb=d;break}}
function Dh(a,b,c){switch(c){case "Position Mode":return b.$d;case "Pos X (percent)":return b.yf*100;case "Pos Y (percent)":return b.zf*100;case "Width (percent)":return b.Lf;case "Height (percent)":return b.Kf;case "Pos X (pixels)":return b.wf;case "Pos Y (pixels)":return b.xf;case "Width (pixels)":return b.Nf*100;case "Height (pixels)":return b.Mf*100;case "Alpha":return n.xd(b.Tc);case "Image":return b.La?b.La.n:null;case "Background Color":return b.Tc;case "Draw Text":return b.kf;case "TextColor":return b.Pf;
case "Text":return b.hb}return null}n.ef=function(a){this.cc=null;this.vc=[];this.Lm=this.Lo=false;this.Zd=-1;this.No=false;this.Ba=a};n.ef.prototype=new lh;function Eh(a,b,c){a.Lo=b;a.Lm=c;if(!a.No&&a.Ba){b=Z().Ha;if(c){a!=null&&b.li.push(a);a!=null&&b.ki.push(a)}xg(a.Ba,a)}}n.ef.prototype.l=k("extensionscript");n.ef.prototype.i=function(a,b,c,d){a=new n.ef(b);a.cc=this.cc;for(b=0;b<this.vc.length;++b){var e=this.vc[b];e!=null?a.vc.push(e.i(c,d)):a.vc.push(null)}return a};
n.ef.prototype.jb=function(a,b){if(a==null)return false;if(this.cc==null||this.cc.length==0)return false;var c=Z();c.Cj=this;this.Zd==-1&&Fh(this,a,c);if(this.Zd!=-1)try{_ccbScriptCache[this.Zd].onAnimate(a,b)}catch(d){ka(n.va,this.cc+": "+d)}c.Cj=null;return true};
function Fh(a,b,c){var d="";a.Zd=Bh(c);d+="if (typeof _ccbScriptCache == 'undefined') _ccbScriptCache = new Array(); ";d+="_ccbScriptCache[";d+=a.Zd;d+="] = new ";d+=a.cc;d+="();";jh(c,d);var e="_ccbScriptCache[";e+=a.Zd;e+="].";d="try {";d+=Gh(e,a.vc);d+="} catch(e) { }";jh(c,d);d=false;if(b.l()=="camera")d=true;a.No=d;d="try { ccbRegisterBehaviorEventReceiver(typeof ";d+=e;d+="onMouseEvent != 'undefined', typeof ";d+=e;d+="onKeyEvent != 'undefined'); } catch(e) { }";jh(c,d)}
function Hh(a,b,c){a.Lo&&_ccbScriptCache[a.Zd].onMouseEvent(b,c)}l=n.ef.prototype;l.zd=function(a){var b=false;if(a&&a.button==2)b=true;Hh(this,b?4:2,0)};l.ag=function(a){Hh(this,1,a)};l.le=function(a){var b=false;if(a&&a.button==2)b=true;Hh(this,b?5:3,0)};l.Ye=function(){Hh(this,0,0)};l.We=function(a){this.Lm&&_ccbScriptCache[this.Zd].onKeyEvent(a.keyCode,true)};l.Xe=function(a){this.Lm&&_ccbScriptCache[this.Zd].onKeyEvent(a.keyCode,false)};
function ih(){this.h=-1;this.Uf=this.cd=this.n=null;this.rc=this.pc=0;this.Di=this.oh=null}ih.prototype.i=function(a,b){var c=new ih;c.h=this.h;c.n=this.n;c.cd=this.cd;c.Uf=this.Uf?this.Uf.e():null;c.pc=this.pc;c.rc=this.rc;if(this.oh)c.oh=this.oh.i(a,b);c.Di=this.Di;return c};
function Gh(a,b){for(var c="",d=0;d<b.length;++d){var e=b[d];if(e!=null){c+=a;c+=e.n;c+=" = ";switch(e.h){case 1:c+=e.pc;c+="; ";break;case 2:c+='"';var f=e.cd.split('"').join('\\"');c+=f;c+='"; ';break;case 3:c+=e.rc?"true":"false";c+="; ";break;case 6:c+="new vector3d(";c+=e.Uf.c;c+=", ";c+=e.Uf.b;c+=", ";c+=e.Uf.d;c+="); ";break;case 7:c+='"';c+=e.Di?e.Di.n:"";c+='"; ';break;case 8:c+="ccbGetSceneNodeFromId(";c+=e.rc;c+="); ";break;case 9:a:{f=Z();e=e.oh;for(var g=0;g<f.Sg.length;++g)if(f.Sg[g]===
e){f=g;break a}f.Sg.push(e);f=f.Sg.length-1}c+=f;c+="; ";break;case 0:case 5:case 4:default:c+=e.rc;c+="; ";break}}}return c}function kh(){this.h="ExtensionScript";this.vc=[];this.cc=null}kh.prototype.i=function(a,b){var c=new kh;c.cc=this.cc;for(var d=0;d<this.vc.length;++d){var e=this.vc[d];e!=null?c.vc.push(e.i(a,b)):c.vc.push(null)}return c};
kh.prototype.execute=function(a){if(!(this.cc==null||this.cc.length==0||a==null)){var b=Z(),c="";c="_ccbScriptTmp = new ";c+=this.cc;c+="();";jh(b,c);c="try { ";c+=Gh("_ccbScriptTmp.",this.vc);c+="} catch(e) { }";jh(b,c);c="try { _ccbScriptTmp.execute(ccbGetSceneNodeFromId(";c+=a.Oa;c+=")); } catch(e) { }";jh(b,c)}};function Ih(a){var b=n.$.qa;if(b==null)return null;return Qb(b,a)}
function Jh(a){var b=n.$.qa;if(a==null)return null;var c=a.Oa,d=Yc(b);c=a.i(a.mb,c,d);if(c!=null){c.Oa=d;b.aj(a,c)}if((a=a.gb)&&b)if(a=a.i(c)){c.gb=a;b.Jd&&Zc(b.Jd,a)}return c}function Kh(){var a=n.$.qa;if(a==null)return null;return a.da}function Lh(a){var b=n.$.qa;b!=null&&a!=null&&a.l()=="camera"&&sg(b,a)}function Mh(a,b){if(a==null)return-1;if(b<0||b>=a.ba.length)return null;return a.ba[b]}function Nh(){var a=n.$.qa;if(a==null)return null;return a.Ua}
function Oh(a){if(a==null)return 0;return a.ba.length}function Ph(a){var b=n.$.qa;if(b==null)return null;return vg(b,a)}function Qh(a){var b=n.$.qa;b!=null&&Wc(b,a,0)}function Rh(a,b){a&&b&&vc(b,a)}function Sh(a){if(a==null)return 0;return a.hd()}
function Th(a,b,c){if(a==null)return null;if(b<0||b>=a.hd())return null;a=a.Cc(b);if(a==null)return null;if(c=="Type")switch(a.h){case 0:return"solid";case 2:return"lightmap";case 3:return"lightmap_add";case 4:return"lightmap_m2";case 5:return"lightmap_m4";case 11:return"reflection_2layer";case 12:return"trans_add";case 13:return"trans_alphach";case 16:return"trans_reflection_2layer"}else if(c=="Texture1")return a.pa==null?"":a.pa.n;else if(c=="Texture2")return a.yc==null?"":a.yc.n;else if(c=="Lighting")return a.Qb;
else if(c=="Backfaceculling")return a.cq;return null}function Uh(){}
function Vh(a,b,c,d){if(a!=null)if(!(b<0||b>=a.hd())){a=a.Cc(b);if(a!=null){b=typeof d=="string"?d:null;var e=null;e=Z();if(c=="Type")if(b)switch(b){case "solid":a.h=0;break;case "lightmap":case "lightmap_add":case "lightmap_m2":case "lightmap_m4":a.h=2;break;case "reflection_2layer":a.h=11;break;case "trans_add":a.h=12;break;case "trans_alphach":a.h=13;break;case "trans_reflection_2layer":a.h=16;break}else{c=parseInt(d);if(c!=NaN)a.h=c}else if(c=="Texture1"){if(b!=null&&e.Ia!=null){e=wd(e.Ia,b);
if(e!=null)a.pa=e}}else if(c=="Texture2"){if(b!=null&&e.Ia!=null){e=wd(e.Ia,b);if(e!=null)a.yc=e}}else if(c=="Lighting")a.Qb=d;else if(c=="Backfaceculling")a.cq=d}}}
function Wh(a,b,c,d,e){if(a!=null){var f=0,g=0,h=0,j=0;if(c!=null)j=c;if(d==null&&c!=null&&typeof c.x!="undefined"){f=c.x;g=c.y;h=c.z}if(d!=null&&e!=null){f=c;g=d;h=e;j=n.ie(255,Math.floor(c),Math.floor(d),Math.floor(e))}var m=e=d=null,o=null,p=a.l();if(p=="camera")d=a;else if(p=="animatedmesh")e=a;else if(p=="light")m=a;else if(p=="2doverlay")o=a;if(b=="Visible")a.Z=c;else if(b=="Position"){a.f.c=f;a.f.b=g;a.f.d=h}else if(b=="Rotation"){a.V.c=f;a.V.b=g;a.V.d=h}else if(b=="Scale"){a.sa.c=f;a.sa.b=
g;a.sa.d=h}else if(b=="Target")d!=null&&pc(d,new s(f,g,h));else if(b=="UpVector"){if(d!=null)d.zb=new s(f,g,h)}else if(b=="FieldOfView_Degrees")d!=null&&vf(d,n.Vo(c));else if(b=="AspectRatio")d!=null&&cf(d,c);else if(b=="Animation")e!=null&&gc(e,c,e.ec);else if(b=="Looping")e!=null&&Zf(e,c);else if(b=="FramesPerSecond")e!=null&&Yf(e,c*0.001);else if(b=="AnimationBlending"){if(e!=null)e.se=c}else if(b=="BlendTimeMs"){if(e!=null)e.nd=c}else if(b=="Radius"){if(m!=null)m.Ra.Ka=c}else if(b=="Color"){if(m!=
null)m.Ra.na=n.Uo(j)}else if(b=="Direction"){if(m!=null){m.Ra.Na=new s(f,g,h);m.Ra.Na.normalize()}}else if(b=="FogColor")n.$.qa.ac=j;else if(b=="Realtime Shadows"&&a===Nh())n.$.qa.wi=c==true;else if(b=="BackgroundColor"&&a===Nh())n.$.qa.eg=j;else if(b=="AmbientLight")n.$.qa.Xb=n.Uo(j);else if(b=="Bloom")n.$.qa.Pc[Dg].Gc=c==true;else if(b=="Black and White")n.$.qa.Pc[Sg].Gc=c==true;else if(b=="Invert")n.$.qa.Pc[Qg].Gc=c==true;else if(b=="Blur")n.$.qa.Pc[Og].Gc=c==true;else if(b=="Colorize")n.$.qa.Pc[Rg].Gc=
c==true;else if(b=="Vignette")n.$.qa.Pc[Tg].Gc=c==true;else if(b=="Bloom_BlurIterations")n.$.qa.$l=c>>0;else if(b=="Bloom_Treshold")n.$.qa.am=c;else if(b=="Blur_Iterations")n.$.qa.bm=c>>0;else if(b=="Colorize_Color")n.$.qa.bi=c;else if(b=="Vignette_Intensity")n.$.qa.cm=c>>0;else if(b=="Vignette_RadiusA")n.$.qa.dm=c>>0;else if(b=="Vignette_RadiusB")n.$.qa.em=c>>0;else if(b=="Name")a.n=c;else o!=null&&Ch(Z(),o,b,c,j)}}
function Xh(a,b){if(a==null)return null;var c=null,d=null,e=null,f=null,g=a.l();if(g=="camera")c=a;else if(g=="animatedmesh")d=a;else if(g=="light")e=a;else if(g=="2doverlay")f=a;if(b=="Visible")return a.Z;else if(b=="Position")return new vector3d(a.f.c,a.f.b,a.f.d);else if(b=="PositionAbs"){a=O(a);return new vector3d(a.c,a.b,a.d)}else if(b=="Rotation")return new vector3d(a.V.c,a.V.b,a.V.d);else if(b=="Scale")return new vector3d(a.sa.c,a.sa.b,a.sa.d);else if(b=="Target"){if(c!=null)return new vector3d(c.ha.c,
c.ha.b,c.ha.d)}else if(b=="UpVector"){if(c!=null)return new vector3d(c.zb.c,c.zb.b,c.zb.d)}else if(b=="FieldOfView_Degrees"){if(c!=null)return n.$i(c.qd)}else if(b=="AspectRatio"){if(c!=null)return c.Sc}else if(b=="Animation")return"";else if(b=="Looping"){if(d!=null)return d.ec}else if(b=="FramesPerSecond"){if(d!=null)return d.Fb*1E3}else if(b=="AnimationBlending"){if(d!=null)return d.se}else if(b=="BlendTimeMs"){if(d!=null)return d.nd}else if(b=="Radius"){if(e!=null)return e.Ra.Ka}else if(b=="Color"){if(e!=
null)return n.ie(255,e.Ra.na.wc*255,e.Ra.na.qc*255,e.Ra.na.lc*255)}else if(b=="Direction"){if(e!=null)return e.Ra.Na}else if(b=="Name")return a.n;else if(b=="Type")return a.l();else if(b=="FogColor")return n.$.qa.ac;else if(b=="Realtime Shadows"&&a===Nh())return n.$.qa.wi;else if(b=="BackgroundColor"&&a===Nh())return n.$.qa.eg;else if(f!=null)return Dh(Z(),f,b);return null}
function Yh(a,b,c,d){if(a!=null){a.f.c=b;a.f.b=c;a.f.d=d;for(b=0;b<a.ma.length;++b){c=a.ma[b];c!=null&&c.l()=="collisionresponse"&&c.reset()}}}function Zh(a){Z().Wf.push(a)}function $h(a){var b=Z();a=b.Wf.indexOf(a);a!=-1&&b.Wf.splice(a,1)}function ai(a,b,c,d,e){var f=Z();!f.Mh||f.O==null||Od(f.O,b,c,d-b,e-c,a,true)}function bi(a,b,c,d,e){a=Z();!a.Mh||a.O==null||Od(a.O,b,c,d-b,e-c,4278190080,true)}function ci(a,b,c,d,e){a=Z();!a.Mh||a.O==null||Od(a.O,b,c,d-b,e-c,4278190080,true)}
function di(a,b){var c=Z().Ha;a=lf(c,a,b);if(a!=null)return new vector3d(a.c,a.b,a.d);return null}function ei(a,b,c){var d=Z().Ha;a=mf(d,new s(a,b,c));return new vector3d(a.c,a.b,0)}function fi(a,b,c,d,e,f){var g=new La;g.ca=new s(a,b,c);g.S=new s(d,e,f);a=n.$.qa;a=xc(yc.prototype,a,g.ca,g.S,a.Jd,true);if(a<999999999){b=Ma(g);ua(b,a);g=g.ca.add(b);return new vector3d(g.c,g.b,g.d)}return null}
function gi(a,b,c,d,e,f,g){if(a==null)return false;if(a.aa==null)return false;b=new s(b,c,d);e=new s(e,f,g);return Ra(pf(a),b,e)}function hi(){window.close()}function ii(){}function ji(a){var b=Z();a=vd(b.Ia,a,true);if(a!=null)return a.n;return null}function ki(){var a=Z().Ha;if(a)return a.Nc;return 0}function li(){var a=Z().Ha;if(a)return a.Oc;return 0}function mi(){var a=Z().Ha;if(a!=null&&a.O)return a.O.Nb();return 0}function ni(){var a=Z().Ha;if(a!=null&&a.O)return a.O.Mb();return 0}
function oi(){}function pi(){}function qi(a){var b=Z().Ha;if(b!=null)return ic(b,a,true);return false}function ri(a){var b=n.je;a=ge(b,a);a!=null&&Kc(b,a,false,1)}function si(a){Mc(n.je,a)}function ti(a){a=Rb(a,true,n.$.qa);if(a==null)return null;if(a.kc==0)return Ub(a);if(a.kc==1)return yh(a);if(a.kc==2)return Q(a);return null}function ui(a,b){var c=n.$.qa;a=Rb(a,true,c);if(a!=null){typeof b=="number"?Dc(a,b):Cc(a,b);Gc(a,c)}}function vi(a,b){var c=Z().Ha;c&&nf(c,a,b)}function wi(){return null}
function xi(){}function yi(){return"webgl"}function zi(a,b){var c=n.$.qa;if(c!=null){if(b==null)b=c.Ua;if(a>=0&&a<n.$.Sg.length){a=n.$.Sg[a];a!=null&&a.execute(b)}}}function Ai(a){ka(n.va,a)}function Bi(){}function Ci(a,b){n.$.Cj!=null&&Eh(n.$.Cj,a,b)}function Di(a,b){++n.$.In;var c=n.$.In;a=new la(a);var d=n.$.To,e={};e.yr=a;e.id=c;d.push(e);a.load(function(f){b&&b(f);for(f=0;f<d.length;++f)if(d[f].id==c){d.splice(f,1);break}});return c}
function Ei(a){for(var b=n.$.To,c=0;c<b.length;++c)if(b[c].id==a){b[c].yr.abort();b.splice(c,1);break}}function Fi(a,b,c,d){var e=Z(),f=e.Ha.O;if(f==null)return-1;c=f.eb[c];a=Xd(f,a,b,c.Qo,c.Ro,c.Po);if(a!=-1){if(d!=null)e.no["_"+a]=d;if(!e.mo){e.mo=true;e.Zl=f.Zh;f.Zh=function(g){e.Zl&&e.Zl();var h=e.no["_"+g];if(h!=null){e.Bn=g;h()}}}}return a}function Gi(a,b,c,d,e,f){var g=Z(),h=g.Ha.O;if(h!=null){a=h.P;g=Yd(h,g.Bn);b=a.getUniformLocation(g,b);a.uniform4f(b,c,d,e,f)}}n.Wm=null;
function Hi(){return n.Wm}function Ii(a,b,c){if(a){var d=N(a,"gameai");if(d)if(b=="cancel"){d.Uc=0;d.jc(a,0)}else if(b=="moveto"){b=new s(0,0,0);if(c!=null&&typeof c.x!="undefined"){b.c=c.x;b.b=c.y;b.d=c.z}wh(d,a,b,O(a),q())}else b=="attack"&&vh(d,a,c,O(c),O(a),q())}};function oe(){this.zh=-1;this.aq="";this.Tb=[];this.Zq=2;this.Eo=false;this.ks=320;this.js=200;this.Km=function(a){this.Tb.push(a)};this.bh=function(){if(this.zh<0||this.zh>=this.Tb.length)return null;return this.Tb[this.zh]};this.Lp=function(a){for(var b=0;b<this.Tb.length;++b)if(this.Tb[b]===a){this.zh=b;return}}};n.cr=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);
n.dr=function(a){var b,c,d,e,f,g=n.cr;e=a.length;d=0;for(f="";d<e;){do b=g[a.charCodeAt(d++)&255];while(d<e&&b==-1);if(b==-1)break;do c=g[a.charCodeAt(d++)&255];while(d<e&&c==-1);if(c==-1)break;f+=String.fromCharCode(b<<2|(c&48)>>4);do{b=a.charCodeAt(d++)&255;if(b==61)return f;b=g[b]}while(d<e&&b==-1);if(b==-1)break;f+=String.fromCharCode((c&15)<<4|(b&60)>>2);do{c=a.charCodeAt(d++)&255;if(c==61)return f;c=g[c]}while(d<e&&c==-1);if(c==-1)break;f+=String.fromCharCode((b&3)<<6|c)}return f};function Ji(){}l=Ji.prototype;l.$f=aa();l.dh=function(a,b,c){this.$f(b,c)};
l.ah=function(a,b,c,d,e){if(!a||!b)return null;if(this.Da!=null&&e&&this.Da.Z==false)return null;var f=new B;f.D=a.e();f.N=a.e();C(f,b);e=[];this.dh(f,null,e);f=b.substract(a);f.normalize();for(var g,h=9.999999999E8,j=za(b.substract(a)),m=Math.min(a.c,b.c),o=Math.max(a.c,b.c),p=Math.min(a.b,b.b),i=Math.max(a.b,b.b),v=Math.min(a.d,b.d),r=Math.max(a.d,b.d),E=null,z=0;z<e.length;++z){var u=e[z];if(!(c&&!Ya(Za(u),f)))if(!(m>u.X.c&&m>u.fa.c&&m>u.ga.c))if(!(o<u.X.c&&o<u.fa.c&&o<u.ga.c))if(!(p>u.X.b&&p>
u.fa.b&&p>u.ga.b))if(!(i<u.X.b&&i<u.fa.b&&i<u.ga.b))if(!(v>u.X.d&&v>u.fa.d&&v>u.ga.d))if(!(r<u.X.d&&r<u.fa.d&&r<u.ga.d))if(!(ya(a,u.X)>=h&&ya(a,u.fa)>=h&&ya(a,u.ga)>=h))if(g=u.Ym(a,f)){var y=ya(g,a),D=ya(g,b);if(y<j&&D<j&&y<h){h=y;d&&u.ia(d);E=g}}}if(E)return E.e();return null};l.Ok=k(null);l.cj=aa();l.i=k(null);
function Ag(a,b,c,d){if(a){this.Da=b;this.M=[];if(a!=null)for(b=0;b<a.wa.length;++b){var e=a.wa[b];if(e)if(!(c!=null&&e.m&&e.m.h==c))if(!(d!=null&&e.m&&e.m.h==d))for(var f=e.T.length,g=0;g<f;g+=3)this.M.push(new F(e.k[e.T[g]].f,e.k[e.T[g+1]].f,e.k[e.T[g+2]].f))}}}Ag.prototype=new Ji;
Ag.prototype.$f=function(a,b){if(this.Da.aa){a=a?K(a,this.Da.aa):this.Da.aa;var c;if(bb(a))for(c=0;c<this.M.length;++c)b.push(this.M[c]);else if(cb(a))for(c=0;c<this.M.length;++c)b.push(new F(mb(a,this.M[c].X),mb(a,this.M[c].fa),mb(a,this.M[c].ga)));else for(c=0;c<this.M.length;++c)b.push(new F(kb(a,this.M[c].X),kb(a,this.M[c].fa),kb(a,this.M[c].ga)))}};Ag.prototype.dh=function(a,b,c){this.$f(b,c)};Ag.prototype.Ok=ca("Da");Ag.prototype.i=function(a){var b=new Ag(null,a);b.Da=a;b.M=this.M;return b};
function Bg(a,b){if(b){this.Da=b;this.M=[];if(a!=null){a=Qa(a);this.M.push(new F(a[3],a[0],a[2]));this.M.push(new F(a[3],a[1],a[0]));this.M.push(new F(a[3],a[2],a[7]));this.M.push(new F(a[7],a[2],a[6]));this.M.push(new F(a[7],a[6],a[4]));this.M.push(new F(a[5],a[7],a[4]));this.M.push(new F(a[5],a[4],a[0]));this.M.push(new F(a[5],a[0],a[1]));this.M.push(new F(a[1],a[3],a[7]));this.M.push(new F(a[1],a[7],a[5]));this.M.push(new F(a[0],a[6],a[2]));this.M.push(new F(a[0],a[4],a[6]))}}}Bg.prototype=new Ag;
Bg.prototype.i=function(a){var b=new Bg(null,a);b.Da=a;b.M=this.M;return b};function yg(){this.ad=[];this.Tl=null}yg.prototype=new Ji;yg.prototype.$f=function(a,b){for(var c=this.Tl,d=0;d<this.ad.length;++d){var e=this.ad[d];c!=null&&c==e.Ok()||e.$f(a,b)}};yg.prototype.dh=function(a,b,c){for(var d=this.Tl,e=0;e<this.ad.length;++e){var f=this.ad[e];d!=null&&d==f.Ok()||f.dh(a,b,c)}};function Zc(a,b){a.ad.push(b)}
function Oe(a,b){for(var c=0;c<a.ad.length;)if(a.ad[c]===b){a.ad.splice(c,1);return}else++c}yg.prototype.clear=function(){this.ad=[]};yg.prototype.ah=function(a,b,c,d,e){var f=9.999999999E8,g=null,h=null;if(d)h=new F;for(var j=0;j<this.ad.length;++j){var m=this.ad[j].ah(a,b,c,h,e);if(m!=null){var o=ya(m,a);if(o<f){g=m.e();f=o;d&&h.ia(d)}}}return g};yg.prototype.cj=ba("Tl");n.tm=function(){this.M=[];this.g=new B;this.od=[]};
function zg(a,b,c,d,e){this.fq=this.eq=0;this.Rn=c==null?64:c;if(a){this.Da=b;this.Ge=new n.tm;this.M=[];for(b=0;b<a.wa.length;++b)if(c=a.wa[b])if(!(d!=null&&c.m&&c.m.h==d))if(!(e!=null&&c.m&&c.m.h==e))for(var f=c.T.length,g=0;g<f;g+=3){var h=new F(c.k[c.T[g]].f,c.k[c.T[g+1]].f,c.k[c.T[g+2]].f);this.Ge.M.push(h);this.M.push(h)}Ki(this,this.Ge)}}zg.prototype=new Ji;
function Ki(a,b){++a.eq;b.g.D=b.M[0].X.e();b.g.N=b.g.D.e();for(var c,d=b.M.length,e=0;e<d;++e){c=b.M[e];C(b.g,c.X);C(b.g,c.fa);C(b.g,c.ga)}if(!b.g.D.F(b.g.N)&&d>a.Rn){d=Oa(b.g);for(var f=Qa(b.g),g=new B,h=0;h<8;++h){var j=[];g.D=d.e();g.N=d.e();C(g,f[h]);b.od.push(new n.tm);for(e=0;e<b.M.length;++e){c=b.M[e];g.eh(c.X)&&g.eh(c.fa)&&g.eh(c.ga)?b.od[h].M.push(c):j.push(c)}b.M=j;if(b.od[h].M.length==0)b.od[h]=null;else Ki(a,b.od[h])}}a.fq+=b.M.length}
zg.prototype.$f=function(a,b){Ag.prototype.$f.call(this,a,b)};zg.prototype.dh=function(a,b,c){if(this.Da.aa){var d=new I;a=a.e();if(this.Da){d=this.Da.aa.e();ob(d);yb(d,a)}var e=d;e.q=1;e.v=0;e.t=0;e.G=0;e.w=0;e.r=1;e.u=0;e.H=0;e.A=0;e.B=0;e.p=1;e.I=0;e.J=0;e.K=0;e.C=0;e.L=1;e.Qa=true;if(b)d=b.e();if(this.Da)d=K(d,this.Da.aa);this.Ge&&Li(this,this.Ge,c,a,d)}};
function Li(a,b,c,d,e){if(Sa(b.g,d)){var f=b.M.length,g;if(bb(e))for(g=0;g<f;++g)c.push(b.M[g]);else if(cb(e))for(g=0;g<f;++g)c.push(new F(mb(e,b.M[g].X),mb(e,b.M[g].fa),mb(e,b.M[g].ga)));else for(g=0;g<f;++g)c.push(new F(kb(e,b.M[g].X),kb(e,b.M[g].fa),kb(e,b.M[g].ga)));for(g=0;g<b.od.length;++g){f=b.od[g];f!=null&&Li(a,f,c,d,e)}}}zg.prototype.Ok=ca("Da");function Mi(a,b){var c=new n.tm;c.M=b.M;c.g=b.g.e();for(var d=0;d<b.od.length;++d){var e=b.od[d],f=null;if(e)f=Mi(a,e);c.od.push(f)}return c}
zg.prototype.i=function(a){var b=new zg(null,a,this.Rn);b.Da=a;b.M=this.M;b.Ge=null;if(this.Ge)b.Ge=Mi(this,this.Ge);return b};(function(a){function b(){this.list=this.next=null}function c(){this.yd=this.gd=this.Rc=0;this.bg=null}function d(M,T,W,t,x,da){this.ff=16;this.sq=288;this.status=0;this.af=null;this.ke=0;var S=new Array(this.ff+1),Ab,ma,Ka,L,G,J,Ta,Ua=new Array(this.ff+1),Da,va,qa,na=new c,Sb=new Array(this.ff);L=new Array(this.sq);var ra,fb=new Array(this.ff+1),jc,gb,kc;kc=this.af=null;for(G=0;G<S.length;G++)S[G]=0;for(G=0;G<Ua.length;G++)Ua[G]=0;for(G=0;G<Sb.length;G++)Sb[G]=null;for(G=0;G<L.length;G++)L[G]=0;
for(G=0;G<fb.length;G++)fb[G]=0;Ab=T>256?M[256]:this.ff;Da=M;va=0;G=T;do{S[Da[va]]++;va++}while(--G>0);if(S[0]==T){this.af=null;this.status=this.ke=0}else{for(J=1;J<=this.ff;J++)if(S[J]!=0)break;Ta=J;if(da<J)da=J;for(G=this.ff;G!=0;G--)if(S[G]!=0)break;Ka=G;if(da>G)da=G;for(jc=1<<J;J<G;J++,jc<<=1)if((jc-=S[J])<0){this.status=2;this.ke=da;return}if((jc-=S[G])<0){this.status=2;this.ke=da}else{S[G]+=jc;fb[1]=J=0;Da=S;va=1;for(qa=2;--G>0;)fb[qa++]=J+=Da[va++];Da=M;G=va=0;do if((J=Da[va++])!=0)L[fb[J]++]=
G;while(++G<T);T=fb[Ka];fb[0]=G=0;Da=L;va=0;L=-1;ra=Ua[0]=0;qa=null;for(gb=0;Ta<=Ka;Ta++)for(M=S[Ta];M-- >0;){for(;Ta>ra+Ua[1+L];){ra+=Ua[1+L];L++;gb=(gb=Ka-ra)>da?da:gb;if((ma=1<<(J=Ta-ra))>M+1){ma-=M+1;for(qa=Ta;++J<gb;){if((ma<<=1)<=S[++qa])break;ma-=S[qa]}}if(ra+J>Ab&&ra<Ab)J=Ab-ra;gb=1<<J;Ua[1+L]=J;qa=new Array(gb);for(ma=0;ma<gb;ma++)qa[ma]=new c;kc=kc==null?(this.af=new b):(kc.next=new b);kc.next=null;kc.list=qa;Sb[L]=qa;if(L>0){fb[L]=G;na.gd=Ua[L];na.Rc=16+J;na.bg=qa;J=(G&(1<<ra)-1)>>ra-Ua[L];
Sb[L-1][J].Rc=na.Rc;Sb[L-1][J].gd=na.gd;Sb[L-1][J].yd=na.yd;Sb[L-1][J].bg=na.bg}}na.gd=Ta-ra;if(va>=T)na.Rc=99;else if(Da[va]<W){na.Rc=Da[va]<256?16:15;na.yd=Da[va++]}else{na.Rc=x[Da[va]-W];na.yd=t[Da[va++]-W]}ma=1<<Ta-ra;for(J=G>>ra;J<gb;J+=ma){qa[J].Rc=na.Rc;qa[J].gd=na.gd;qa[J].yd=na.yd;qa[J].bg=na.bg}for(J=1<<Ta-1;(G&J)!=0;J>>=1)G^=J;for(G^=J;(G&(1<<ra)-1)!=fb[L];){ra-=Ua[L];L--}}this.ke=Ua[1];this.status=jc!=0&&Ka!=1?1:0}}}function e(){if(Zd.length==Ke)return-1;return Zd.charCodeAt(Ke++)&255}
function f(M){for(;ha<M;){Y|=e()<<ha;ha+=8}}function g(M){return Y&Ni[M]}function h(M){Y>>=M;ha-=M}function j(M,T,W){var t,x,da;if(W==0)return 0;for(da=0;;){f(Ea);x=hb.list[g(Ea)];for(t=x.Rc;t>16;){if(t==99)return-1;h(x.gd);t-=16;f(t);x=x.bg[g(t)];t=x.Rc}h(x.gd);if(t==16){u&=i-1;M[T+da++]=z[u++]=x.yd}else{if(t==15)break;f(t);sa=x.yd+g(t);h(t);f(Tb);x=Le.list[g(Tb)];for(t=x.Rc;t>16;){if(t==99)return-1;h(x.gd);t-=16;f(t);x=x.bg[g(t)];t=x.Rc}h(x.gd);f(t);lc=u-x.yd-g(t);for(h(t);sa>0&&da<W;){sa--;lc&=
i-1;u&=i-1;M[T+da++]=z[u++]=z[lc++]}}if(da==W)return W}ib=-1;return da}function m(M,T,W){if(y==null){var t,x=new Array(288);for(t=0;t<144;t++)x[t]=8;for(;t<256;t++)x[t]=9;for(;t<280;t++)x[t]=7;for(;t<288;t++)x[t]=8;H=7;t=new d(x,288,257,Gg,Hg,H);if(t.status!=0){alert("HufBuild error: "+t.status);return-1}y=t.af;H=t.ke;for(t=0;t<30;t++)x[t]=5;zip_fixed_bd=5;t=new d(x,30,0,Ig,Jg,zip_fixed_bd);if(t.status>1){y=null;alert("HufBuild error: "+t.status);return-1}D=t.af;zip_fixed_bd=t.ke}hb=y;Le=D;Ea=H;Tb=
zip_fixed_bd;return j(M,T,W)}function o(M,T,W){var t,x,da,S,Ab,ma,Ka,L=new Array(316);for(t=0;t<L.length;t++)L[t]=0;f(5);ma=257+g(5);h(5);f(5);Ka=1+g(5);h(5);f(4);t=4+g(4);h(4);if(ma>286||Ka>30)return-1;for(x=0;x<t;x++){f(3);L[Kg[x]]=g(3);h(3)}for(;x<19;x++)L[Kg[x]]=0;Ea=7;x=new d(L,19,19,null,null,Ea);if(x.status!=0)return-1;hb=x.af;Ea=x.ke;S=ma+Ka;for(t=da=0;t<S;){f(Ea);Ab=hb.list[g(Ea)];x=Ab.gd;h(x);x=Ab.yd;if(x<16)L[t++]=da=x;else if(x==16){f(2);x=3+g(2);h(2);if(t+x>S)return-1;for(;x-- >0;)L[t++]=
da}else{if(x==17){f(3);x=3+g(3);h(3)}else{f(7);x=11+g(7);h(7)}if(t+x>S)return-1;for(;x-- >0;)L[t++]=0;da=0}}Ea=r;x=new d(L,ma,257,Gg,Hg,Ea);if(Ea==0)x.status=1;if(x.status!=0)return-1;hb=x.af;Ea=x.ke;for(t=0;t<Ka;t++)L[t]=L[t+ma];Tb=E;x=new d(L,Ka,0,Ig,Jg,Tb);Le=x.af;Tb=x.ke;if(Tb==0&&ma>257)return-1;if(x.status!=0)return-1;return j(M,T,W)}function p(M,T,W){var t,x;for(t=0;t<W;){if(Fc&&ib==-1)return t;if(sa>0){if(ib!=v)for(;sa>0&&t<W;){sa--;lc&=i-1;u&=i-1;M[T+t++]=z[u++]=z[lc++]}else{for(;sa>0&&t<
W;){sa--;u&=i-1;f(8);M[T+t++]=z[u++]=g(8);h(8)}if(sa==0)ib=-1}if(t==W)return t}if(ib==-1){if(Fc)break;f(1);if(g(1)!=0)Fc=true;h(1);f(2);ib=g(2);h(2);hb=null;sa=0}switch(ib){case 0:x=T+t;var da=W-t,S=undefined;S=ha&7;h(S);f(16);S=g(16);h(16);f(16);if(S!=(~Y&65535))x=-1;else{h(16);sa=S;for(S=0;sa>0&&S<da;){sa--;u&=i-1;f(8);M[x+S++]=z[u++]=g(8);h(8)}if(sa==0)ib=-1;x=S}break;case 1:x=hb!=null?j(M,T+t,W-t):m(M,T+t,W-t);break;case 2:x=hb!=null?j(M,T+t,W-t):o(M,T+t,W-t);break;default:x=-1;break}if(x==-1){if(Fc)return 0;
return-1}t+=x}return t}var i=32768,v=0,r=9,E=6,z,u,y=null,D,H,Y,ha,ib,Fc,sa,lc,hb,Le,Ea,Tb,Zd,Ke,Ni=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535),Gg=new Array(3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0),Hg=new Array(0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99),Ig=new Array(1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577),Jg=new Array(0,
0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13),Kg=new Array(16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15),Lg={};a.JSInflate=Lg;Lg.wr=function(M){var T,W,t;if(z==null)z=new Array(2*i);ha=Y=u=0;ib=-1;Fc=false;sa=lc=0;hb=null;Zd=M;Ke=0;T=new Array(1024);for(M="";(W=p(T,0,T.length))>0;)for(t=0;t<W;t++)M+=String.fromCharCode(T[t]);Zd=null;return M}})(this);jsdummyfunc=void 0;window.startCopperLichtFromFile=function(a,b,c,d,e,f,g){a=new ne(a,true,null,false,c,d,e,f,g);a.load(b);return a};window.CL3D=n;window.ccbGetSceneNodeFromId=Ih;window.ccbCloneSceneNode=Jh;window.ccbGetActiveCamera=Kh;window.ccbSetActiveCamera=Lh;window.ccbGetChildSceneNode=Mh;window.ccbGetRootSceneNode=Nh;window.ccbGetSceneNodeChildCount=Oh;window.ccbGetSceneNodeFromName=Ph;window.ccbRemoveSceneNode=Qh;window.ccbSetSceneNodeParent=Rh;window.ccbGetSceneNodeMaterialCount=Sh;
window.ccbGetSceneNodeMaterialProperty=Th;window.ccbSetSceneNodeMaterialProperty=Vh;window.ccbSetSceneNodeProperty=Wh;window.ccbGetSceneNodeProperty=Xh;window.ccbSetSceneNodePositionWithoutCollision=Yh;window.ccbRegisterOnFrameEvent=Zh;window.ccbDrawColoredRectangle=ai;window.ccbDrawTextureRectangle=bi;window.ccbDrawTextureRectangleWithAlpha=ci;window.ccbGet3DPosFrom2DPos=di;window.ccbGet2DPosFrom3DPos=ei;window.ccbGetCollisionPointOfWorldWithLine=fi;window.ccbEndProgram=hi;
window.ccbDoesLineCollideWithBoundingBoxOfSceneNode=gi;window.ccbLoadTexture=ji;window.ccbGetMousePosX=ki;window.ccbGetMousePosY=li;window.ccbGetScreenWidth=mi;window.ccbGetScreenHeight=ni;window.ccbSetCloseOnEscapePressed=oi;window.ccbSetCursorVisible=pi;window.ccbSwitchToScene=qi;window.ccbPlaySound=ri;window.ccbStopSound=si;window.ccbGetCopperCubeVariable=ti;window.ccbSetCopperCubeVariable=ui;window.ccbReadFileContent=wi;window.ccbWriteFileContent=xi;window.ccbGetPlatform=yi;
window.ccbInvokeAction=zi;window.ccbCleanMemory=Uh;window.print=Ai;window.system=Bi;window.ccbRegisterBehaviorEventReceiver=Ci;window.ccbUnregisterOnFrameEvent=$h;window.ccbSwitchToFullscreen=vi;window.ccbDoHTTPRequest=Di;window.ccbCancelHTTPRequest=Ei;window.ccbCreateMaterial=Fi;window.ccbSetShaderConstant=Gi;window.ccbSetPhysicsVelocity=ii;window.ccbUpdatePhysicsGeometry=ii;window.ccbAICommand=Ii;window.ccbGetCurrentNode=Hi;
